var laya=function(t){"use strict";class e{constructor(){}static init(){Laya.ClassUtils.regClass}}e.width=1024,e.height=768,e.scaleMode="showall",e.screenMode="none",e.alignV="middle",e.alignH="center",e.startScene="Items/AddDetailsWithBattle.scene",e.sceneRoot="",e.debug=!1,e.stat=!1,e.physicsDebug=!1,e.exportSceneToJson=!0,e.init();class a{static log(...t){a.SHOW_LOG&&console.log("日志",t)}}a.SHOW_LOG=!0;class i{static Sin(t){return Math.sin(t)}static Cos(t){return Math.cos(t)}static Tan(t){return Math.tan(t)}static Asin(t){return Math.asin(t)}static Acos(t){return Math.acos(t)}static Atan(t){return Math.atan(t)}static Atan2(t,e){return Math.atan2(t,e)}static Sqrt(t){return Math.sqrt(t)}static Abs(t){return Math.abs(t)}static Random(t,e,a=!0){return a?Math.random()*(e-t)+t:Math.floor(Math.random()*(e-t)+t)}static RandomInt(t,e){return this.Random(t,e,!1)}static RandomFloat(t,e){return this.Random(t,e,!0)}static Min(...t){let e=t.length;if(0==e)return 0;let a=t[0];for(let i=1;i<e;i++)t[i]<a&&(a=t[i]);return a}static Max(...t){let e=t.length;if(0==e)return 0;let a=t[0];for(let i=1;i<e;i++)t[i]>a&&(a=t[i]);return a}static Half(t,e,a){return a?t+Math.floor((e-t)/2):t+(e-t)/2}static Pow(t,e){return Math.pow(t,e)}static Exp(t){return Math.exp(t)}static Log(t){return Math.log(t)}static Log10(t){return Math.log10(t)}static Ceil(t){return Math.ceil(t)}static Floor(t){return Math.floor(t)}static Round(t,e=0){let a=this.Pow(10,e);return Math.floor(t*a+.5)/a}static RoundVector3(t,e=0){t.x=this.Round(t.x,e),t.y=this.Round(t.y,e),t.z=this.Round(t.z,e)}static Sign(t){return t>=0?1:-1}static Clamp(t,e,a){return t<e?t=e:(t>a&&(t=a),t)}static Clamp01(t){return t<0?0:t>1?1:t}static Lerp(t,e,a){return t+(e-t)*this.Clamp01(a)}static LerpUnclamped(t,e,a){return t+(e-t)*a}static LerpAngle(t,e,a){let i=this.Repeat(e-t,360);return i>180&&(i-=360),t+i*this.Clamp01(a)}static MoveTowards(t,e,a){return this.Abs(e-t)<=a?e:t+this.Sign(e-t)*a}static MoveTowardsAngle(t,e,a){let i=this.DeltaAngle(t,e);return-a<i&&i<a?e:(e=t+i,this.MoveTowards(t,e,a))}static SmoothStep(t,e,a){return e*(a=-2*(a=this.Clamp01(a))*a*a+3*a*a)+t*(1-a)}static Gamma(t,e,a){let i=!1;t<0&&(i=!0);let r=this.Abs(t);if(r>e)return i?-r:r;let s=this.Pow(r/e,a)*e;return i?-s:s}static Repeat(t,e){return this.Clamp(t-this.Floor(t/e)*e,0,e)}static PingPong(t,e){return t=this.Repeat(t,2*e),e-this.Abs(t-e)}static InverseLerp(t,e,a){return t!=e?this.Clamp01((a-t)/(e-t)):0}static DeltaAngle(t,e){let a=this.Repeat(e-t,360);return a>180&&(a-=360),a}static SmoothDamp(t,e,a,i,r=Number.MAX_SAFE_INTEGER,s=.001*Laya.timer.delta){let o=2/(i=this.Max(1e-4,i)),n=o*s,h=1/(1+n+.48*n*n+.235*n*n*n),l=t-e,c=e,d=r*i,p=(a+o*(l=this.Clamp(l,-d,d)))*s;a=(a-o*p)*h;let f=(e=t-l)+(l+p)*h;return c-t>0==f>c&&(a=((f=c)-c)/s),{value:f,currentVelocity:a}}static LineIntersection(t,e,a,i,r){let s=e.x-t.x,o=e.y-t.y,n=i.x-a.x,h=i.y-a.y,l=s*h-o*n;if(0==l)return!1;let c=((a.x-t.x)*h-(a.y-t.y)*n)/l;return r.x=t.x+c*s,r.y=t.y+c*o,!0}}i.PI=3.141593,i.Infinity=Number.MAX_SAFE_INTEGER,i.NegativeInfinity=Number.MIN_SAFE_INTEGER,i.Deg2Rad=.01745329,i.Rad2Deg=57.29578;var r,s,o,n,h,l,c,d,p,f,m,y,u,g,b,S,x,w,v,I,L,C=new Laya.Point;class k{constructor(t,e){this.min=void 0!==t?t:new Laya.Point(1/0,1/0),this.max=void 0!==e?e:new Laya.Point(-1/0,-1/0)}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(var e=0,a=t.length;e<a;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){var a=C.copy(e).mult(.5);return this.min.copy(t).sub(a,this.min),this.max.copy(t).add(a,this.max),this}clone(){return(new k).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){t=t||new Laya.Point;return this.isEmpty()?t.set(0,0):(this.min.add(this.max,t),t.mult(.5,t)),t}getSize(t){t=t||new Laya.Point;return this.isEmpty()?t.set(0,0):this.max.sub(this.min,t),t}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t,this.min),this.max.add(t,this.max),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return(e=e||new Laya.Point).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}intersectsCircle(t,e){let a=i.Min(Math.abs(this.min.x-t.x),Math.abs(this.max.x-t.x)),r=i.Min(Math.abs(this.min.y-t.y),Math.abs(this.max.y-t.y));if(a*a+r*r<e*e)return!0;let s=(this.min.x+this.max.x)/2,o=(this.min.y+this.max.y)/2;return Math.abs(s-t.x)<Math.abs(this.max.x-this.min.x)/2+e&&Math.abs(t.y-o)<Math.abs(this.max.y-this.min.y)/2||Math.abs(o-t.y)<Math.abs(this.max.y-this.min.y)/2+e&&Math.abs(t.x-s)<Math.abs(this.max.x-this.min.x)/2}clampPoint(t,e){return(e=e||new Laya.Point).copy(t).clamp(this.min,this.max)}distanceToPoint(t){return C.copy(t).clamp(this.min,this.max),C.sub(t,C).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}class B{static get Ratio(){return{width:.5*(Laya.stage.width-750),height:.5*(Laya.stage.height-1624)}}static size(t){return t?Object.keys(t).length:0}static wait(t,e){return new Promise(a=>{Laya.timer.once(t,e,a)})}static createDownload(t){let e=document.createElement("a");e.setAttribute("target","_blank"),e.setAttribute("download","config.txt"),document.body.appendChild(e),e.href="data:text/txt;charset=utf-8,"+t,e.click(),document.body.removeChild(e)}static createVideo(t){let e=Laya.Browser.createElement("video");Laya.Browser.document.body.appendChild(e),e.style.zInddex=Laya.Render.canvas.style.zIndex+1,e.src=t,e.controls=!1,e.autoplay=!0,e.play();let a=new Laya.Sprite;Laya.stage.addChild(a),a.pos(0,0),a.size(Laya.stage.width,Laya.stage.height),a.graphics.drawRect(0,0,a.width,a.height,"#808B98"),a.graphics.fillText("点击继续",Laya.stage.width>>1,Laya.stage.height-100,"30px Microsoft YaHei","#fff","center"),Laya.Utils.fitDOMElementInArea(e,a,0,0,a.width,a.height)}static numberFormat(t){let e=t+"";return t>1*Math.pow(10,4)&&(e=Math.floor(10*t/(1*Math.pow(10,3)))/10+"K"),t>1*Math.pow(10,6)&&(e=Math.floor(10*t/(1*Math.pow(10,6)))/10+"M"),t>1*Math.pow(10,8)&&(e=Math.floor(10*t/(1*Math.pow(10,8)))/10+"B"),e}static timeFormat(t,e){let a,r=i.Floor(t/60/60/24),s=i.Floor(t/60/60%24),o=i.Floor(t/60%60),n=i.Floor(t%60);e||(e=r>0?"D天 HH:MM:SS":s>0?"HH:MM:SS":"MM:SS");const h={"D+":r.toString(),"H+":s.toString(),"M+":o.toString(),"S+":n.toString()};for(let t in h)(a=new RegExp("("+t+")").exec(e))&&(e=e.replace(a[1],1==a[1].length?h[t]:h[t].padStart(a[1].length,"0")));return e}static isNull(t){return null==t||""===t}static Number(t){return void 0===t?0:+t}static toBoolean(t){return 0!==t}static createBox2D(t,e){let a=new Laya.Point(t.x-t.pivotX*t.width,t.y-t.pivotY*t.height),i=new Laya.Point(a.x+t.width,a.y+t.height),r=e||new k;return r.makeEmpty(),r.expandByPoint(a),r.expandByPoint(i),r}static getTiltAngle(t){let e=0;return e=t==Laya.stage.width/2?90:(Laya.stage.width,99-9*t/(Laya.stage.width/2))}static regKeyMove(t,e=!0){Laya.stage.on(Laya.Event.KEY_DOWN,null,i=>{switch(i.keyCode){case Laya.Keyboard.DOWN:case Laya.Keyboard.UP:case Laya.Keyboard.LEFT:case Laya.Keyboard.RIGHT:let r=i.shiftKey?10:1;i.keyCode===Laya.Keyboard.DOWN&&(t.y+=r),i.keyCode===Laya.Keyboard.UP&&(t.y-=r),i.keyCode===Laya.Keyboard.LEFT&&(t.x-=r),i.keyCode===Laya.Keyboard.RIGHT&&(t.x+=r),e&&(t.zOrder=t.y),a.log(t.x,t.y)}})}static splitPos(t){let e=this.splitStr(t);return e[0]=B.Number(e[0]),e[1]=B.Number(e[1]),e}static splitStr(t){if("number"==typeof t)return[t];return t.match(/[a-zA-Z-0-9\.]+/g)}static randomArr(t,e){let a=typeof t;if("number"===a)return t;let r="string"===a?this.splitStr(t):t,s=r[i.RandomInt(0,r.length)];return e?+s:s}static randomPos(){}static randomPosM(){}static isNumber(t){return this.reg.test(t)}static getJSON(t){if(!t)return{code:-999};var e=t.indexOf("{",0);return t=t.substr(e,t.length-e),JSON.parse(t)}}B.reg=new RegExp(/^[+-]?[0-9]+$/),function(t){t[t.Test=0]="Test",t[t.OnRefreshLocalDB=1]="OnRefreshLocalDB",t[t.OnMapLoaded=2]="OnMapLoaded",t[t.OnTaskStart=3]="OnTaskStart",t[t.OnTaskTick=4]="OnTaskTick",t[t.OnTaskEnd=5]="OnTaskEnd",t[t.RefreshBoard=6]="RefreshBoard",t[t.ClickTopShowMessage=7]="ClickTopShowMessage",t[t.SelectGrayOrNot=8]="SelectGrayOrNot",t[t.CloseMessage=9]="CloseMessage",t[t.ShowBattleUI=10]="ShowBattleUI",t[t.JudgeMyBattle=11]="JudgeMyBattle",t[t.TouchDeal=12]="TouchDeal",t[t.ExcutingMyOrder=13]="ExcutingMyOrder",t[t.DealEnemyAction=14]="DealEnemyAction",t[t.DiceAfterStatus=15]="DiceAfterStatus",t[t.DelayCardSkillToDeal=16]="DelayCardSkillToDeal",t[t.ClearAllSlgRole=17]="ClearAllSlgRole",t[t.ClearNoAdapterCard=18]="ClearNoAdapterCard",t[t.TurntableSelect=19]="TurntableSelect",t[t.BattleTrigger=20]="BattleTrigger",t[t.RefreshCardDialog=21]="RefreshCardDialog",t[t.RefreshCardDetailDialog=22]="RefreshCardDetailDialog",t[t.RefreshCurrency=23]="RefreshCurrency",t[t.RefreshAutoEXP=24]="RefreshAutoEXP",t[t.ChangeTileStat=25]="ChangeTileStat",t[t.SelectMainLevel=26]="SelectMainLevel",t[t.RefreshHeroUI=27]="RefreshHeroUI",t[t.RefreshPropUI=28]="RefreshPropUI",t[t.RefreshLevelMsgUI=29]="RefreshLevelMsgUI",t[t.DelectElement=30]="DelectElement",t[t.FlyProp=31]="FlyProp",t[t.GetRelics=32]="GetRelics",t[t.ShootArrow=33]="ShootArrow",t[t.SelectStatuePower=34]="SelectStatuePower",t[t.SearchCorpse=35]="SearchCorpse",t[t.GhostSend=36]="GhostSend",t[t.ShowSummon=37]="ShowSummon",t[t.CallGameTimeEvent=38]="CallGameTimeEvent",t[t.CallGameMonthEvent=39]="CallGameMonthEvent",t[t.CallGameSeaonEvent=40]="CallGameSeaonEvent",t[t.CallGameYearEvent=41]="CallGameYearEvent",t[t.CallEndMonthEvent=42]="CallEndMonthEvent",t[t.CallNextMonthEvent=43]="CallNextMonthEvent",t[t.CallStartProduce=44]="CallStartProduce",t[t.CallInterruptProduce=45]="CallInterruptProduce",t[t.CallEndProduce=46]="CallEndProduce",t[t.CallRefreshCardEvent=47]="CallRefreshCardEvent",t[t.CloseTopItemDetails=48]="CloseTopItemDetails",t[t.RefreshSilver=49]="RefreshSilver",t[t.RefreshBatter=50]="RefreshBatter",t[t.RefreshFightback=51]="RefreshFightback",t[t.RefreshBattleTitle=52]="RefreshBattleTitle",t[t.RefreshBattleBar=53]="RefreshBattleBar",t[t.RefreshBattleBarSign=54]="RefreshBattleBarSign",t[t.RefreshWeapon=55]="RefreshWeapon",t[t.MixWeapon=56]="MixWeapon",t[t.CallRandEventWithFans=57]="CallRandEventWithFans",t[t.CallRandEventWithBook=58]="CallRandEventWithBook",t[t.CallRandEventWithGift=59]="CallRandEventWithGift"}(r||(r={}));class D extends Laya.EventDispatcher{static get instance(){return!this._instance&&(this._instance=new D),this._instance}static on(t,e,a,i){return this.instance.on(t.toString(),e,a,i)}static once(t,e,a,i){return this.instance.once(t.toString(),e,a,i)}static off(t,e,a,i){return this.instance.off(t.toString(),e,a,i)}static offAll(t){return this.instance.offAll(t?t.toString():null)}static offAllCaller(t){return this.instance.offAllCaller(t)}static event(t,e){return this.instance.event(t.toString(),e)}static hasListener(t){return this.instance.hasListener(t.toString())}}!function(t){t[t.None=0]="None",t[t.Self=1]="Self",t[t.Target=2]="Target"}(s||(s={})),function(t){t[t.None=1]="None",t[t.Self=20]="Self",t[t.Target=20]="Target",t[t.Forest=3]="Forest",t[t.Ban=99]="Ban"}(o||(o={})),function(t){t[t.EnterRoom=0]="EnterRoom",t[t.ToMineGold=1]="ToMineGold",t[t.ToOtherMineGold=2]="ToOtherMineGold",t[t.MineGold=3]="MineGold",t[t.Stroll=4]="Stroll",t[t.Transport=5]="Transport",t[t.Exit=6]="Exit",t[t.Queue=7]="Queue",t[t.ToAct=8]="ToAct",t[t.Act=9]="Act",t[t.Charge=10]="Charge",t[t.AdjustPos=11]="AdjustPos",t[t.AfterActAdjustPos=12]="AfterActAdjustPos",t[t.Retreat=13]="Retreat",t[t.Summon=14]="Summon",t[t.Idle=15]="Idle",t[t.Hide=16]="Hide",t[t.Snipe=17]="Snipe",t[t.CAQue=18]="CAQue",t[t.Die=19]="Die"}(n||(n={})),function(t){t[t.Deck=0]="Deck",t[t.Hall=1]="Hall",t[t.DeckCount=2]="DeckCount",t[t.Select=3]="Select",t[t.Deal=9]="Deal",t[t.Drag=10]="Drag"}(h||(h={})),function(t){t[t.EnterRoom=0]="EnterRoom",t[t.ExitRoom=1]="ExitRoom",t[t.Attack=2]="Attack",t[t.ToFind=3]="ToFind",t[t.Stroll=4]="Stroll"}(l||(l={})),function(t){t[t.NoStart=0]="NoStart",t[t.DoingLevel1=1]="DoingLevel1",t[t.DoingLevel2=2]="DoingLevel2",t[t.Finish=3]="Finish"}(c||(c={})),function(t){t[t.Coin=0]="Coin",t[t.Food=1]="Food",t[t.People=2]="People",t[t.Resource=3]="Resource",t[t.Product=4]="Product",t[t.Idea=5]="Idea",t[t.Enemy=6]="Enemy",t[t.Animal=7]="Animal",t[t.Building=8]="Building",t[t.Key=9]="Key",t[t.Box=10]="Box",t[t.Place=11]="Place",t[t.MechantEvent=12]="MechantEvent",t[t.Tombstone=13]="Tombstone",t[t.Weapon=14]="Weapon",t[t.Container=15]="Container",t[t.Home=16]="Home",t[t.Live=17]="Live",t[t.Gift=18]="Gift",t[t.WeirdEvent=19]="WeirdEvent",t[t.WordlessBook=20]="WordlessBook",t[t.Revelation=21]="Revelation"}(d||(d={})),function(t){t[t.Spring=0]="Spring",t[t.Summer=1]="Summer",t[t.Fall=2]="Fall",t[t.Winter=3]="Winter"}(p||(p={})),function(t){t[t.Normal=0]="Normal",t[t.Accelerate=1]="Accelerate",t[t.Pause=2]="Pause"}(f||(f={})),function(t){t[t.Coll=0]="Coll",t[t.NoColl=1]="NoColl",t[t.Save=2]="Save",t[t.Equip=3]="Equip"}(m||(m={})),function(t){t[t.Minor=1]="Minor",t[t.Seriously=2]="Seriously",t[t.Dying=3]="Dying"}(y||(y={})),function(t){t[t.DamageCoin=0]="DamageCoin",t[t.DamageFood=1]="DamageFood",t[t.DamageResource=2]="DamageResource",t[t.DamageProduct=3]="DamageProduct",t[t.DeductBlood=4]="DeductBlood",t[t.SummonEnemy=5]="SummonEnemy"}(u||(u={})),function(t){t[t.Hero=0]="Hero",t[t.Animal=1]="Animal",t[t.Enemy=2]="Enemy",t[t.Weapon=3]="Weapon",t[t.Treasure=4]="Treasure",t[t.Box=5]="Box",t[t.Camp=6]="Camp",t[t.Silver=7]="Silver",t[t.Hole=8]="Hole",t[t.Road=9]="Road",t[t.Back=10]="Back",t[t.Store=11]="Store",t[t.Next=12]="Next"}(g||(g={})),function(t){t[t.Boss=0]="Boss",t[t.Store=1]="Store",t[t.Box=2]="Box",t[t.Treasure=3]="Treasure",t[t.NormalEnemy=4]="NormalEnemy",t[t.Camp=5]="Camp",t[t.AtkWeapon=6]="AtkWeapon",t[t.DefWeapon=7]="DefWeapon",t[t.Silver=8]="Silver",t[t.EliteEnemy=9]="EliteEnemy",t[t.Next=10]="Next"}(b||(b={})),function(t){t[t.Jin=0]="Jin",t[t.Mu=1]="Mu",t[t.Shui=2]="Shui",t[t.Huo=3]="Huo",t[t.Tu=4]="Tu",t[t.Yin=5]="Yin",t[t.Yang=6]="Yang",t[t.Wu=7]="Wu"}(S||(S={})),function(t){t[t.Forest=0]="Forest",t[t.Castle=1]="Castle",t[t.Valley=2]="Valley",t[t.HistoricalRemains=3]="HistoricalRemains",t[t.Catacombs=4]="Catacombs",t[t.Dark=5]="Dark",t[t.Fog=6]="Fog",t[t.Abyss=7]="Abyss",t[t.Hell=8]="Hell"}(x||(x={})),function(t){t[t["下一关"]=0]="下一关",t[t["风色森林"]=1]="风色森林",t[t["静谧森林"]=2]="静谧森林",t[t["茂密森林"]=3]="茂密森林",t[t["幽深森林"]=4]="幽深森林",t[t["白昼森林"]=5]="白昼森林",t[t["幻夜森林"]=6]="幻夜森林"}(w||(w={})),function(t){t[t.Month=0]="Month",t[t.Season=1]="Season",t[t.Year=2]="Year",t[t.Fans=3]="Fans",t[t.Book=4]="Book",t[t.Gift=5]="Gift"}(v||(v={}));class A{}A.debugMode=!0,A.showFPS=!1,A.showAStarGrid=!1,A.globalScale=.6,A.version="1003",A.confVersion="1001",A.girdSize=15,A.blockWidth=116,A.blockHeight=133,A.backPackSize=40,A.mapWidth=780,A.mapHeight=1620,A.frameToS=120,A.playerData={uid:100001},A.radiusGenerge=75,A.radiusGenerge2=90,A.onceAddPopulation=1,A.onceAddCards=10,A.animalTameAmout=3,A.initPopulation=99,A.initCards=99,A.autoSaveInterval=10,A.nextEnemyTime=250,A.floatCardTime=30,A.callOrdinaryGuestInterval=8,A.callOrdinaryGuestRange=[1,3],A.fitThreeMaps=[1],A.callOrdinaryGuestProb=1,A.callSpecialGuestInterval=60,A.callSpecialGuestProb=.05,A.callRubbishInterval=30,A.callRubbishProb=.5,A.callRubbishTopLimit=6,A.damageComputerInterval=120,A.damageComputerProb=.01,A.damageComputerTopLimit=5,A.maxSpeedUpTime=20,A.upEmblemBase=[1,6,15],A.clearEmblemBase=[1,3,5,7],A.upCoinBase=[1e4,5e4,1e5],A.attrMaxBase=[40,40,40,40],A.collectExpMax=1e4,A.freeGetCrystalNum=4,A.freeGetCrystalCount=3,A.freeGaChaCount=1,A.gachaCost=[3,4,4,4,5],A.allGachaCost=[3,7,11,15,20],A.freeRolePoor=[80001,80041,80081],A.crystalRolePoor=[80001,80041,80081,80121],A.foodPrice=1200,A.keyPrice=600,A.beAtkReplyMp=10,A.speedUpRecover=[5,1],A.specGuestLife=12,A.maxBeAttackCount=2,A.addFansInterval=[10,25],A.costFansInterval=[0,1],A.punishFansInterval=[10,10],A.onceAddProficiency=1,A.maxBatterPoint=5,A.useBatterPoint=3,A.addHurtBatterPoint=40,A.turnDizzy=2,A.maxFightbackPoint=5,A.holeShowRand=5,A.attrAddBase=[2,1,4,4,3,6],A.soundRoot="sound/",A.bgms=[],A.spineRoot="local/Spine/",A.confRoot="local/config/",A.mapRoot="local/Map/",A.elementRoot="local/Element/",A.ad_video="b5fcf4194a043a",A.openid="test14366419",function(t){t[t.Common=0]="Common",t[t.BGTask=1]="BGTask",t[t.Items=2]="Items",t[t.GuideData=3]="GuideData",t[t.MapNormalCard=4]="MapNormalCard",t[t.MapNormalCardGroup=5]="MapNormalCardGroup",t[t.MapHolderCard=6]="MapHolderCard",t[t.GameItems=7]="GameItems",t[t.HeroData=8]="HeroData",t[t.AnimalData=9]="AnimalData",t[t.EnemyData=10]="EnemyData",t[t.WeaponData=11]="WeaponData",t[t.SpecialWeaponData=12]="SpecialWeaponData"}(I||(I={}));class T{static get instance(){return T._instance||(T._instance=new T),T._instance}get items(){return Laya.LocalStorage.items}get soundFlag(){return this.get("SoundFlag",I.Common)}set soundFlag(t){this.set("SoundFlag",t,I.Common)}get freeGaCha(){return this.get("FreeGaCha",I.Common)}set freeGaCha(t){this.set("FreeGaCha",t,I.Common)}get freeGetCrystal(){return this.get("FreeGetCrystal",I.Common)}set freeGetCrystal(t){this.set("FreeGetCrystal",t,I.Common)}get IsNewDay(){return this.get("IsNewDay",I.Common)}set IsNewDay(t){this.set("IsNewDay",t,I.Common)}get GuideIndex(){return this.get("GuideIndex",I.GuideData)||1001}set GuideIndex(t){this.set("GuideIndex",t,I.GuideData,!1)}get GuideStat(){return this.get("GuideStat",I.GuideData)||c.NoStart}set GuideStat(t){this.set("GuideStat",t,I.GuideData,!1)}init(){let t=this.getItem("version");t!==A.version?(Laya.LocalStorage.clear(),a.log("v",t,A.version),this.data||this.fillDefaultData()):this.data={}}has(t,e){B.isNull(e)&&(e=I.Common);let a=this.getKey(e);return this.data[a]||(this.data[a]=this.getJSON(a)),B.isNull(t)?this.data[a]:this.data[a]?this.getValue(t,this.data[a]):void 0}get(t,e){B.isNull(e)&&(e=I.Common);let a=this.getKey(e);return this.data[a]||(this.data[a]=this.getJSON(a)),B.isNull(t)?this.data[a]:this.getValue(t,this.data[a])}set(t,e,a,i=!0){B.isNull(a)&&(a=I.Common);let s=this.getKey(a);if(this.data[s]||(this.data[s]=this.getJSON(s)),B.isNull(t)){let a=this.data[s];if(a||(a=[],this.data[s]=a),!(a instanceof Array))throw"Type Error! LocalDB.Table."+s+" id:"+t;a.push(e)}else this.data[s]||(this.data[s]={}),this.setValue(t,e,this.data[s]);i&&D.event(r.OnRefreshLocalDB,[t,a])}delete(t,e,a=!0){B.isNull(e)&&(e=I.Common);let i=I[e];this.data[i]||(this.data[i]=this.getJSON(i)),B.isNull(t)?delete this.data[i]:this.setValue(t,null,this.data[i]),a&&D.event(r.OnRefreshLocalDB,[t,e])}getValue(t,e){if(!e)return;"string"!=typeof t&&(t=t.toString());let a,i=t.split("."),r=e;for(;;){if(0===i.length)return r;if(a=i.shift(),B.isNull(r))return;if("object"!=typeof r)return;r=r[a]}}setValue(t,e,a){if(B.isNull(t))throw"LocalDB.setValue(path, value, obj): path is null!";"string"!=typeof t&&(t=t.toString());let i,r=t.split("."),s=a;for(;;){if(i=r.shift(),0===r.length){if(null==e)return void delete s[i];let t=s[i];B.isNull(t)?s[i]=e:t instanceof Array?s[i].push(e):"object"==typeof t&&"object"==typeof e?e instanceof Array?s[i]=e:Object.assign(s[i],e):s[i]=e;break}s[i]||(s[i]={}),s=s[i]}}getTableLength(t){let e=this.get(null,t);return B.size(e)}getKey(t){return I[t]}fillDefaultData(){this.data={},this.soundFlag=!0,this.freeGaCha=0,this.freeGetCrystal=0,this.IsNewDay=0,this.setItem("version",A.version),this.save()}save(t){if(B.isNull(t))for(const t in I){if(B.isNumber(t))continue;let e=this.data[t];B.isNull(e)||this.setJSON(t,e)}else{let e=this.getKey(t),a=this.data[e];B.isNull(a)||this.setJSON(e,a)}}getItem(t){return Laya.LocalStorage.getItem(t)}setItem(t,e){Laya.LocalStorage.setItem(t,e)}getJSON(t){return Laya.LocalStorage.getJSON(t)}setJSON(t,e){return Laya.LocalStorage.setJSON(t,e)}removeItem(t){Laya.LocalStorage.removeItem(t)}clear(){Laya.LocalStorage.clear()}}class E{constructor(){this.loadedTables={}}static get instance(){return E._instance||(E._instance=new E),E._instance}get root(){return A.confRoot+A.confVersion+"/"}loadAll(){return new Promise(t=>{let e=Object.keys(L).filter(t=>!B.isNumber(t));this.load(e).then(a=>{for(let t=0;t<a.length;t++)this.loadedTables[e[t]]=a[t];t()})})}select(t){let e="string"==typeof t?t:L[t];return new M(this.loadedTables[e])}load(t){return"string"==typeof t?this.loadOne(t):this.loadMore(t)}loadOne(t){let e=this.root+(t.endsWith(".json")?t:t+".json");return new Promise(t=>{Laya.loader.load(e,Laya.Handler.create(null,t),null,Laya.Loader.JSON)})}loadMore(t){let e=[];for(let a=0,i=t.length;a<i;a++){let i=t[a];e.push(this.loadOne(i))}return Promise.all(e)}}!function(t){t[t.FunCard=0]="FunCard",t[t.NormalCard=1]="NormalCard",t[t.MixBook=2]="MixBook",t[t.RandomEventBook=3]="RandomEventBook",t[t.MixWeapon=4]="MixWeapon",t[t.CardHolder=5]="CardHolder",t[t.MechantFunCard=6]="MechantFunCard",t[t.BattleCard=7]="BattleCard",t[t.BattleEnemy=8]="BattleEnemy",t[t.BattleHero=9]="BattleHero",t[t.BattleAnimal=10]="BattleAnimal",t[t.BattlePlace=11]="BattlePlace",t[t.BattleWeapon=12]="BattleWeapon",t[t.BattleTreasure=13]="BattleTreasure",t[t.BattleSkill=14]="BattleSkill",t[t.BattleState=15]="BattleState",t[t.BattleGain=16]="BattleGain"}(L||(L={}));class M{get asDict(){return this.data}get asArray(){let t=[];for(const e in this.data){const a=this.data[e];t.push(a)}return t}select(t){return this.data[t]}filter(t){let e=[];for(const a in this.data){const i=this.data[a];t(i,a,this.data)&&e.push(i)}return e}constructor(t){this.data=t}}class G{static init(){B.Ratio.width,this.deltax=0,this.deltay=0,this.SeatPos={"1u":[400,620],"1d":[550,620],"2u":[480,500],"2d":[630,500],"3u":[610,560],"3d":[760,560],"4u":[880,620],"4d":[1030,620],"5u":[A.mapWidth-1030+8,620],"5d":[A.mapWidth-880+10,620],"6u":[A.mapWidth-760+8,560],"6d":[A.mapWidth-610+10,560],"7u":[A.mapWidth-630+8,500],"7d":[A.mapWidth-480+10,500],"8u":[A.mapWidth-550+8,620],"8d":[A.mapWidth-400+10,620]},this.PersonSpawnPosX=[100],this.PersonSpawnPosY=[355,370,385,400],this.OtherPersonSpawnPosX=[A.mapWidth-100],this.OtherPersonSpawnPosY=[355,370,385,400],this.StatusPos=[50,390],this.OtherStatusPos=[A.mapWidth-50,390],this.BeAttackedPos={left_up:[-30*i.Cos(60),-30*i.Sin(60)],left:[-30,0],left_down:[-30*i.Cos(60),30*i.Sin(60)],right_up:[30*i.Cos(60),-30*i.Sin(60)],right:[30,0],right_down:[30*i.Cos(60),30*i.Sin(60)]},this.BezierPath={space:3,Col1:[[0,355],[Laya.stage.width,355]],Col2:[[0,370],[Laya.stage.width,370]],Col3:[[0,385],[Laya.stage.width,385]],Col4:[[0,400],[Laya.stage.width,400]]}}}class P{static get instance(){return P._instance||(P._instance=new P),P._instance}init(){D.on(r.OnRefreshLocalDB,this,this.onRefreshLocalDB)}onRefreshLocalDB(t,e){}checkSeatUnlock(t,e){}}const H=1e3,O=60*(60*H),W=24*O,X=7*W;class R{static get weeks(){return i.Floor(this.milliSeconds/X)}static get days(){return i.Floor(this.milliSeconds/W)}static get hours(){return i.Floor(this.milliSeconds/O)}static get seconds(){return i.Floor(this.milliSeconds/H)}static get milliSeconds(){return(new Date).valueOf()}}class F{constructor(){this.gameSeason=p.Spring,this.monthInSeason=3,this.tikTime=0,this.gameClockType=f.Normal,this.isRunTime=!1}static get instance(){return F._instance||(F._instance=new F),F._instance}get GameClockType(){return this.gameClockType}set GameClockType(t){this.gameClockType=t}get IsRunTime(){return this.isRunTime}init(){this.gameMinute=T.instance.get("GameMinute",I.GameItems)||0,this.gameHour=T.instance.get("GameHour",I.GameItems)||0,this.gameDay=T.instance.get("GameDay",I.GameItems)||1,this.gameMonth=T.instance.get("GameMonth",I.GameItems)||1,this.gameYear=T.instance.get("GameYear",I.GameItems)||1,this.gameSeason=T.instance.get("GameSeason",I.GameItems)||p.Spring,this.monthInSeason=T.instance.get("GameMonthInSeason",I.GameItems)||3,this.gameClockType=f.Normal,this.isRunTime=!0}runTime(t){this.isRunTime=t,t?Laya.timer.frameLoop(1,this,this.update):Laya.timer.clear(this,this.update)}update(){if(this.gameClockType!=f.Pause){this.tikTime+=Laya.timer.delta/1e3;let t=this.gameClockType==f.Accelerate?F.secondThreshold/4:F.secondThreshold;this.tikTime>=t&&(this.tikTime-=t,this.updateGameTime())}}updateGameTime(){if(this.gameMinute++,this.gameMinute>F.minuteHold){if(this.gameHour++,this.gameMinute=0,this.gameHour>F.hourHold&&(this.gameDay++,this.gameHour=0,this.gameDay>F.dayHold)){if(this.gameMonth++,this.gameDay=1,this.gameMonth>12&&(this.gameMonth=1),this.monthInSeason--,0==this.monthInSeason){var t=this.gameSeason;++t>F.seasonHold&&(this.gameYear++,t=0,D.event(r.CallGameYearEvent,[this.gameYear])),this.gameSeason=t,this.monthInSeason=3,D.event(r.CallGameSeaonEvent,[this.gameSeason])}D.event(r.CallGameMonthEvent,[this.gameMonth])}D.event(r.CallGameTimeEvent,[this.gameDay,this.gameMonth,this.gameYear,this.gameSeason])}this.setSave()}setSave(){T.instance.set("GameMinute",this.gameMinute,I.GameItems),T.instance.set("GameHour",this.gameHour,I.GameItems),T.instance.set("GameDay",this.gameDay,I.GameItems),T.instance.set("GameMonth",this.gameMonth,I.GameItems),T.instance.set("GameYear",this.gameYear,I.GameItems),T.instance.set("GameSeason",this.gameSeason,I.GameItems),T.instance.set("GameMonthInSeason",this.monthInSeason,I.GameItems)}}var Y;F.secondThreshold=.029,F.minuteHold=5.56,F.hourHold=23,F.dayHold=29,F.seasonHold=3,function(t){t[t.AutoSave=0]="AutoSave",t[t.EverlastingGetExp=1]="EverlastingGetExp",t[t.GameXTimeRandomEvent=2]="GameXTimeRandomEvent"}(Y||(Y={}));class N{constructor(){this.isAllPause=!1,this.arrTypePause=[],this.intervalTypePause=[],T.instance.has(null,I.BGTask)||(T.instance.data.BGTask={})}static get instance(){return N._instance||(N._instance=new N),N._instance}init(){this.list=T.instance.get(null,I.BGTask);for(const t in this.list)if(Object.prototype.hasOwnProperty.call(this.list,t)){const e=this.list[t];Y[e.type].startsWith("Offline")||Y[e.type].startsWith("Everlasting")||Y[e.type].startsWith("GameXTime")?D.event(r.OnTaskStart,[e.type,e.arg,!1]):T.instance.delete(t,I.BGTask)}}startup(){this.isAllPause=!1,Laya.timer.loop(100,this,this.tick)}stop(){this.isAllPause=!0,Laya.timer.clear(this,this.tick),this.removeNonPersistent()}pauseAll(){this.isAllPause=!0}restartAll(){this.isAllPause=!1}pause(t){this.arrTypePause.push(t),this.intervalTypePause.push(R.seconds)}restart(t){for(let e=0;e<this.arrTypePause.length;e++)if(this.arrTypePause[e]==t){this.arrTypePause.splice(e,1)[0];let a=this.intervalTypePause.splice(e,1)[0];for(const e in this.list){const i=this.list[e];if(t==i.type){i.startTime+=R.seconds-a;break}}break}}query(t,e){B.isNull(e)&&(e=Y[t]);let a=this.getKey(t,e);return this.list[a]}add(t,e,i,s,o){if(B.isNull(s)&&(s=Y[t]),this.query(t,s))return;let n={type:t,name:Y[t],startTime:e,interval:i,arg:s,loop:o};n.id=this.getKey(t,s),this.list[n.id]=n,(Y[t].startsWith("Offline")||Y[t].startsWith("Everlasting")||Y[t].startsWith("GameXTime"))&&(a.log("存储任务:",Y[t]),T.instance.set(n.id,n,I.BGTask),T.instance.save()),D.event(r.OnTaskStart,[t,s,!0]),this.tick()}remove(t,e){e||(e=Y[t]);let a=this.getKey(t,e);delete this.list[a],(Y[t].startsWith("Offline")||Y[t].startsWith("Everlasting")||Y[t].startsWith("GameXTime"))&&T.instance.delete(a,I.BGTask)}removeAll(){this.list={},T.instance.delete(null,I.BGTask)}removeNonPersistent(){for(const t in this.list)if(Object.prototype.hasOwnProperty.call(this.list,t)){const e=this.list[t];Y[e.type].startsWith("Offline")||Y[e.type].startsWith("Everlasting")||(delete this.list[t],T.instance.delete(t,I.BGTask))}}removeExpectAutoSave(){for(const t in this.list)if(Object.prototype.hasOwnProperty.call(this.list,t)){const e=this.list[t];a.log("removeExpectAutoSave:",Y[e.type]),Y[e.type].startsWith("Offline")||Y[e.type].startsWith("Everlasting")||Y[e.type].startsWith("AutoSave")||(delete this.list[t],T.instance.delete(t,I.BGTask))}}getKey(t,e){let a,i=typeof e;if("number"==i)a=e+"";else if("string"==i)a=e;else{if("object"!=i)throw"unsuport arg type:"+i;a=JSON.stringify(e)}return(t+a).hash()}refresh(){for(const t in this.list){const e=this.list[t];this.arrTypePause.length>0&&this.arrTypePause.indexOf(e.type)>=0||(!Y[e.type].startsWith("GameXTime")||F.instance.IsRunTime&&F.instance.GameClockType!=f.Pause)&&this.runTask(e)}}onTaskComplete(t,e){t.loop?t.startTime=R.seconds:this.remove(t.type,t.arg),D.event(r.OnTaskEnd,[t.type,t.arg,e])}tick(){this.isAllPause||(this.refresh(),D.event(r.OnTaskTick))}runTask(t){if(void 0===t.arg)throw"BGTaskType.Sending Task require ID parameter";let e=R.seconds-t.startTime;e>=t.interval&&this.onTaskComplete(t,e)}}class U{static rand(){return this.seed=(9301*this.seed+49297)%233280,this.seed/233280}}U.seed=(new Date).getTime();class z{static PolarToCartesian(t,e=1){return z.PolarToCartesianRad(t*i.Deg2Rad,e)}static PolarToCartesianRad(t,e=1){return new Laya.Point(i.Cos(t)*e,i.Sin(t)*e)}static VectorToAngle(t){return i.Atan2(t.y,t.x)*i.Rad2Deg}static WrapWithin(t,e,a){return i.Repeat(t-a,a-e)+e}static Map(t,e,a,i,r){return(r-i)*((t-e)/(a-e))+i}static getRandom(t,e,a=!0){return a?Math.floor(Math.random()*(e-t+1)+t):Math.random()*(e-t+1)+t}static getDistance(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}static exchange(t,e,a){t.splice(e,1,...t.splice(a,1,t[e]))}static quickSort(t,e,a){if(1==t.length)return t;if(e<a){let i=e,r=a,s=t[i];for(;e<a;){for(;t[a]>=s&&e<a;)a--;for(e<a&&(t[e++]=t[a]);t[e]<=s&&e<a;)e++;e<a&&(t[a--]=t[e])}return t[e]=s,z.quickSort(t,i,e-1),z.quickSort(t,e+1,r),t}}static quickSort2(t,e,a,i){if(1==t.length)return t;if(a<i){let r=a,s=i,o=t[r];for(;a<i;){for(;t[i][e]<=o[e]&&a<i;)i--;for(a<i&&(t[a++]=t[i]);t[a][e]>=o[e]&&a<i;)a++;a<i&&(t[i--]=t[a])}return t[a]=o,z.quickSort2(t,e,r,a-1),z.quickSort2(t,e,a+1,s),t}}static quickSort3(t,e,a,i){if(1==t.length)return t;if(a<i){let r=a,s=i,o=t[r];for(;a<i;){for(;Number(t[i][e].substr(t[i][e].length-1,1))>=Number(o[e].substr(o[e].length-1,1))&&a<i;)i--;for(a<i&&(t[a++]=t[i]);Number(t[a][e].substr(t[a][e].length-1,1))<=Number(o[e].substr(o[e].length-1,1))&&a<i;)a++;a<i&&(t[i--]=t[a])}return t[a]=o,z.quickSort3(t,e,r,a-1),z.quickSort3(t,e,a+1,s),t}}static quickSort4(t,e,a,i){if(1==t.length)return t;if(a<i){let r=a,s=i,o=t[r];for(;a<i;){for(;t[i][e]>=o[e]&&a<i;)i--;for(a<i&&(t[a++]=t[i]);t[a][e]<=o[e]&&a<i;)a++;a<i&&(t[i--]=t[a])}return t[a]=o,z.quickSort4(t,e,r,a-1),z.quickSort4(t,e,a+1,s),t}}static symmetry(t,e,a,i){var r=e.y-t.y,s=t.x-e.x,o=e.x*t.y-t.x*e.y;return new Laya.Vector2(-(2*r*s*i+(r*r-s*s)*a+2*r*o)/(s*s+r*r),-((s*s-r*r)*i+2*r*s*a+2*s*o)/(s*s+r*r))}static SwapItems(t,e,a){return t.unshift(t[e]),t.splice(e+1,1),t}static getAngle2(t,e,a,i){var r=a-t,s=i-e,o=r/Math.sqrt(Math.pow(r,2)+Math.pow(s,2)),n=Math.acos(o),h=180/(Math.PI/n);return s<0?h=-h:0==s&&r<0&&(h=180),h}static getVectorByAngle(t,e,a){let i=new Laya.Point(0,0);return 0==t?i.setTo(0,0):90==t?i.setTo(1,0):180==t?i.setTo(0,-1):270==t?i.setTo(-1,0):i.setTo(this.getSpeedX(e,t),this.getSpeedY(a,t)),i}static getSpeedX(t,e){return t=Math.abs(t),0==e?t:90==e?0:180==e?-t:270==e?0:this.getCosValue(e)*t}static getSpeedY(t,e){return t=Math.abs(t),0==e?0:90==e?1:180==e?0:270==e?-1:this.getSinValue(e)*t}static getSinValue(t){return Math.sin(t*Math.PI/180)}static getCosValue(t){return Math.cos(t*Math.PI/180)}static intersectionXx(t,e){return!((t[0]>t[2]?t[0]:t[2])<(e[0]<e[2]?e[0]:e[2])||(t[1]>t[3]?t[1]:t[3])<(e[1]<e[3]?e[1]:e[3])||(e[0]>e[2]?e[0]:e[2])<(t[0]<t[2]?t[0]:t[2])||(e[1]>e[3]?e[1]:e[3])<(t[1]<t[3]?t[1]:t[3]))&&!(((t[0]-e[0])*(e[3]-e[1])-(t[1]-e[1])*(e[2]-e[0]))*((t[2]-e[0])*(e[3]-e[1])-(t[3]-e[1])*(e[2]-e[0]))>0||((e[0]-t[0])*(t[3]-t[1])-(e[1]-t[1])*(t[2]-t[0]))*((e[2]-t[0])*(t[3]-t[1])-(e[3]-t[1])*(t[2]-t[0]))>0)}static clipShootAngle(t){var e=new Laya.Point;Math.atan(t.y/t.x),Math.PI;return e.x=t.x,e.y=t.y,e.normalize(),e}static shuffle(t,e=1){for(var a=0;a<e;a++){var i=t.length;for(a=0;a<i;a++){var r=Math.random()*i,s=Math.floor(r);if(s!=a){var o=t[a],n=t[s];t[a]=n,t[s]=o}}}}static itvInsertEle(t,e,a){let i=[];for(let a=0;a<t.length;a+=e)a+e<t.length?i.push(t.slice(a,a+e)):i.push(t.slice(a));return i.forEach(t=>t.length===e?t.push(a):t),[].concat.apply([],i)}static randomNum(t,e,a=!1){var i=[];if(t<=e){for(var r=0;r<t;r++)i.push(r);return i}for(;i.length<e;){var s;s=a?Math.floor(U.rand()*t):Math.floor(Math.random()*t),-1==i.indexOf(s)&&i.push(s)}return i}static randomOneByTradition(t){let e=0;t.forEach(t=>{e+=t});let a=z.randFloat(0,e);for(let e=t.length-1;e>=0;e--){let i=t[e];if(a<i)return e;a-=i}}static randomSomeByTradition(t,e,a){let i=0;t.forEach(t=>{i+=t});let r=[];for(;r.length<e;){let e=z.randFloat(0,i);for(let s=t.length-1;s>=0;s--){if(r.contains(s)&&!a)continue;let o=t[s];if(e<o){r.push(s),a||(i-=o);break}e-=o}}return r}static randomSomeByOriginalSort(t,e){let a=t.map((t,e,a)=>({originIdx:e,value:Math.pow(Math.random(),1/t)})).sort((t,e)=>e.value-t.value);return a.length=e,a}static findTwoNumbersByBinary(t,e){let a=0,i=t.length-1;for(;a<i;){let r=t[a]+t[i];if(r<e)a+=1;else{if(!(r>e))return[t[a],t[i]];i-=1}}}static findTwoNumbersByMap(t,e){t.length;let a={},i=[];a[t[0]]={idx:0};for(let r=1;r<t.length;r++){let s=e-t[r];a[s]&&i.push([a[s].idx,r]),a[t[r]]={idx:r}}return i}static numFixTwo(t){return Math.floor(100*t)/100}static generateUUID(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,a=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(_[255&t]+_[t>>8&255]+_[t>>16&255]+_[t>>24&255]+"-"+_[255&e]+_[e>>8&255]+"-"+_[e>>16&15|64]+_[e>>24&255]+"-"+_[63&a|128]+_[a>>8&255]+"-"+_[a>>16&255]+_[a>>24&255]+_[255&i]+_[i>>8&255]+_[i>>16&255]+_[i>>24&255]).toUpperCase()}static clamp(t,e,a){return Math.max(e,Math.min(a,t))}static euclideanModulo(t,e){return(t%e+e)%e}static mapLinear(t,e,a,i,r){return i+(t-e)*(r-i)/(a-e)}static lerp(t,e,a){return(1-a)*t+a*e}static smoothstep(t,e,a){return t<=e?0:t>=a?1:(t=(t-e)/(a-e))*t*(3-2*t)}static smootherstep(t,e,a){return t<=e?0:t>=a?1:(t=(t-e)/(a-e))*t*t*(t*(6*t-15)+10)}static randInt(t,e){return t+Math.floor(Math.random()*(e-t+1))}static randFloat(t,e){return t+Math.random()*(e-t)}static randFloatSpread(t){return t*(.5-Math.random())}static degToRad(t){return t*z.DEG2RAD}static radToDeg(t){return t*z.RAD2DEG}static isPowerOfTwo(t){return 0==(t&t-1)&&0!==t}static ceilPowerOfTwo(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}static floorPowerOfTwo(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}}z.DEG2RAD=Math.PI/180,z.RAD2DEG=180/Math.PI;for(var _=[],V=0;V<256;V++)_[V]=(V<16?"0":"")+V.toString(16);class K extends Laya.Script{get ID(){return this.data.ID}get Component(){return this.data.Component}get Cost(){return this.data.Cost}get entity(){return this.owner}get x(){return this.entity.x}set x(t){this.entity.x=t}get y(){return this.entity.y}set y(t){this.entity.y=t}static create(t,e){return new Promise(a=>{Laya.loader.load("prefab/MapFunCard.json",Laya.Handler.create(this,i=>{let r=new Laya.Prefab;r.json=i;let s=Laya.Pool.getItemByCreateFun("MapFunCard",r.create,r),o=s.addComponent(K);o.init(e),t.addChild(s),s.pos(0,0),o.setColl(),a(o)}))})}init(t){this.data=t,this.setUI()}setColl(){this.collBoxTwo=new k;let t=this.entity.localToGlobal(new Laya.Point(0,0)),e=new Laya.Point(t.x,t.y),a=new Laya.Point(t.x+this.entity.width,t.y+this.entity.height);this.collBoxTwo.set(e,a)}setUI(){let t=this.entity.getChildByName("card_box"),e=t.getChildByName("card_name"),a=t.getChildByName("card_name2"),i=t.getChildByName("card_icon");e.text=this.data.Name,a.text=this.data.Name2,i.visible=!1}gashapon(){let t=this.data.IncludeHolder,e=this.data.IncludeProbability,a=-1;if(t.length>0){let i=0;a=t[i=z.randomOneByTradition(e)]}let i=this.entity.localToGlobal(new Laya.Point(0,0));-1!=a&&Ae.instance.createHolderCard([i.x-12,i.y],[i.x-12,i.y-120],a)}dispose(){this.entity.removeSelf(),Laya.Pool.recover("MapFunCard",this.entity)}}class q{constructor(t,e,a,i){i&&null!=i?this.repeat(t,i):(this.key=a&&null!=a?a:z.generateUUID(),T.instance.set(this.key,{key:this.key,id:t.ID},e,!1),this.curStat=T.instance.get(this.key,e),this.init(t),T.instance.save())}init(t){this.data=t,this.curStat.dataID=t.ID,this.curStat.homeID=t.HomeID,this.curStat.weaponID=t.WeaponID,this.curStat.name=t.Name,this.curStat.desc=t.Desc,this.curStat.type=t.Type,this.curStat.icon=t.Icon,this.curStat.largeIcon=t.LargeIcon,this.curStat.level=t.Level,this.curStat.completeHp=t.CompleteHp,this.curStat.currentHp=t.CurrentHp,this.curStat.shieleAmout=t.ShieleAmout,this.curStat.atk=t.Atk,this.curStat.dodge=t.Dodge,this.curStat.hit=t.Hit,this.curStat.crit=t.Crit,this.curStat.critDamage=t.CritDamage}repeat(t,e){this.curStat=e,this.key=e.key,this.data=t}}class j{static get instance(){return j._instance||(j._instance=new j),j._instance}init(){this.heroItems={},this.weaponItems={},this.animalItems={},this.enemyItems={}}clearHero(t){this.heroItems[t]&&(this.heroItems[t].atkWeaponKey&&this.clearAtkWeapon(this.heroItems[t].atkWeaponKey),T.instance.delete(t,I.HeroData,!1),delete this.heroItems[t])}clearEnemy(t){this.enemyItems[t]&&(T.instance.delete(t,I.EnemyData,!1),delete this.enemyItems[t])}clearAnimal(t){this.animalItems[t]&&(T.instance.delete(t,I.AnimalData,!1),delete this.animalItems[t])}equipAtkWeapon(t,e){if(this.heroItems[t]){this.heroItems[t].setAtkWeapon(e)}a.log("equipAtkWeapon:",j.instance.weaponItems)}unloadAtkWeapon(t,e){if(this.heroItems[t]){this.heroItems[t].setAtkWeapon(null)}this.clearAtkWeapon(e),a.log("unloadAtkWeapon:",j.instance.weaponItems)}clearAtkWeapon(t){this.weaponItems[t]&&(T.instance.delete(t,I.WeaponData,!1),delete this.weaponItems[t])}}class Q extends q{constructor(t,e,a){super(t,I.HeroData,e,a)}init(t){super.init(t),this.curStat.atkWeaponKey=null,this.curStat.skillAmout=0,this.curStat.talkProficiency=0,this.curStat.gameProficiency=0,this.curStat.talentProficiency=0,this.curStat.cuteProficiency=0,this.curStat.talkAbility=t.TalkAbility,this.curStat.gameAbility=t.GameAbility,this.curStat.talentAbility=t.TalentAbility,this.curStat.cuteAbility=t.CuteAbility,this.curStat.talkMaxAbility=t.TalkMaxAbility,this.curStat.gameMaxAbility=t.GameMaxAbility,this.curStat.talentMaxAbility=t.TalentMaxAbility,this.curStat.cuteMaxAbility=t.CuteMaxAbility,this.curStat.talkMaxProficiency=t.TalkInitProficiency*this.curStat.level,this.curStat.gameMaxProficiency=t.GameInitProficiency*this.curStat.level,this.curStat.talentMaxProficiency=t.TalentInitProficiency*this.curStat.level,this.curStat.cuteMaxProficiency=t.CuteInitProficiency*this.curStat.level,this.curStat.magicCard=[],this.curStat.magicGroov=0,T.instance.get("InputName",I.GameItems)&&(this.curStat.name=this.curStat.name.replace("塔奇波",T.instance.get("InputName",I.GameItems)))}repeat(t,e){super.repeat(t,e)}setTalkProficiency(){this.curStat.talkProficiency+=A.onceAddProficiency,this.curStat.talkProficiency>=this.curStat.talkMaxProficiency&&(this.curStat.talkAbility+=1,this.curStat.talkAbility>=this.curStat.talkMaxAbility?this.curStat.talkAbility=this.curStat.talkMaxAbility:this.upLevelByTalk())}setGameProficiency(){this.curStat.gameProficiency+=A.onceAddProficiency,this.curStat.gameProficiency>=this.curStat.gameMaxProficiency&&(this.curStat.gameAbility+=1,this.curStat.gameAbility>=this.curStat.gameMaxAbility?this.curStat.gameAbility=this.curStat.gameMaxAbility:this.upLevelByGame())}setTalentProficiency(){this.curStat.talentProficiency+=A.onceAddProficiency,this.curStat.talentProficiency>=this.curStat.talentMaxProficiency&&(this.curStat.talentAbility+=1,this.curStat.talentAbility>=this.curStat.talentMaxAbility?this.curStat.talentAbility=this.curStat.talentMaxAbility:this.upLevelByTalent())}setCuteProficiency(){this.curStat.cuteProficiency+=A.onceAddProficiency,this.curStat.cuteProficiency>=this.curStat.cuteMaxProficiency&&(this.curStat.cuteAbility+=1,this.curStat.cuteAbility>=this.curStat.cuteMaxAbility?this.curStat.cuteAbility=this.curStat.cuteMaxAbility:this.upLevelByCute())}upLevelByTalk(){this.curStat.skillAmout++,this.curStat.level++,this.curStat.talkProficiency=0,this.curStat.talkMaxProficiency=this.data.TalkInitProficiency*this.curStat.level}upLevelByGame(){this.curStat.skillAmout++,this.curStat.level++,this.curStat.gameProficiency=0,this.curStat.gameMaxProficiency=this.data.GameInitProficiency*this.curStat.level}upLevelByTalent(){this.curStat.skillAmout++,this.curStat.level++,this.curStat.talentProficiency=0,this.curStat.talentMaxProficiency=this.data.TalentInitProficiency*this.curStat.level}upLevelByCute(){this.curStat.skillAmout++,this.curStat.level++,this.curStat.cuteProficiency=0,this.curStat.cuteMaxProficiency=this.data.CuteInitProficiency*this.curStat.level}setAtkWeapon(t){this.curStat.atkWeaponKey=t}checkAtkWeapon(){return!!this.curStat.atkWeaponKey}getAtkWeapon(){return j.instance.weaponItems[this.curStat.weaponKey]}getDefWeapon(){return j.instance.weaponItems[this.curStat.weaponKey]}get FinalCompleteHp(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().curStat.addCompleteHp),t+this.curStat.completeHp}get FinalAtk(){let t=0,e=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().curStat.atk,e=this.getAtkWeapon().curStat.addAtk),this.curStat.atk+e+t}get FinalShield(){return this.curStat.shieleAmout}get FinalHit(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().curStat.addHit),this.curStat.hit+t}get FinalDodge(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().curStat.addDodge),this.curStat.dodge+t}get FinalCrit(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().curStat.addCrit),this.curStat.crit+t}get FinalCritDamage(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().curStat.addCritDamage),this.curStat.critDamage+t}setLiveProductRate(t){let e=0,a=0,i=0;switch(t){case 1:e=30,a=5,i=1;break;case 2:e=35,a=6,i=1;break;case 3:e=40,a=7,i=1;break;case 4:e=45,a=8,i=1;break;case 5:e=50,a=9,i=2;break;case 6:e=60,a=10,i=3;break;case 7:e=70,a=12,i=4;break;case 8:e=80,a=14,i=5;break;case 9:e=90,a=16,i=6;break;case 10:e=100,a=18,i=8;break;case 11:e=100,a=20,i=10;break;case 12:e=100,a=25,i=15;break;case 13:e=100,a=30,i=20;break;case 14:e=100,a=40,i=25;break;case 15:e=100,a=50,i=30;break;case 16:e=100,a=55,i=35;break;case 17:e=100,a=60,i=30;break;case 18:e=100,a=65,i=40;break;case 19:e=100,a=70,i=45;break;case 20:e=100,a=75,i=50}return[e,a,i]}}class J{constructor(t,e,a){a&&null!=a?this.repeat(t,a):(this.key=e&&null!=e?e:z.generateUUID(),T.instance.set(this.key,{key:this.key,id:t.ID},I.WeaponData,!1),this.curStat=T.instance.get(this.key,I.WeaponData),this.init(t),T.instance.save())}init(t){this.data=t,this.curStat.dataID=t.ID,this.curStat.homeID=t.HomeID,this.curStat.name=t.Name,this.curStat.desc=t.Desc,this.curStat.type=t.Type,this.curStat.icon=t.Icon,this.curStat.largeIcon=t.LargeIcon,this.curStat.level=t.Level,this.curStat.link=t.Link,this.curStat.addCompleteHp=t.AddCompleteHp,this.curStat.shieleAmout=t.ShieleAmout,this.curStat.atk=t.Atk,this.curStat.addDodge=t.AddDodge,this.curStat.addHit=t.AddHit,this.curStat.addCrit=t.AddCrit,this.curStat.addCritDamage=t.AddCritDamage,this.curStat.addAtk=t.AddAtk,this.curStat.durability=t.Durability||0,this.curStat.battleSkill=t.BattleSkill,this.curStat.special=t.Special,this.curStat.rare=t.Rare,this.curStat.effectDebutInfo=t.EffectDebutInfo||"",this.curStat.effectPassiveInfo=t.EffectPassiveInfo||"",this.curStat.effectInitiativeInfo=t.EffectInitiativeInfo||"",this.curStat.attributes=t.Attributes,this.curStat.fightback=t.Fightback,this.curStat.coinPrice=t.Price,this.setAttr()}refreshDurability(t){this.curStat.durability=t}repeat(t,e){this.curStat=e,this.key=e.key,this.data=t}setAttr(){if(-1==this.curStat.attributes){let t=[S.Jin,S.Mu,S.Shui,S.Huo,S.Tu,S.Yin,S.Yang,S.Wu],e=[13,13,13,13,13,11,11,13],a=z.randomOneByTradition(e);this.curStat.attributes=t[a]}}}class $ extends q{constructor(t,e,a){super(t,I.AnimalData,e,a)}init(t){super.init(t),this.curStat.weak=t.Weak}}class Z extends q{constructor(t,e,a){super(t,I.EnemyData,e,a)}init(t){super.init(t),this.curStat.weak=t.Weak}}class tt{constructor(){}init(t,e,i){if(this.data=t,this.curStat.cardID=t.ID,this.curStat.cardType=t.Type,this.curStat.cardName=t.Type==d[d.People]||t.Type==d[d.Weapon]?"":t.Name,this.curStat.cardIcon=t.Type==d[d.People]||t.Type==d[d.Weapon]?"":t.Icon||"",this.curStat.cardDesc=t.Type==d[d.People]||t.Type==d[d.Weapon]?"":t.Desc,this.curStat.cardPrice=t.Price,this.curStat.cardSatiety=t.Satiety,this.curStat.cardLevel=z.randInt(t.Level[0],t.Level[1]),this.curStat.IsSell=t.IsSell,this.curStat.IsOverlay=t.IsOverlay,this.curStat.SameOverlay=t.SameOverlay,this.curStat.IsSave=t.IsSave||"",this.curStat.productionNumber=t.ProductionNumber,this.curStat.IsTame=t.IsTame,this.curStat.IsProductSelf=t.IsProductSelf,this.curStat.productSelfTime=t.ProductSelfTime,this.curStat.productionSelf=t.ProductionSelf,this.curStat.productionSelfProbability=t.ProductionSelfProbability,this.curStat.IsBreaking=t.IsBreaking,this.curStat.breakingTime=t.BreakingTime,this.curStat.breakingTarget=t.BreakingTarget||"",this.curStat.IsBlanking=t.IsBlanking,this.curStat.blankingTime=t.BlankingTime,this.curStat.blankingProduction=t.BlankingProduction,this.curStat.blankingProductionProbability=t.BlankingProductionProbability,this.curStat.mechantProduction=t.MechantProduction,this.curStat.mechantProbability=t.MechantProbability,this.initArgs(),e&&null!=e)for(const t in e)this.curStat[t]=e[t],a.log("MapNormalCardChain3",this.curStat[t],e[t]);if(this.curStat.cardType==d[d.People]){let t=this.createHeroData(!1,i);j.instance.heroItems[t.key]=t,a.log("hero:",t),this.curStat.cardName=t.curStat.name,T.instance.get("InputName",I.GameItems)&&(this.curStat.cardName=this.curStat.cardName.replace("塔奇波",T.instance.get("InputName",I.GameItems))),this.curStat.cardIcon=t.curStat.icon||"",this.curStat.cardDesc=t.curStat.desc||""}else if(this.curStat.cardType==d[d.Weapon]){let t=this.createWeaponData(!1);j.instance.weaponItems[t.key]=t,a.log("weapon:",t),this.curStat.cardName=t.curStat.name,this.curStat.cardIcon=t.curStat.icon||"",this.curStat.cardDesc=t.curStat.desc||""}else if(this.curStat.cardType==d[d.Animal]){let t=this.createAnimalData(!1);j.instance.animalItems[t.key]=t,a.log("animal:",t),this.curStat.cardName=t.curStat.name,this.curStat.cardIcon=t.curStat.icon||"",this.curStat.cardDesc=t.curStat.desc||""}else if(this.curStat.cardType==d[d.Enemy]){let t=this.createEnemyData(!1);j.instance.enemyItems[t.key]=t,a.log("enemy:",t),this.curStat.cardName=t.curStat.name,this.curStat.cardIcon=t.curStat.icon||"",this.curStat.cardDesc=t.curStat.desc||""}else if(this.curStat.cardType==d[d.Place]){if(Ae.instance.currentFans<5e3){let e=z.randomOneByTradition([60,40,0]);this.curStat.cardLevel=e+1,a.log("xPlace1:",e,this.curStat.cardLevel,t.Level)}else if(Ae.instance.currentFans>=5e3&&Ae.instance.currentFans<3e4){let e=z.randomOneByTradition([40,40,5]);this.curStat.cardLevel=e+1,a.log("xPlace2:",e,this.curStat.cardLevel,t.Level)}else{let e=z.randomOneByTradition([20,20,20]);this.curStat.cardLevel=e+1,a.log("xPlace3:",e,this.curStat.cardLevel,t.Level)}switch(this.curStat.cardLevel){case 1:this.curStat.cardDesc="普通难度的副本，探索完能获得卡包。"+this.curStat.cardDesc;break;case 2:this.curStat.cardDesc="困难难度的副本，探索完能获得卡包。"+this.curStat.cardDesc;break;case 3:this.curStat.cardDesc="地狱难度的副本，探索完能获得卡包。"+this.curStat.cardDesc;break;case 99:this.curStat.cardDesc="最终BOSS!!!"+this.curStat.cardDesc}}else if(this.curStat.cardType==d[d.Revelation]){let t=this.createSpecialWeaponData();a.log("swp:",t),this.curStat.cardName=t.RevelationName,this.curStat.cardIcon=t.RevelationIcon||"",this.curStat.cardDesc=t.RevelationDesc||""}}repeat(t,e){if(this.curStat=e,this.key=e.key,this.data=t,0!=this.curStat.productionBookID&&(this.productionBook=E.instance.select(L.MixBook).asDict[this.curStat.productionBookID]),this.curStat.cardType==d[d.People]){let t=this.createHeroData(!0);j.instance.heroItems[t.key]=t,a.log("hero:",t)}else if(this.curStat.cardType==d[d.Weapon]){let t=this.createWeaponData(!0);j.instance.weaponItems[t.key]=t,a.log("weapon:",t)}else if(this.curStat.cardType==d[d.Animal]){let t=this.createAnimalData(!0);j.instance.animalItems[t.key]=t,a.log("animal:",t)}else if(this.curStat.cardType==d[d.Enemy]){let t=this.createEnemyData(!0);j.instance.enemyItems[t.key]=t,a.log("enemy:",t)}}initArgs(){this.curStat.IsProduction=!1,this.curStat.productionBookID=0,this.curStat.currentProductionTime=0,this.productionBook=null,this.curStat.productionKey="",this.curStat.IsShowBar=!1,this.curStat.cardLength=0,this.curStat.saveCardsArr=[],this.curStat.saveEquipArr=[],this.curStat.IsWeak=0,this.curStat.weakSatiety=0,this.curStat.weakTime=0,this.curStat.currentWeakTime=0,this.curStat.IsShowWeakBar=!1,this.curStat.bounceRandTime=[10,20],this.curStat.bounceTime=z.randInt(this.curStat.bounceRandTime[0],this.curStat.bounceRandTime[1]),this.curStat.currentBounceTime=0,this.curStat.currentProductSelfTime=0,this.curStat.currentBreakingTime=0,this.curStat.IsShowBreakingBar=!1,this.curStat.currentBlankingTime=0,this.curStat.IsShowBlankingBar=!1}startProduce(t,e){this.curStat.IsProduction=!0,this.curStat.productionBookID=e,this.productionBook=E.instance.select(L.MixBook).asDict[this.curStat.productionBookID],this.curStat.productionKey=t,this.curStat.currentProductionTime=0}interruptProduce(t){t||(this.curStat.IsProduction=!1,this.productionBook=null,this.curStat.productionKey="",this.curStat.productionBookID=0,this.curStat.currentProductionTime=0)}endProduce(){if(this.curStat.productionNumber>0){let t=0;a.log("this.productionBook.Material:",this.productionBook,this.productionBook.Material);for(let e=0;e<this.productionBook.Material.length;e++){let a=this.productionBook.Material[e];if(0!=a&&(a==this.curStat.cardID||a<0)){t=e;break}}let e=this.productionBook.Cost[t];this.curStat.productionNumber-=e,this.curStat.productionNumber<=0&&(this.curStat.productionNumber=0)}this.curStat.IsProduction=!1,this.productionBook=null,this.curStat.productionKey="",this.curStat.productionBookID=0,this.curStat.currentProductionTime=0}startBreaking(){this.curStat.currentBreakingTime=0,this.curStat.IsShowBreakingBar=!0}endBreaking(){this.curStat.currentBreakingTime=0,this.curStat.IsShowBreakingBar=!1}startBlanking(){this.curStat.currentBlankingTime=0,this.curStat.IsShowBlankingBar=!0}endBlanking(){this.curStat.currentBlankingTime=0,this.curStat.IsShowBlankingBar=!1}upSatiety(t){this.curStat.cardSatiety+=t}enterWeak(t){switch(t){case y.Minor:this.curStat.weakTime=10;break;case y.Seriously:this.curStat.weakTime=20;break;case y.Dying:this.curStat.weakTime=40}this.curStat.IsWeak=t,this.curStat.currentWeakTime=0,this.curStat.IsShowWeakBar=!0}stopWeak(){this.curStat.IsShowWeakBar=!1}restoreWeak(){this.curStat.currentWeakTime=0,this.curStat.IsShowWeakBar=!0}endWeak(){this.curStat.IsWeak=0,this.curStat.weakSatiety=0,this.curStat.weakTime=0,this.curStat.IsShowWeakBar=!1}recoverWeak(){this.endWeak();let t=j.instance.heroItems[this.key];t.curStat.currentHp=t.curStat.completeHp}createHeroData(t,e){let i=E.instance.select(L.BattleHero).asDict,r=null;if(t){let t=T.instance.get(this.key,I.HeroData);r=new Q(i[t.dataID],this.key,t)}else if(0==Ae.instance.mainPlayer.type){for(const t in i)if(i[t]&&i[t].HomeID==this.curStat.cardID&&i[t].Level==this.curStat.cardLevel&&0==i[t].Main){let e=i[t];r=new Q(e,this.key);break}}else{let t=[],s=0;e&&e.length>0&&(e.contains(10078)?s=1:e.contains(10141)?s=2:e.contains(10142)?s=3:e.contains(10143)?s=4:e.contains(10144)&&(s=5));for(const e in i)!i[e]||i[e].HomeID!=this.curStat.cardID||i[e].Level!=this.curStat.cardLevel||0==i[e].Main||0!=s&&i[e].Main!=s||t.push(e);let o=i[t[z.randInt(0,t.length-1)]];a.log("createHeroData:",t,e,i),r=new Q(o,this.key)}return r}createAnimalData(t){let e=E.instance.select(L.BattleAnimal).asDict,a=null;if(t){let t=T.instance.get(this.key,I.AnimalData);a=new $(e[t.dataID],this.key,t)}else{let t=[];for(const a in e)e[a]&&e[a].HomeID==this.curStat.cardID&&e[a].Level==this.curStat.cardLevel&&t.push(a);let i=e[t[z.randInt(0,t.length-1)]];a=new $(i,this.key)}return a}createEnemyData(t){let e=E.instance.select(L.BattleEnemy).asDict,a=null;if(t){let t=T.instance.get(this.key,I.EnemyData);a=new Z(e[t.dataID],this.key,t)}else{let t=[];for(const a in e)e[a]&&e[a].HomeID==this.curStat.cardID&&e[a].Level==this.curStat.cardLevel&&t.push(a);let i=e[t[z.randInt(0,t.length-1)]];a=new Z(i,this.key)}return a}createWeaponData(t){let e=E.instance.select(L.BattleWeapon).asDict,a=null;if(t){let t=T.instance.get(this.key,I.WeaponData);a=new J(e[t.dataID],this.key,t)}else{let t=[];for(const a in e)e[a]&&e[a].HomeID==this.curStat.cardID&&e[a].Level==this.curStat.cardLevel&&t.push(a);let i=e[t[z.randInt(0,t.length-1)]];a=new J(i,this.key)}return a}createSpecialWeaponData(){let t=E.instance.select(L.MixWeapon).asDict,e=[],a=[];for(let i in t)if(t[i]){let r=t[i];e.push(r),a.push(r.RevelationRate)}let i=e[z.randomOneByTradition(a)],r=T.instance.get(i.ID,I.SpecialWeaponData);return r?r.amout+=1:T.instance.set(i.ID,{key:i.ID,id:i.ID,amout:1},I.SpecialWeaponData,!1),T.instance.save(),i}}class et extends Laya.Script{get ID(){return this.data.curStat.cardID}get Type(){return this.data.curStat.cardType}get entity(){return this.owner}get x(){return this.entity.x}set x(t){this.entity.x=t}get y(){return this.entity.y}set y(t){this.entity.y=t}init(t){this.data=t,this.setUI(),this.refreshUI()}setUI(){this.cardFront=this.entity.getChildByName("card_front"),this.cardBox=this.cardFront.getChildByName("card_box"),this.cardIcon=this.cardBox.getChildByName("card_icon"),this.cardPrice=this.cardBox.getChildByName("card_price"),this.cardValue=this.cardBox.getChildByName("card_value"),this.cardName=this.cardBox.getChildByName("card_name"),this.cardBar=this.entity.getChildByName("card_sbar"),this.cardMBar=this.cardBar.getChildByName("card_mbar"),this.cardEBar=this.entity.getChildByName("card_ebar"),this.cardEMBar=this.cardEBar.getChildByName("card_embar"),this.cardWeapon=this.entity.getChildByName("card_weapon"),this.cardWeaponIcon=this.cardWeapon.getChildByName("weapon_icon"),this.cardBar.visible=!1,this.cardMBar.width=0,this.cardEBar.visible=!1,this.cardEMBar.width=0,this.cardWeapon.visible=!1,this.cardWeapon.on(Laya.Event.CLICK,this,()=>{if(this.data.curStat.saveEquipArr.length<=0)return;let t=this.entity.localToGlobal(new Laya.Point(0,0)),e=[t.x+this.entity.width/2,t.y+this.entity.height/2];Ae.instance.addWeaponGroup(this.data.curStat.saveEquipArr[0],[t.x,t.y],e,-1),j.instance.unloadAtkWeapon(this.data.key,this.data.curStat.saveEquipArr[0]),this.data.curStat.saveEquipArr=[],this.refreshWeapon(!1)})}refreshUI(){switch(this.cardName.text=this.data.curStat.cardName,this.cardIcon.skin=""===this.data.curStat.cardIcon?"Icon/init_icon2.png":this.data.curStat.cardIcon,a.log("key3:",this.Type),this.Type){case d[d.Coin]:case d[d.Live]:case d[d.MechantEvent]:this.cardFront.skin="MapCard/Card5.png",this.cardPrice.visible=!1,this.cardValue.visible=!1,this.cardName.color="#000000";break;case d[d.WeirdEvent]:this.cardFront.skin="MapCard/Card8.png",this.cardPrice.visible=!1,this.cardValue.visible=!1,this.cardName.color="#ffffff";break;case d[d.Key]:case d[d.Box]:case d[d.Gift]:this.cardFront.skin="MapCard/Card5.png",this.cardPrice.visible=!0,this.cardValue.visible=!1,this.cardPrice.text=""+this.data.curStat.cardPrice,this.cardName.color="#000000",this.cardPrice.color="#000000";break;case d[d.Food]:this.cardFront.skin="MapCard/Card6.png",this.cardPrice.visible=!0,this.cardValue.visible=!0,this.cardPrice.text=""+this.data.curStat.cardPrice,this.cardValue.text=""+this.data.curStat.cardSatiety,this.cardName.color="#000000",this.cardPrice.color="#000000",this.cardValue.color="#000000";break;case d[d.Place]:this.cardFront.skin="MapCard/Card4.png",this.cardPrice.visible=!0,this.cardValue.visible=!0,this.cardPrice.text=""+this.data.curStat.cardPrice,this.cardValue.text=""+this.data.curStat.cardLevel,this.cardName.color="#ffffff",this.cardPrice.color="#ffffff",this.cardValue.color="#ffffff";break;case d[d.Animal]:this.cardFront.skin="MapCard/Card8.png",this.cardPrice.visible=!1,this.cardValue.visible=!0,this.cardValue.text=""+this.data.curStat.cardLevel,this.cardName.color="#ffffff",this.cardValue.color="#ffffff";break;case d[d.Enemy]:this.cardFront.skin="MapCard/Card7.png",this.cardPrice.visible=!1,this.cardValue.visible=!0,this.cardValue.text=""+this.data.curStat.cardLevel,this.cardName.color="#ffffff",this.cardValue.color="#ffffff";break;case d[d.Idea]:case d[d.Revelation]:this.cardFront.skin="MapCard/Card9.png",this.cardPrice.visible=!0,this.cardValue.visible=!1,this.cardPrice.text=""+this.data.curStat.cardPrice,this.cardName.color="#ffffff",this.cardPrice.color="#ffffff";break;case d[d.People]:this.cardFront.skin="MapCard/Card1.png",this.cardPrice.visible=!1,this.cardValue.visible=!1,this.cardValue.text="",this.cardName.color="#000000",this.cardValue.color="#000000";break;case d[d.Tombstone]:this.cardFront.skin="MapCard/Card1.png",this.cardPrice.visible=!0,this.cardValue.visible=!1,this.cardPrice.text=""+this.data.curStat.cardPrice,this.cardName.color="#000000",this.cardPrice.color="#000000";break;case d[d.Product]:case d[d.Container]:case d[d.Home]:case d[d.WordlessBook]:this.cardFront.skin="MapCard/Card10.png",this.cardPrice.visible=!0,this.cardValue.visible=!1,this.cardPrice.text=""+this.data.curStat.cardPrice,this.cardName.color="#ffffff",this.cardPrice.color="#ffffff";break;case d[d.Weapon]:this.cardFront.skin="MapCard/Card10.png",this.cardPrice.visible=!0,this.cardValue.visible=!0,this.cardPrice.text=""+this.data.curStat.cardPrice,this.cardValue.text=""+this.data.curStat.cardLevel,this.cardName.color="#ffffff",this.cardPrice.color="#ffffff",this.cardValue.color="#ffffff";break;case d[d.Resource]:this.cardFront.skin="MapCard/Card4.png",this.cardPrice.visible=!0,this.cardValue.visible=!1,this.cardPrice.text=""+this.data.curStat.cardPrice,this.cardName.color="#ffffff",this.cardPrice.color="#ffffff";break;case d[d.Building]:this.cardFront.skin="MapCard/Card2.png",this.cardPrice.visible=!0,this.cardValue.visible=!1,this.data.curStat.IsSave?(this.cardPrice.text=""+this.data.curStat.cardLength,a.log("key2:",this.data.curStat.cardLength)):this.cardPrice.text=""+this.data.curStat.cardPrice,this.cardName.color="#000000",this.cardPrice.color="#000000"}}refreshWeapon(t){if(this.cardWeapon.visible=t,t&&this.data.curStat.saveEquipArr.length>0){this.cardWeapon.rotation=z.randInt(-3,3);let t=j.instance.weaponItems[this.data.curStat.saveEquipArr[0]];t&&(this.cardWeaponIcon.skin=t.curStat.icon?t.curStat.icon:"Icon/init_icon.png"),a.log("weaponStat:",this.data.curStat.saveEquipArr[0],j.instance.weaponItems,t)}}setXY(...t){let e=t[0],a=t[1];this.entity.pos(e,a)}syncOrder(){this.entity.zOrder=this.y+this.entity.height}showTimeBar(){a.log("showTimeBar"),this.cardBar.visible=!0,this.cardMBar.width=this.data.curStat.currentProductionTime}addTimeBar(t){this.cardBar.visible=!0,this.cardMBar.bgColor="#e2e2e2";let e=this.cardBar.width-2;if(this.data.curStat.currentProductionTime+=e/t,this.data.curStat.currentProductionTime>=e){this.data.curStat.currentProductionTime=e;let t=this.entity.localToGlobal(new Laya.Point(0,0)),a=[t.x+this.entity.width/2,t.y+this.entity.height/2];Ae.instance.endProduce(this.data.curStat.productionKey,[t.x,t.y],a,A.radiusGenerge,this.data.key)}this.cardMBar.width=this.data.curStat.currentProductionTime}hideTimeBar(){this.cardBar.visible=!1,this.cardMBar.width=0}showEnemyTimeBar(){a.log("showEnemyTimeBar"),this.cardBar.visible=!0,this.cardMBar.width=this.data.curStat.currentBreakingTime}addEnemyTimeBar(t){this.cardBar.visible=!0,this.cardMBar.bgColor="#f58f98";let e=this.cardBar.width-2;if(this.data.curStat.currentBreakingTime+=e/t,this.data.curStat.currentBreakingTime>=e){this.data.curStat.currentBreakingTime=e;let t=this.entity.localToGlobal(new Laya.Point(0,0)),a=[t.x+this.entity.width/2,t.y+this.entity.height/2];this.data.curStat.currentBreakingTime=0,Ae.instance.endBreaking(this.data.curStat.breakingTarget,this.data.curStat.cardLevel,this.data.curStat.cardID,[t.x,t.y],a)}this.cardMBar.width=this.data.curStat.currentBreakingTime}hideEnemyTimeBar(){this.cardBar.visible=!1,this.cardMBar.width=0}showDisappearTimeBar(){a.log("showDisappearTimeBar"),this.cardBar.visible=!0,this.cardMBar.width=this.data.curStat.currentBlankingTime}addDisappearTimeBar(t){this.cardBar.visible=!0,this.cardMBar.bgColor="#90d7ec";let e=this.cardBar.width-2;if(this.data.curStat.currentBlankingTime+=e/t,this.data.curStat.currentBlankingTime>=e){this.data.curStat.currentBlankingTime=e;let t=this.entity.localToGlobal(new Laya.Point(0,0));t.x,this.entity.width,t.y,this.entity.height;this.data.endBlanking(),Ae.instance.endBlanking(this.data.key,this.data.curStat.blankingProduction,this.data.curStat.blankingProductionProbability)}this.cardMBar.width=this.data.curStat.currentBlankingTime}hideDisappearTimeBar(){this.cardBar.visible=!1,this.cardMBar.width=0}showCureTimeBar(){a.log("showCureTimeBar"),this.cardBar.visible=!0,this.cardMBar.width=this.data.curStat.currentWeakTime}addCureTimeBar(t){this.cardBar.visible=!0,this.cardMBar.bgColor="#FFFF00";let e=this.cardBar.width-2;if(this.data.curStat.currentWeakTime+=e/t,this.data.curStat.currentWeakTime>=e){this.data.curStat.currentWeakTime=e;let t=this.entity.localToGlobal(new Laya.Point(0,0));t.x,this.entity.width,t.y,this.entity.height;this.data.recoverWeak(),this.hideCureTimeBar()}this.cardMBar.width=this.data.curStat.currentWeakTime}hideCureTimeBar(){this.cardBar.visible=!1,this.cardMBar.width=0}dispose(){this.hideTimeBar(),this.hideEnemyTimeBar(),this.hideDisappearTimeBar(),this.hideCureTimeBar(),this.entity.offAll(),this.entity.removeSelf(),Laya.Pool.recover("MapNormalCard",this.entity)}}class at{constructor(t,e,a,i){this.data=new tt,!e&&a&&null!=a?this.data.repeat(t,a):(this.data.key=z.generateUUID(),T.instance.set(this.data.key,{key:this.data.key,id:t.ID},I.MapNormalCard,!1),this.data.curStat=T.instance.get(this.data.key,I.MapNormalCard),this.data.init(t,a,i),T.instance.save())}dispose(t=!1,e=!1){this.refreshEvent(!1,t,e),this.removeEvent(),null!=this.render&&(this.render.dispose(),this.render=null),null!=this.data&&(T.instance.delete(this.data.key,I.MapNormalCard,!1),T.instance.save(),this.data=null)}createRender(t,e){return new Promise(a=>{Laya.loader.load("prefab/MapNormalCard.json",Laya.Handler.create(this,i=>{let r=new Laya.Prefab;r.json=i;let s=Laya.Pool.getItemByCreateFun("MapNormalCard",r.create,r);Ae.instance.cardParent.addChild(s),this.render=s.addComponent(et),this.render.init(this.data),this.render.setXY(t[0],t[1]),this.checkEquip(),this.refreshEvent(!0,e),this.addEvent(),a()}))})}flushRender(){this.render.refreshUI()}setSaveBox(t){a.log("key:",t),this.data.curStat.saveCardsArr.push(t),this.refreshSaveBox()}refreshSaveBox(){this.data.curStat.cardLength=this.data.curStat.saveCardsArr.length,this.render.refreshUI()}setSaveEquip(t){this.data.curStat.saveEquipArr.push(t),j.instance.equipAtkWeapon(this.data.key,t),this.render.refreshWeapon(!0)}abandonEquip(){j.instance.unloadAtkWeapon(this.data.key,this.data.curStat.saveEquipArr[0]),this.data.curStat.saveEquipArr=[],this.render.refreshWeapon(!1)}checkEquip(){if(this.data.curStat.saveEquipArr.length>0){let t=T.instance.get(this.data.curStat.saveEquipArr[0],I.WeaponData),e=new J(E.instance.select(L.BattleWeapon).asDict[t.dataID],this.data.curStat.saveEquipArr[0],t);j.instance.weaponItems[e.key]=e,this.render.refreshWeapon(!0)}}setTame(t){this.data.curStat.IsTame=t,this.data.curStat.bounceTime=z.randInt(this.data.curStat.bounceRandTime[0],this.data.curStat.bounceRandTime[1]),this.data.curStat.currentBounceTime=0,this.data.curStat.currentProductSelfTime=0}setWeak(t,e){let a=j.instance.heroItems[this.data.key];t?(a.curStat.currentHp=e,a.curStat.currentHp>=a.curStat.completeHp&&(a.curStat.currentHp=a.curStat.completeHp)):a.curStat.currentHp-=e,a.curStat.currentHp<a.curStat.completeHp&&(a.curStat.currentHp/a.curStat.completeHp>=.7?this.data.enterWeak(y.Minor):a.curStat.currentHp/a.curStat.completeHp>=.2&&a.curStat.currentHp/a.curStat.completeHp<.7?this.data.enterWeak(y.Seriously):this.data.enterWeak(y.Dying),this.render.showCureTimeBar())}addEvent(){D.on(r.CallGameTimeEvent,this,this.OnCallGameTimeEvent)}removeEvent(){D.off(r.CallGameTimeEvent,this,this.OnCallGameTimeEvent)}OnCallGameTimeEvent(t,e,a,i){if(this.data&&this.render&&this.data.curStat.IsProduction&&this.data.curStat.IsShowBar&&this.render.addTimeBar(this.data.productionBook.Time*F.minuteHold),this.data&&this.render&&!this.data.curStat.IsProduction&&(this.data.curStat.cardType==d[d.Animal]||this.data.curStat.cardType==d[d.Enemy])&&0==this.data.curStat.IsTame){let t=this.data.curStat.bounceTime*F.minuteHold;this.data.curStat.currentBounceTime+=1,this.data.curStat.currentBounceTime>=t&&(this.data.curStat.bounceTime=z.randInt(this.data.curStat.bounceRandTime[0],this.data.curStat.bounceRandTime[1]),this.data.curStat.currentBounceTime=0,Ae.instance.bounceCard(this.data.key))}if(this.data&&this.render&&!this.data.curStat.IsProduction&&this.data.curStat.cardType==d[d.Animal]&&1==this.data.curStat.IsProductSelf){let t=this.data.curStat.productSelfTime*(1==this.data.curStat.IsTame?.8:1)*F.minuteHold;this.data.curStat.currentProductSelfTime+=1,this.data.curStat.currentProductSelfTime>=t&&(this.data.curStat.currentProductSelfTime=0,Ae.instance.bornCard(this.data.key,this.data.curStat.productionSelf,this.data.curStat.productionSelfProbability))}this.data&&this.render&&!this.data.curStat.IsProduction&&1==this.data.curStat.IsBreaking&&this.data.curStat.IsShowBreakingBar&&this.render.addEnemyTimeBar(this.data.curStat.breakingTime*F.minuteHold),this.data&&this.render&&!this.data.curStat.IsProduction&&1==this.data.curStat.IsBlanking&&this.data.curStat.IsShowBlankingBar&&this.render.addDisappearTimeBar(this.data.curStat.blankingTime*F.minuteHold),this.data&&this.render&&!this.data.curStat.IsProduction&&this.data.curStat.IsWeak>0&&this.data.curStat.IsShowWeakBar&&this.render.addCureTimeBar(this.data.curStat.weakTime*F.minuteHold)}refreshEvent(t,e=!1,i=!1){switch(a.log("refreshEvent:",t,e,this.data.curStat.cardType,this.data.curStat.cardType==d[d.Gift]),this.data.curStat.cardType){case d[d.Coin]:e||D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],1]);break;case d[d.Food]:i||D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],this.data.curStat.cardSatiety]);break;case d[d.Home]:D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],A.onceAddPopulation]);break;case d[d.Container]:D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],A.onceAddCards]);break;case d[d.People]:D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],this.data.curStat.cardSatiety]),t?0==Ae.instance.mainPlayer.type&&(Ae.instance.mainPlayer={type:1,key:this.data.key},T.instance.set("MainPlayer",Ae.instance.mainPlayer,I.GameItems)):(this.data.curStat.IsWeak>0&&(this.data.endWeak(),this.render.hideCureTimeBar()),j.instance.clearHero(this.data.key),1==Ae.instance.mainPlayer.type&&Ae.instance.mainPlayer.key==this.data.key&&(Ae.instance.mainPlayer={type:2,key:this.data.key},T.instance.set("MainPlayer",Ae.instance.mainPlayer,I.GameItems)));break;case d[d.Weapon]:D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],1]),t||e||(a.log("refreshEvent:isSave"),j.instance.clearAtkWeapon(this.data.key));break;case d[d.Enemy]:if(D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],1]),this.data.curStat.IsProduction)return;t?1!=this.data.curStat.IsBreaking||this.data.curStat.IsShowBreakingBar||(this.data.startBreaking(),this.render.showEnemyTimeBar()):(1==this.data.curStat.IsBreaking&&(this.data.endBreaking(),this.render.hideEnemyTimeBar()),j.instance.clearEnemy(this.data.key));break;case d[d.Animal]:D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],1]),t||j.instance.clearEnemy(this.data.key);break;case d[d.Place]:D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],1]),t?1!=this.data.curStat.IsBreaking||this.data.curStat.IsShowBreakingBar||(this.data.startBreaking(),this.render.showEnemyTimeBar()):1==this.data.curStat.IsBreaking&&(this.data.endBreaking(),this.render.hideEnemyTimeBar());break;case d[d.MechantEvent]:case d[d.WeirdEvent]:D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],1]),t?(1!=this.data.curStat.IsBlanking||this.data.curStat.IsShowBlankingBar||(this.data.startBlanking(),this.render.showDisappearTimeBar()),this.data.curStat.cardType==d[d.MechantEvent]&&Ae.instance.changeFunCard(!0,this.data.key)):(1==this.data.curStat.IsBlanking&&(this.data.endBlanking(),this.render.hideDisappearTimeBar()),D.event(r.CloseTopItemDetails,[this.data.key]),this.data.curStat.cardType==d[d.MechantEvent]&&Ae.instance.changeFunCard(!1,this.data.key));break;case d[d.Gift]:a.log("isSave:",t,e,this.data.curStat.cardType),e||D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],1]);break;case d[d.WordlessBook]:D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],1]),t&&D.event(r.CallRandEventWithBook);break;default:D.event(r.CallRefreshCardEvent,[t,d[this.data.curStat.cardType],1])}}recoverState(){switch(this.data.curStat.cardType){case d[d.Animal]:this.setTame(0)}}eatFood(t){D.event(r.CallRefreshCardEvent,[!1,d.Food,t])}}class it{constructor(t=null){this.cardList=null!=t?t:new Array}dispose(t){for(var e=0;e<this.cardList.length;e++)this.cardList[e].dispose(t);this.cardList=[]}findTypeCard(t){let e=[];for(let a=0;a<this.cardList.length;a++)this.cardList[a].data.curStat.cardType==d[t]&&e.push(this.cardList[a]);return e}checkOneTypeCard(t){let e=!0;for(let a=0;a<this.cardList.length;a++)this.cardList[a].data.curStat.cardType!=d[t]&&(e=!1);return e}checkTwoTypeCard(t,e){let a=!0;this.cardList[0].data.curStat.cardType,d[t];for(let t=1;t<this.cardList.length;t++)this.cardList[t].data.curStat.cardType!=d[e]&&(a=!1);return a}checkIsWeakCard(){let t=!1;for(let e=0;e<this.cardList.length;e++)this.cardList[e].data.curStat.IsWeak>0&&(t=!0);return t}getFirstCard(){return this.cardList.length>0?this.cardList[0]:null}getLastCard(){if(this.cardList.length>0){var t=this.cardList.length-1;return this.cardList[t]}return null}getIndexCard(t){return this.cardList.length>0?this.cardList[t]:null}getLastCardIndex(){return this.cardList.length>0?this.cardList.length-1:-1}concat(t){this.cardList=this.cardList.concat(t.cardList),t.cardList.splice(0)}flushAllCardRender(){this.cardList.forEach(t=>{t.render.refreshUI()})}spliteGroupByTopNum(t){let e=null;if(this.cardList.length<=t)e=this.spliteGroup(0);else{let i=this.cardList.length-t;a.log("spliteGroupByTopNum:",i),e=this.spliteGroup(i)}return e}spliteGroupFromFront(t){let e=null;if(t>=this.cardList.length)e=this.cardList,this.cardList=new Array;else{let a=this.cardList.slice(this.cardList.length-t,this.cardList.length),i=this.cardList.slice(0,this.cardList.length-t);e=a,this.cardList.splice(0),this.cardList=i}return new it(e)}clearGroup(){let t=this.cardList;return this.cardList=new Array,new it(t)}spliteGroupFromType(t){let e=this.findTypeCard(t);return this.cardList=this.cardList.minus(e),new it(e)}spliteGroup(t){let e=this.cardList.slice(t);return this.cardList.splice(t),new it(e)}sliceGroup(t){let e=this.cardList.slice(t);return new it(e)}cloneGroup(t){let e=new Array;for(let a=t;a<this.cardList.length;a++){let t=this.cardList[a].data,i=new at(t.data,!0);e.push(i)}return new it(e)}createFull(){this.cardList=new Array,this.cardList=[]}addGroup(t){this.cardList.push(t)}unshiftGroup(t){this.cardList.unshift(t)}}class rt extends Laya.Script{constructor(){super(...arguments),this.initWidth=48,this.initHeight=60,this.shadowEnabled=!1,this.shrinkEnabled=!1,this.bounceEnabled=!1}get entity(){return this.owner}get x(){return this.entity.x}set x(t){this.entity.x=t}get y(){return this.entity.y}set y(t){this.entity.y=t}get RigidBody(){return this.owner.getComponent(Laya.RigidBody)}get BoxCollider(){return this.owner.getComponent(Laya.BoxCollider)}init(t){this.data=t,this.showShadowEnabled(!1),this.setUI(),this.setColl()}setUI(){this.entity.size(this.initWidth,this.initHeight),this.cardShadow=this.entity.getChildByName("card_shadow"),this.cardFront=this.entity.getChildByName("card_front"),this.cardLine=this.entity.getChildByName("card_line"),this.cardLine.alpha=.5,this.cardShadow.size(this.initWidth,this.initHeight),this.cardFront.size(this.initWidth,this.initHeight),this.cardFront.pos(this.cardFront.width/2,this.cardFront.height/2),this.cardShadow.pos(this.cardShadow.width/2,this.cardShadow.height/2),this.showSeleteLine(!1),this.clearSP(),a.log("flushCollision:",this.cardFront.numChildren)}setColl(){this.collBoxTwo=new k,this.showRig(!1)}setXY(...t){let e=t[0],a=t[1];this.entity.pos(e,a),this.refreshColl()}saveXY(){this.data.curStat&&(this.data.curStat.posX=this.x,this.data.curStat.posY=this.y,a.log("refreshKeyArr:",this.data.key,this.x,this.y),T.instance.save())}refreshColl(){let t=new Laya.Point(this.x,this.y),e=new Laya.Point(this.x+this.entity.width,this.y+this.entity.height);this.collBoxTwo.set(t,e)}flushCollision(){this.entity.height=this.initHeight+(this.cardFront.numChildren-1)*rt.lineHeightSpacing,this.BoxCollider.height=this.entity.height,this.cardShadow.height=this.entity.height,this.cardFront.height=this.entity.height,this.cardFront.y=this.cardFront.height/2,this.cardShadow.y=this.cardShadow.height/2}addGroupData(t){for(let e=0;e<t.cardList.length;e++){let a=t.cardList[e];this.entity.addChild(a.render.entity)}this.sortPos(t.cardList),this.flushCollision()}flushGroupList(t,e=!0){for(let t=0;t<this.cardFront.numChildren;t++)this.cardFront.removeChildAt(t);for(let e=0;e<t.cardList.length;e++){let a=t.cardList[e];a.flushRender(),this.cardFront.addChild(a.render.entity)}this.flushCollision(),e&&this.sortPos(t.cardList)}removeCardSp(t){t.removeSelf()}sortAndMoveToPos(t){for(let e=0;e<this.cardFront.numChildren;e++){let a=this.cardFront.getChildAt(e);a.pos(0,0);let i=new Laya.Point(0,e*rt.lineHeightSpacing);e==this.cardFront.numChildren-1?Laya.Tween.to(a,{x:i.x,y:i.y},70*e,Laya.Ease.sineOut,t,0):Laya.Tween.to(a,{x:i.x,y:i.y},70*e,Laya.Ease.sineOut,null,0)}}sortPos(t){a.log("sortPos"),this.shrinkEnabled=!1;for(let t=0;t<this.cardFront.numChildren;t++){let e=this.cardFront.getChildAt(t);Laya.Tween.clearAll(e),e.x=0,e.y=t*rt.lineHeightSpacing,e.zOrder=t}}syncOrder(){this.entity.zOrder=this.y+this.entity.height}showShadow(t){this.shadowEnabled&&(t?(this.entity.zOrder=9999,Laya.Tween.to(this.cardShadow,{x:this.cardShadow.width/2+1.5,y:this.cardShadow.height/2+1.5},50,Laya.Ease.sineOut,null,0,!0),Laya.Tween.to(this.cardFront,{x:this.cardFront.width/2-1.5,y:this.cardFront.height/2-1.5},50,Laya.Ease.sineOut,null,0,!0)):(this.syncOrder(),Laya.Tween.to(this.cardShadow,{x:this.cardShadow.width/2,y:this.cardShadow.height/2},50,Laya.Ease.sineOut,null,0,!0),Laya.Tween.to(this.cardFront,{x:this.cardFront.width/2,y:this.cardFront.height/2},50,Laya.Ease.sineOut,null,0,!0)))}showRig(t){this.RigidBody.enabled=t,this.BoxCollider.enabled=t,t&&this.saveXY()}showShadowEnabled(t){this.shadowEnabled=t}showShrink(t,e){if(t){this.shrinkEnabled=!0;let t=Math.floor((e-this.y)/rt.lineHeightSpacing)>=this.cardFront.numChildren-1?this.cardFront.numChildren-1:Math.floor((e-this.y)/rt.lineHeightSpacing);for(let e=0;e<this.cardFront.numChildren;e++){let a=this.cardFront.getChildAt(e);Laya.Tween.clearAll(a),Laya.Tween.to(a,{x:0,y:t*rt.lineHeightSpacing},30*e,Laya.Ease.sineOut,null,0,!0)}this.entity.height=this.initHeight,this.BoxCollider.height=this.entity.height,this.cardShadow.height=this.entity.height,this.cardFront.height=this.entity.height,this.cardFront.y=this.cardFront.height/2,this.cardShadow.y=this.cardShadow.height/2}else{this.shrinkEnabled=!1,this.flushCollision();for(let t=0;t<this.cardFront.numChildren;t++){let e=this.cardFront.getChildAt(t);Laya.Tween.clearAll(e),Laya.Tween.to(e,{x:0,y:t*rt.lineHeightSpacing},30*t,Laya.Ease.sineOut,null,0,!0),e.zOrder=t}}}showSeleteLine(t){t&&(this.cardLine.y=(this.cardFront.numChildren-1)*rt.lineHeightSpacing-2),this.cardLine.visible=t}showBounce(){this.bounceEnabled=!0,this.showRig(!1),this.showShadow(!0);let t=[this.x,this.y],e=z.randInt(50,100),a=Ae.instance.getEndPos(t,e);Laya.Tween.to(this.entity,{x:a[0],y:a[1]},250,Laya.Ease.sineOut,new Laya.Handler(this,()=>{this.bounceEnabled=!1,this.showRig(!0),this.showShadow(!1)}))}clearSP(){for(;this.cardFront.numChildren>0;)this.cardFront.removeChildAt(0)}dispose(){if(null!=this.entity){Laya.Tween.clearAll(this.entity),Laya.Tween.clearAll(this.cardFront),Laya.Tween.clearAll(this.cardShadow);for(let t=0;t<this.cardFront.numChildren;t++){let e=this.cardFront.getChildAt(t);Laya.Tween.clearAll(e)}this.entity.removeSelf(),Laya.Pool.recover("MapNormalGroupCard",this.entity)}}}rt.lineHeightSpacing=20;class st{constructor(t=!1,e){this.data=new it,t||(e?(this.data.curStat=e,this.data.key=e.key):(this.data.key=z.generateUUID(),T.instance.set(this.data.key,{key:this.data.key},I.MapNormalCardGroup,!1),this.data.curStat=T.instance.get(this.data.key,I.MapNormalCardGroup),T.instance.save()))}addEvent(){D.on(r.CallStartProduce,this,this.OnCallStartProduce),D.on(r.CallEndProduce,this,this.OnCallEndProduce),D.on(r.CallInterruptProduce,this,this.OnCallInterruptProduce)}removeEvent(){D.off(r.CallStartProduce,this,this.OnCallStartProduce),D.off(r.CallEndProduce,this,this.OnCallEndProduce),D.off(r.CallInterruptProduce,this,this.OnCallInterruptProduce)}createRender(t){return new Promise(e=>{Laya.loader.load("prefab/MapNormalGroupCard.json",Laya.Handler.create(this,a=>{let i=new Laya.Prefab;i.json=a;let r=Laya.Pool.getItemByCreateFun("MapNormalGroupCard",i.create,i);Ae.instance.cardParent.addChild(r),this.render=r.addComponent(rt),this.render.init(this.data),this.render.setXY(t[0],t[1]),this.addEvent(),e()}))})}flushRender(t=!0){this.render.flushGroupList(this.data,t),this.refreshKeyArr()}refreshKeyArr(){if(this.data.curStat){if(this.data.curStat.cardKeyList=[],this.data.cardList.length>0){let t=[];this.data.cardList.forEach(e=>{t.push(e.data.key)}),this.data.curStat.cardKeyList=t}T.instance.save()}}initArgs(){this.data.cardList.forEach((t,e)=>{t.data.initArgs()})}OnCallStartProduce(t,e,a){this.data.cardList.forEach((i,r)=>{e.contains(i.data.key)&&(i.data.startProduce(t,a),i.data.key==e[0]&&(i.data.curStat.cardType==d[d.Enemy]&&1==i.data.curStat.IsBreaking?(i.data.endBreaking(),i.render.hideEnemyTimeBar()):i.data.curStat.cardType==d[d.People]&&i.data.curStat.IsWeak>0&&(i.data.stopWeak(),i.render.hideCureTimeBar()),i.data.curStat.IsShowBar=!0,i.render.showTimeBar()),T.instance.save())})}OnCallEndProduce(t){let e=!1,i=!1;for(let a=0;a<this.data.cardList.length;a++){const r=this.data.cardList[a];if(t.contains(r.data.key)){if(e=!0,r.data.endProduce(),r.data.key==t[0]&&(r.data.curStat.IsShowBar=!1,r.render.hideTimeBar()),0==r.data.curStat.productionNumber){this.data.cardList.splice(a--,1)[0].dispose(!1),i=!0}T.instance.save()}}e&&(0==this.data.cardList.length?Ae.instance.clearGroupCard(this):(a.log("OnCallEndProduce: again"),Ae.instance.checkMixBookItem(this),i&&this.flushRender()))}OnCallInterruptProduce(t){this.data.cardList.forEach((e,a)=>{t.contains(e.data.key)&&(e.data.interruptProduce(!1),e.data.key==t[0]&&(e.data.curStat.IsShowBar=!1,e.render.hideTimeBar(),e.data.curStat.cardType==d[d.Enemy]&&1==e.data.curStat.IsBreaking?(e.data.startBreaking(),e.render.showEnemyTimeBar()):e.data.curStat.cardType==d[d.People]&&e.data.curStat.IsWeak>0&&(e.data.restoreWeak(),e.render.showCureTimeBar())),T.instance.save())})}dispose(){this.removeEvent(),null!=this.render&&(this.render.dispose(),this.render=null),null!=this.data&&(a.log("deletegroup:",this.data.key),T.instance.delete(this.data.key,I.MapNormalCardGroup,!1),T.instance.save(),this.data=null)}}var ot,nt,ht,lt,ct,dt,pt,ft,mt,yt=Laya.ClassUtils.regClass;!function(t){!function(t){class e extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(e.uiView)}}e.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.5},compId:11},{type:"Box",props:{y:0,x:0,width:400,var:"box",height:400,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Label",props:{y:82,text:"是否进入战斗",fontSize:40,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,anchorX:.5},compId:5},{type:"Image",props:{y:244,width:140,var:"yesBtn",valign:"middle",text:"关闭",sizeGrid:"20,20,20,20",height:80,fontSize:40,color:"#ffffff",centerX:122,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:7,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:12,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:13},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:14},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:15},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:16}]},{type:"Label",props:{text:"进入",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:8}]},{type:"Image",props:{y:244,width:140,var:"noBtn",sizeGrid:"20,20,20,20",height:80,centerX:-123,anchorY:.5,anchorX:.5},compId:9,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:17,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:18},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:19},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:20},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:21}]},{type:"Label",props:{var:"upLb",valign:"middle",text:"取消",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,anchorY:.5,anchorX:.5,align:"center"},compId:10}]}]}],loadList:[],loadList3D:[]},t.BattleConfirminquiryDialogUI=e,yt("ui.Dialogs.BattleConfirminquiryDialogUI",e);class a extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(a.uiView)}}a.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.8},compId:3},{type:"Box",props:{y:0,x:0,width:500,var:"box",height:500,centerY:-50,centerX:0,anchorY:.5,anchorX:.5},compId:4,child:[{type:"Image",props:{y:600,width:140,var:"closeBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:0,bold:!1,anchorX:.5,align:"center"},compId:12,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:13,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:14},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:15},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:16},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:17}]},{type:"Label",props:{text:"关闭",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:18}]},{type:"Label",props:{y:90,var:"detailName",valign:"middle",text:"名字",fontSize:40,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:19},{type:"Box",props:{y:145,width:500,var:"infoBox",height:200,centerX:0},compId:66,child:[{type:"Label",props:{wordWrap:!0,var:"allInfo",valign:"top",top:0,text:"这是一个说明",right:0,left:0,leading:20,fontSize:32,font:"SimHei",color:"#ffffff",bottom:0,bold:!0,align:"center"},compId:67}]}]}],loadList:[],loadList3D:[]},t.DetailShow2DialogUI=a,yt("ui.Dialogs.DetailShow2DialogUI",a);class i extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(i.uiView)}}i.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.8},compId:62},{type:"Box",props:{width:500,var:"box",height:500,centerY:-100,centerX:0,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Image",props:{y:1e3,width:140,var:"closeBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:0,bold:!1,anchorX:.5,align:"center"},compId:19,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:143,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:144},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:145},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:146},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:147}]},{type:"Label",props:{text:"关闭",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:20}]},{type:"Label",props:{y:-60,var:"detailName",valign:"middle",text:"名字",fontSize:40,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:118},{type:"Box",props:{y:-151,x:0,var:"weaponBox"},compId:242,child:[{type:"Box",props:{y:145,x:0,width:500,height:210,centerX:0},compId:280,child:[{type:"Box",props:{width:200,left:0,height:70},compId:281,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:282},{type:"Image",props:{width:100,left:0,height:70},compId:283,child:[{type:"Label",props:{width:100,valign:"middle",text:"属性",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:284}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:285,child:[{type:"Label",props:{y:35,x:50,var:"wpAttr",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:286}]}]},{type:"Box",props:{y:70,width:200,left:0,height:70},compId:287,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:288},{type:"Image",props:{width:100,left:0,height:70},compId:289,child:[{type:"Label",props:{width:100,valign:"middle",text:"攻击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:290}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:291,child:[{type:"Label",props:{y:35,x:50,var:"wpAtk",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:292}]}]},{type:"Box",props:{y:140,width:200,left:0,height:70},compId:293,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:294},{type:"Image",props:{width:100,left:0,height:70},compId:295,child:[{type:"Label",props:{width:100,valign:"middle",text:"耐久度",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:296}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:297,child:[{type:"Label",props:{y:35,x:50,var:"wpDurability",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:298}]}]},{type:"Box",props:{y:0,width:200,right:0,height:70},compId:299,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:300},{type:"Image",props:{width:100,left:0,height:70},compId:301,child:[{type:"Label",props:{width:100,valign:"middle",text:"罕见度",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:302}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:303,child:[{type:"Label",props:{y:35,x:50,var:"wpSpecial",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:304}]}]},{type:"Box",props:{y:70,width:200,right:0,height:70},compId:305,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:306},{type:"Image",props:{width:100,left:0,height:70},compId:307,child:[{type:"Label",props:{width:100,valign:"middle",text:"护盾",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:308}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:309,child:[{type:"Label",props:{y:35,x:50,var:"wpShield",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:310}]}]},{type:"Box",props:{y:140,width:200,right:0,height:70},compId:311,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:312},{type:"Image",props:{width:100,left:0,height:70},compId:313,child:[{type:"Label",props:{width:100,valign:"middle",text:"阶级",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:314}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:315,child:[{type:"Label",props:{y:35,x:50,var:"wpLink",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:316}]}]}]},{type:"Label",props:{y:380,wordWrap:!0,width:500,var:"wpInfo",valign:"top",text:"合成/效果:\\nLv1X+Lv7X\\n",leading:20,height:270,fontSize:28,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,align:"left"},compId:317}]}]}],loadList:[],loadList3D:[]},t.DetailShow3DialogUI=i,yt("ui.Dialogs.DetailShow3DialogUI",i);class r extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(r.uiView)}}r.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.8},compId:62},{type:"Box",props:{width:500,var:"box",height:500,centerY:-100,centerX:0,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Image",props:{y:700,width:140,var:"weaponBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:-150,bold:!1,anchorX:.5,align:"center"},compId:319,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:320,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:321},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:322},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:323},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:324}]},{type:"Label",props:{text:"查看武器",fontSize:30,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:325}]},{type:"Image",props:{y:700,width:140,var:"closeBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:150,bold:!1,anchorX:.5,align:"center"},compId:19,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:143,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:144},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:145},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:146},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:147}]},{type:"Label",props:{text:"关闭",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:20}]},{type:"Label",props:{y:90,var:"detailName",valign:"middle",text:"名字",fontSize:40,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:118},{type:"Box",props:{y:145,x:0,width:500,var:"attrBox",height:210,centerX:0},compId:191,child:[{type:"Box",props:{width:200,var:"hpBox",left:0,height:70},compId:192,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:193},{type:"Image",props:{width:100,left:0,height:70},compId:194,child:[{type:"Label",props:{width:100,valign:"middle",text:"生命",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:195}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:196,child:[{type:"Label",props:{y:35,x:50,var:"hpLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:197}]}]},{type:"Box",props:{y:70,width:200,var:"atkBox",left:0,height:70},compId:198,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:199},{type:"Image",props:{width:100,left:0,height:70},compId:200,child:[{type:"Label",props:{width:100,valign:"middle",text:"攻击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:201}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:202,child:[{type:"Label",props:{y:35,x:50,var:"atkLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:203}]}]},{type:"Box",props:{y:140,width:200,var:"hitBox",left:0,height:70},compId:204,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:205},{type:"Image",props:{width:100,left:0,height:70},compId:206,child:[{type:"Label",props:{width:100,valign:"middle",text:"命中",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:207}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:208,child:[{type:"Label",props:{y:35,x:50,var:"hitLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:209}]}]},{type:"Box",props:{y:0,width:200,var:"dodgeBox",right:0,height:70},compId:216,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:217},{type:"Image",props:{width:100,left:0,height:70},compId:218,child:[{type:"Label",props:{width:100,valign:"middle",text:"闪避",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:219}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:220,child:[{type:"Label",props:{y:35,x:50,var:"dodgeLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:221}]}]},{type:"Box",props:{y:70,width:200,var:"critBox",right:0,height:70},compId:222,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:223},{type:"Image",props:{width:100,left:0,height:70},compId:224,child:[{type:"Label",props:{width:100,valign:"middle",text:"暴击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:225}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:226,child:[{type:"Label",props:{y:35,x:50,var:"critLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:227}]}]},{type:"Box",props:{y:140,width:200,var:"critDamageBox",right:0,height:70},compId:228,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:229},{type:"Image",props:{width:100,left:0,height:70},compId:230,child:[{type:"Label",props:{width:100,valign:"middle",text:"暴击伤害",height:30,fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:231}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:232,child:[{type:"Label",props:{y:35,x:50,var:"critDamageLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:233}]}]},{type:"List",props:{y:250,width:540,var:"treasureList",spaceY:10,spaceX:10,repeatY:3,repeatX:5,height:236,centerX:0},compId:326,child:[{type:"Box",props:{width:100,renderType:"render",height:100},compId:327,child:[{type:"Image",props:{y:0,x:0,width:100,height:100},compId:329,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:330},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:331},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:332},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:333}]},{type:"Label",props:{wordWrap:!0,width:60,valign:"middle",text:"名字名字",name:"name",fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:339},{type:"Label",props:{valign:"middle",text:"12",right:8,name:"amout",fontSize:16,font:"SimHei",color:"#ffffff",bottom:5,bold:!0,anchorY:.5,anchorX:1,align:"right"},compId:347}]}]}]},{type:"Box",props:{y:145,width:500,var:"infoBox",height:200,centerX:0},compId:240,child:[{type:"Label",props:{wordWrap:!0,var:"allInfo",valign:"top",top:0,text:"这是一个说明",right:0,left:0,leading:20,fontSize:32,font:"SimHei",color:"#ffffff",bottom:0,bold:!0,align:"center"},compId:241}]},{type:"Box",props:{y:-151,x:0,var:"weaponBox"},compId:242,child:[{type:"Box",props:{y:145,x:0,width:500,height:210,centerX:0},compId:280,child:[{type:"Box",props:{width:200,left:0,height:70},compId:281,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:282},{type:"Image",props:{width:100,left:0,height:70},compId:283,child:[{type:"Label",props:{width:100,valign:"middle",text:"属性",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:284}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:285,child:[{type:"Label",props:{y:35,x:50,var:"wpAttr",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:286}]}]},{type:"Box",props:{y:70,width:200,left:0,height:70},compId:287,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:288},{type:"Image",props:{width:100,left:0,height:70},compId:289,child:[{type:"Label",props:{width:100,valign:"middle",text:"攻击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:290}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:291,child:[{type:"Label",props:{y:35,x:50,var:"wpAtk",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:292}]}]},{type:"Box",props:{y:140,width:200,left:0,height:70},compId:293,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:294},{type:"Image",props:{width:100,left:0,height:70},compId:295,child:[{type:"Label",props:{width:100,valign:"middle",text:"耐久度",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:296}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:297,child:[{type:"Label",props:{y:35,x:50,var:"wpDurability",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:298}]}]},{type:"Box",props:{y:0,width:200,right:0,height:70},compId:299,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:300},{type:"Image",props:{width:100,left:0,height:70},compId:301,child:[{type:"Label",props:{width:100,valign:"middle",text:"罕见度",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:302}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:303,child:[{type:"Label",props:{y:35,x:50,var:"wpSpecial",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:304}]}]},{type:"Box",props:{y:70,width:200,right:0,height:70},compId:305,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:306},{type:"Image",props:{width:100,left:0,height:70},compId:307,child:[{type:"Label",props:{width:100,valign:"middle",text:"护盾",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:308}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:309,child:[{type:"Label",props:{y:35,x:50,var:"wpShield",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:310}]}]},{type:"Box",props:{y:140,width:200,right:0,height:70},compId:311,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:312},{type:"Image",props:{width:100,left:0,height:70},compId:313,child:[{type:"Label",props:{width:100,valign:"middle",text:"阶级",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:314}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:315,child:[{type:"Label",props:{y:35,x:50,var:"wpLink",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:316}]}]}]},{type:"Label",props:{y:380,wordWrap:!0,width:500,var:"wpInfo",valign:"top",text:"合成/效果:\\nLv1X+Lv7X\\n",leading:20,height:90,fontSize:28,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,align:"left"},compId:317}]}]}],loadList:[],loadList3D:[]},t.DetailShowDialogUI=r,yt("ui.Dialogs.DetailShowDialogUI",r);class s extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(s.uiView)}}s.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.7},compId:3},{type:"Box",props:{y:0,x:0,width:500,var:"box",height:650,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:4,child:[{type:"Box",props:{y:125,x:0,width:500,height:400},compId:9,child:[{type:"Label",props:{y:110,x:-25,var:"title",text:"尽力了",fontSize:60,font:"SimHei",color:"#e6e6e6",centerX:0,bold:!0,anchorY:.5,anchorX:.5},compId:11},{type:"Label",props:{y:229,var:"mainTxt",text:"获得奖励？？？",fontSize:32,font:"Arial",color:"#ffffff",centerX:0,anchorY:.5,anchorX:.5},compId:33},{type:"Image",props:{y:360,x:-25,width:140,var:"backBtn",valign:"middle",text:"关闭",sizeGrid:"20,20,20,20",height:80,fontSize:40,color:"#ffffff",centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:12,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:23,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:24},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:25},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:26},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:27}]},{type:"Label",props:{text:"返回",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:13}]},{type:"Image",props:{y:229,x:225,width:450,visible:!1,var:"videoBtn",sizeGrid:"20,20,20,20",height:100,centerX:0,anchorY:.5,anchorX:.5},compId:14,child:[{type:"Image",props:{y:0,x:0,width:450,height:100},compId:28,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:29},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:30},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:31},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:32}]},{type:"Label",props:{var:"upLb",valign:"middle",text:"看视频重新开始",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:15}]}]}]}],loadList:[],loadList3D:[]},t.ExploreEndDialogUI=s,yt("ui.Dialogs.ExploreEndDialogUI",s);class o extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(o.uiView)}}o.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.8},compId:11},{type:"Box",props:{y:0,x:0,width:400,var:"box",height:400,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Label",props:{y:40,text:"请给狗狗取一个名字",fontSize:40,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,anchorX:.5},compId:5},{type:"TextInput",props:{y:175,width:300,var:"inputName",promptColor:"#978e8e",prompt:"不得超过4个字",height:50,fontSize:28,centerX:0,bgColor:"#ffffff"},compId:23},{type:"Image",props:{y:350,width:140,var:"yesBtn",valign:"middle",text:"关闭",sizeGrid:"20,20,20,20",height:80,fontSize:40,color:"#ffffff",centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:7,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:12,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:13},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:14},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:15},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:16}]},{type:"Label",props:{text:"确定",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:8}]}]}],loadList:[],loadList3D:[]},t.InputDialogUI=o,yt("ui.Dialogs.InputDialogUI",o);class n extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(n.uiView)}}n.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.7},compId:3},{type:"Box",props:{y:0,x:0,width:500,var:"box",height:650,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:4,child:[{type:"Box",props:{y:125,x:0,width:500,height:400},compId:9,child:[{type:"Label",props:{y:110,x:-25,var:"title",text:"尽力了",fontSize:60,font:"SimHei",color:"#e6e6e6",centerX:0,bold:!0,anchorY:.5,anchorX:.5},compId:11},{type:"Label",props:{y:229,x:250,var:"mainTxt",text:"已团灭...",fontSize:32,font:"Arial",color:"#ffffff",centerX:0,anchorY:.5,anchorX:.5},compId:34},{type:"Image",props:{y:360,x:-25,width:160,var:"backBtn",valign:"middle",text:"关闭",sizeGrid:"20,20,20,20",height:80,fontSize:40,color:"#ffffff",centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:12,child:[{type:"Image",props:{y:0,x:0,width:160,height:80},compId:23,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:24},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:25},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:26},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:27}]},{type:"Label",props:{text:"返回首页",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:13}]}]}]}],loadList:[],loadList3D:[]},t.MapEndDialogUI=n,yt("ui.Dialogs.MapEndDialogUI",n);class h extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(h.uiView)}}h.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.8},compId:62},{type:"Box",props:{width:500,var:"box",height:500,centerY:-100,centerX:0,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Image",props:{y:1e3,width:140,var:"weaponBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:-150,bold:!1,anchorX:.5,align:"center"},compId:319,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:320,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:321},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:322},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:323},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:324}]},{type:"Label",props:{text:"查看武器",fontSize:30,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:325}]},{type:"Image",props:{y:1e3,width:140,var:"closeBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:150,bold:!1,anchorX:.5,align:"center"},compId:19,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:143,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:144},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:145},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:146},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:147}]},{type:"Label",props:{text:"关闭",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:20}]},{type:"Label",props:{y:-100,var:"detailName",valign:"middle",text:"设置属性",fontSize:40,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:118},{type:"Box",props:{y:-30,x:25,width:450,var:"playerBox",height:680},compId:390,child:[{type:"Box",props:{width:450,var:"hpBox",height:70},compId:192,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:193},{type:"Image",props:{y:0,x:0,width:100,left:0,height:70},compId:348,child:[{type:"Label",props:{width:100,valign:"middle",text:"生命",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:349}]},{type:"Box",props:{y:0,width:300,right:0,height:70},compId:354,child:[{type:"Image",props:{y:0,x:0,width:100,var:"hpBtn1",height:70},compId:352,child:[{type:"Label",props:{valign:"middle",text:"+",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:353}]},{type:"Image",props:{y:0,x:200,width:100,var:"hpBtn2",height:70},compId:194,child:[{type:"Label",props:{valign:"middle",text:"-",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:195}]},{type:"Image",props:{y:0,x:100,width:100,height:70},compId:196,child:[{type:"Label",props:{y:35,x:50,var:"hpAttr",valign:"middle",text:"5",fontSize:32,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:197}]}]}]},{type:"Box",props:{y:100,width:450,var:"atkBox",height:70},compId:198,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:199},{type:"Image",props:{width:100,left:0,height:70},compId:200,child:[{type:"Label",props:{width:100,valign:"middle",text:"攻击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:201}]},{type:"Box",props:{y:0,x:0,width:300,right:0,height:70},compId:355,child:[{type:"Image",props:{y:0,x:0,width:100,var:"atkBtn1",height:70},compId:356,child:[{type:"Label",props:{valign:"middle",text:"+",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:357}]},{type:"Image",props:{y:0,x:200,width:100,var:"atkBtn2",height:70},compId:358,child:[{type:"Label",props:{valign:"middle",text:"-",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:359}]},{type:"Image",props:{y:0,x:100,width:100,height:70},compId:360,child:[{type:"Label",props:{y:35,x:50,var:"atkAttr",valign:"middle",text:"5",fontSize:32,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:361}]}]}]},{type:"Box",props:{y:200,width:450,var:"hitBox",height:70},compId:204,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:205},{type:"Image",props:{width:100,left:0,height:70},compId:206,child:[{type:"Label",props:{width:100,valign:"middle",text:"命中",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:207}]},{type:"Box",props:{y:0,x:0,width:300,right:0,height:70},compId:362,child:[{type:"Image",props:{y:0,x:0,width:100,var:"hitBtn1",height:70},compId:363,child:[{type:"Label",props:{valign:"middle",text:"+",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:364}]},{type:"Image",props:{y:0,x:200,width:100,var:"hitBtn2",height:70},compId:365,child:[{type:"Label",props:{valign:"middle",text:"-",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:366}]},{type:"Image",props:{y:0,x:100,width:100,height:70},compId:367,child:[{type:"Label",props:{y:35,x:50,var:"hitAttr",valign:"middle",text:"5",fontSize:32,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:368}]}]}]},{type:"Box",props:{y:300,width:450,var:"dodgeBox",height:70},compId:216,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:217},{type:"Image",props:{width:100,left:0,height:70},compId:218,child:[{type:"Label",props:{width:100,valign:"middle",text:"闪避",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:219}]},{type:"Box",props:{y:0,x:0,width:300,right:0,height:70},compId:369,child:[{type:"Image",props:{y:0,x:0,width:100,var:"dodgeBtn1",height:70},compId:370,child:[{type:"Label",props:{valign:"middle",text:"+",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:371}]},{type:"Image",props:{y:0,x:200,width:100,var:"dodgeBtn2",height:70},compId:372,child:[{type:"Label",props:{valign:"middle",text:"-",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:373}]},{type:"Image",props:{y:0,x:100,width:100,height:70},compId:374,child:[{type:"Label",props:{y:35,x:50,var:"dodgeAttr",valign:"middle",text:"5",fontSize:32,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:375}]}]}]},{type:"Box",props:{y:400,width:450,var:"critBox",height:70},compId:222,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:223},{type:"Image",props:{width:100,left:0,height:70},compId:224,child:[{type:"Label",props:{width:100,valign:"middle",text:"暴击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:225}]},{type:"Box",props:{y:0,x:0,width:300,right:0,height:70},compId:376,child:[{type:"Image",props:{y:0,x:0,width:100,var:"critBtn1",height:70},compId:377,child:[{type:"Label",props:{valign:"middle",text:"+",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:378}]},{type:"Image",props:{y:0,x:200,width:100,var:"critBtn2",height:70},compId:379,child:[{type:"Label",props:{valign:"middle",text:"-",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:380}]},{type:"Image",props:{y:0,x:100,width:100,height:70},compId:381,child:[{type:"Label",props:{y:35,x:50,var:"critAttr",valign:"middle",text:"5",fontSize:32,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:382}]}]}]},{type:"Box",props:{y:500,width:450,var:"critDamageBox",height:70},compId:228,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:229},{type:"Image",props:{width:100,left:0,height:70},compId:230,child:[{type:"Label",props:{y:35,x:56,valign:"middle",text:"暴击伤害",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,bold:!1,anchorY:.5,anchorX:.5,align:"left"},compId:231}]},{type:"Box",props:{y:0,x:0,width:300,right:0,height:70},compId:383,child:[{type:"Image",props:{y:0,x:0,width:100,var:"critDamageBtn1",height:70},compId:384,child:[{type:"Label",props:{valign:"middle",text:"+",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:385}]},{type:"Image",props:{y:0,x:200,width:100,var:"critDamageBtn2",height:70},compId:386,child:[{type:"Label",props:{valign:"middle",text:"-",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:387}]},{type:"Image",props:{y:0,x:100,width:100,height:70},compId:388,child:[{type:"Label",props:{y:35,x:50,var:"critDamageAttr",valign:"middle",text:"5",fontSize:32,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:389}]}]}]},{type:"Label",props:{y:650,var:"skillPoint",valign:"middle",text:"可用技能点:1",fontSize:28,font:"SimHei",color:"#ffffff",centerX:-100,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:391},{type:"Image",props:{width:120,var:"skillUseBtn",valign:"middle",text:"关闭",height:60,fontSize:40,color:"#ffffff",centerX:100,bottom:0,bold:!1,anchorX:.5,align:"center"},compId:392,child:[{type:"Image",props:{y:0,x:0,width:120,height:60},compId:393,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:394},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:395},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:396},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:397}]},{type:"Label",props:{text:"确定",fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:398}]},{type:"Label",props:{y:727,x:-25,wordWrap:!0,width:500,var:"descBox",valign:"top",text:"这是一个说明",leading:20,height:250,fontSize:24,font:"SimHei",color:"#ffffff",bold:!0,align:"left"},compId:446}]},{type:"Box",props:{y:-30,x:0,var:"weaponBox"},compId:399,child:[{type:"Box",props:{y:0,x:0,width:500,height:210,centerX:0},compId:400,child:[{type:"Box",props:{width:200,left:0,height:70},compId:401,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:402},{type:"Image",props:{width:100,left:0,height:70},compId:403,child:[{type:"Label",props:{width:100,valign:"middle",text:"属性",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:404}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:405,child:[{type:"Label",props:{y:35,x:50,var:"wpAttr",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:406}]}]},{type:"Box",props:{y:70,width:200,left:0,height:70},compId:407,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:408},{type:"Image",props:{width:100,left:0,height:70},compId:409,child:[{type:"Label",props:{width:100,valign:"middle",text:"攻击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:410}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:411,child:[{type:"Label",props:{y:35,x:50,var:"wpAtk",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:412}]}]},{type:"Box",props:{y:140,width:200,left:0,height:70},compId:413,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:414},{type:"Image",props:{width:100,left:0,height:70},compId:415,child:[{type:"Label",props:{width:100,valign:"middle",text:"耐久度",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:416}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:417,child:[{type:"Label",props:{y:35,x:50,var:"wpDurability",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:418}]}]},{type:"Box",props:{y:0,width:200,right:0,height:70},compId:419,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:420},{type:"Image",props:{width:100,left:0,height:70},compId:421,child:[{type:"Label",props:{width:100,valign:"middle",text:"罕见度",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:422}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:423,child:[{type:"Label",props:{y:35,x:50,var:"wpSpecial",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:424}]}]},{type:"Box",props:{y:70,width:200,right:0,height:70},compId:425,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:426},{type:"Image",props:{width:100,left:0,height:70},compId:427,child:[{type:"Label",props:{width:100,valign:"middle",text:"护盾",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:428}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:429,child:[{type:"Label",props:{y:35,x:50,var:"wpShield",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:430}]}]},{type:"Box",props:{y:140,width:200,right:0,height:70},compId:431,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:432},{type:"Image",props:{width:100,left:0,height:70},compId:433,child:[{type:"Label",props:{width:100,valign:"middle",text:"阶级",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:434}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:435,child:[{type:"Label",props:{y:35,x:50,var:"wpLink",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:436}]}]}]},{type:"Label",props:{y:235,wordWrap:!0,width:500,var:"wpInfo",valign:"top",text:"合成/效果:\\nLv1X+Lv7X\\n",leading:20,height:90,fontSize:28,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,align:"left"},compId:437}]}]}],loadList:[],loadList3D:[]},t.MessageShowDialogUI=h,yt("ui.Dialogs.MessageShowDialogUI",h);class l extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(l.uiView)}}l.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.9},compId:33},{type:"Box",props:{y:667,x:375,width:643,var:"box",height:955,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Label",props:{y:0,x:325,valign:"middle",top:0,text:"特殊武器",fontSize:28,font:"SimHei",color:"#ffffff",centerX:0,bold:!1,anchorX:.5,align:"center"},compId:4},{type:"List",props:{y:55,x:0,width:643,var:"mixList",spaceY:100,spaceX:50,repeatY:3,repeatX:3,height:800,centerX:0},compId:5,child:[{type:"Box",props:{width:181,renderType:"render",height:230},compId:6,child:[{type:"Image",props:{y:0,x:0,width:181,height:230},compId:8,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:9},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:10},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:11},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:12}]},{type:"Image",props:{width:100,name:"icon",height:100,centerY:-20,centerX:0},compId:13},{type:"Label",props:{y:10,x:10,valign:"middle",text:"耐久 1",name:"durability",fontSize:24,font:"SimHei",color:"#ffffff",bold:!0,anchorX:0,align:"left"},compId:14},{type:"Label",props:{y:45,x:138.53125,valign:"middle",text:"x1",name:"amout",italic:!0,fontSize:24,font:"SimHei",color:"#ffffff",bold:!0,anchorX:1,align:"left"},compId:15},{type:"Label",props:{wordWrap:!0,width:120,valign:"middle",text:"名字",name:"name",fontSize:28,font:"SimHei",color:"#ffffff",centerY:-20,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:16},{type:"Label",props:{y:145,x:10,wordWrap:!0,width:80,valign:"middle",text:"属性:火",name:"attr",leading:5,height:20,fontSize:18,font:"SimHei",color:"#ffffff",bold:!0,anchorX:0,align:"left"},compId:32},{type:"Label",props:{y:145,x:170,wordWrap:!0,width:80,valign:"middle",text:"等级:2",name:"link",leading:5,height:20,fontSize:18,font:"SimHei",color:"#ffffff",bold:!0,anchorX:1,align:"right"},compId:34},{type:"Label",props:{y:170,x:10,wordWrap:!0,width:160,valign:"bottom",text:"素材:等级3的矛+等级3的其它武器",name:"info",leading:5,height:50,fontSize:18,font:"SimHei",color:"#ffffff",anchorX:0},compId:17},{type:"Label",props:{y:10,x:171,valign:"middle",text:"SR",name:"special",fontSize:24,font:"SimHei",color:"#ffffff",bold:!0,anchorX:1,align:"right"},compId:35},{type:"Image",props:{y:270,width:120,valign:"middle",text:"关闭",name:"mix",height:60,fontSize:40,color:"#ffffff",centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:18,child:[{type:"Image",props:{y:0,x:0,width:120,height:60},compId:19,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:20},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:21},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:22},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:23}]},{type:"Label",props:{text:"链接",name:"mix_lb",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:24}]}]}]},{type:"Image",props:{width:140,var:"closeBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerY:516,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:25,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:26,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:27},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:28},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:29},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:30}]},{type:"Label",props:{text:"关闭",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:31}]}]}],loadList:[],loadList3D:[]},t.MixWeaponDialogUI=l,yt("ui.Dialogs.MixWeaponDialogUI",l);class c extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(c.uiView)}}c.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.9},compId:23},{type:"Box",props:{y:667,x:375,width:570,var:"box",height:600,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Label",props:{var:"title",valign:"middle",text:"请选择合计等级为N的2把武器",fontSize:28,font:"SimHei",color:"#ffffff",centerY:-400,centerX:0,bold:!1,anchorX:.5,align:"center"},compId:4},{type:"List",props:{x:0,width:570,var:"weaponList",spaceY:90,spaceX:60,repeatY:3,repeatX:3,height:600,centerY:-50},compId:5,child:[{type:"Box",props:{width:150,renderType:"render",height:150},compId:6,child:[{type:"Image",props:{y:0,x:0,width:150,height:150},compId:8,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:9},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:10},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:11},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:12}]},{type:"Image",props:{width:100,name:"icon",height:100,centerY:0,centerX:0},compId:13},{type:"Label",props:{y:10,x:10,valign:"middle",text:"耐久 1",name:"durability",fontSize:20,font:"SimHei",color:"#ffffff",bold:!0,anchorX:0,align:"left"},compId:14},{type:"Label",props:{y:120,x:10,valign:"middle",text:"水",name:"attr",fontSize:20,font:"SimHei",color:"#ffffff",bold:!0,anchorX:0,align:"right"},compId:45},{type:"Label",props:{y:10,x:140,valign:"middle",text:"SR",name:"special",fontSize:20,font:"SimHei",color:"#ffffff",bold:!0,anchorX:1,align:"right"},compId:47},{type:"Label",props:{y:120,x:141,valign:"middle",text:"等级 1",name:"link",fontSize:20,font:"SimHei",color:"#ffffff",bold:!0,anchorX:1,align:"right"},compId:46},{type:"Label",props:{wordWrap:!0,width:120,valign:"middle",text:"名字",name:"name",fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:15},{type:"Image",props:{y:190,x:75,width:120,valign:"middle",text:"关闭",name:"select",height:60,fontSize:40,color:"#ffffff",centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:16,child:[{type:"Image",props:{y:0,x:0,width:120,height:60},compId:17,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:18},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:19},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:20},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:21}]},{type:"Label",props:{text:"选择",name:"select_lb",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:22}]}]}]},{type:"Image",props:{x:0,width:140,var:"closeBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerY:400,centerX:140,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:31,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:40,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:41},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:42},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:43},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:44}]},{type:"Label",props:{text:"关闭",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:33}]},{type:"Image",props:{x:0,width:140,var:"selectBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerY:400,centerX:-140,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:32,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:35,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:36},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:37},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:38},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:39}]},{type:"Label",props:{text:"确定",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:34}]}]}],loadList:[],loadList3D:[]},t.MixWeaponSelectDialogUI=c,yt("ui.Dialogs.MixWeaponSelectDialogUI",c);class d extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(d.uiView)}}d.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.7},compId:3},{type:"Box",props:{y:0,x:0,width:500,var:"box",height:650,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:4,child:[{type:"Box",props:{y:125,x:0,width:500,var:"saveBox",height:400},compId:9,child:[{type:"Label",props:{text:"离线产出经验池",fontSize:40,font:"SimHei",color:"#c0c0c0",centerX:0,bold:!0,anchorX:.5},compId:10},{type:"Label",props:{y:110,x:-25,var:"expSaveLb",text:"9999/10000",fontSize:60,font:"SimHei",color:"#e6e6e6",centerX:0,bold:!0,anchorY:.5,anchorX:.5},compId:11},{type:"Image",props:{y:360,x:-25,width:140,var:"directSaveBtn",valign:"middle",text:"关闭",sizeGrid:"20,20,20,20",height:80,fontSize:40,color:"#ffffff",centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:12,child:[{type:"Label",props:{text:"领取",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:13}]},{type:"Image",props:{y:229,x:225,width:450,var:"videoSaveBtn",sizeGrid:"20,20,20,20",height:100,centerX:0,anchorY:.5,anchorX:.5},compId:14,child:[{type:"Label",props:{var:"upLb",valign:"middle",text:"视频双倍领取",fontSize:40,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:15}]}]}]}],loadList:[],loadList3D:[]},t.OfflineExpDialogUI=d,yt("ui.Dialogs.OfflineExpDialogUI",d);class p extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(p.uiView)}}p.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.5},compId:11},{type:"Box",props:{y:0,x:0,width:400,var:"box",height:400,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Label",props:{y:40,text:"是否退出战斗?",fontSize:40,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,anchorX:.5},compId:5},{type:"Label",props:{y:160,text:"中途退出无法获得奖励",fontSize:28,font:"Arial",color:"#ffffff",centerX:0,anchorX:.5},compId:22},{type:"Image",props:{y:320,width:140,var:"yesBtn",valign:"middle",text:"关闭",sizeGrid:"20,20,20,20",height:80,fontSize:40,color:"#ffffff",centerX:130,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:7,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:12,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:13},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:14},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:15},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:16}]},{type:"Label",props:{text:"确定",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:8}]},{type:"Image",props:{y:320,width:140,var:"noBtn",sizeGrid:"20,20,20,20",height:80,centerX:-130,anchorY:.5,anchorX:.5},compId:9,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:17,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:18},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:19},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:20},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:21}]},{type:"Label",props:{valign:"middle",text:"取消",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,anchorY:.5,anchorX:.5,align:"center"},compId:10}]}]}],loadList:[],loadList3D:[]},t.QuitDialogUI=p,yt("ui.Dialogs.QuitDialogUI",p);class f extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(f.uiView)}}f.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Box",props:{y:0,x:0,width:300,var:"box",height:200,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:4,child:[{type:"Label",props:{y:-517,x:-150,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.7},compId:3},{type:"Image",props:{y:0,x:0,width:300,height:200},compId:40,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:41},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:42},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:43},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:44}]}]}],loadList:[],loadList3D:[]},t.RandNumberDialogUI=f,yt("ui.Dialogs.RandNumberDialogUI",f);class m extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(m.uiView)}}m.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.9},compId:33},{type:"Box",props:{y:667,x:375,width:643,var:"box",height:955,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Image",props:{width:140,var:"closeBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerY:516,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:25,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:26,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:27},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:28},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:29},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:30}]},{type:"Label",props:{text:"关闭",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:31}]},{type:"Box",props:{y:0,var:"specialWeaponBox",centerX:0},compId:36,child:[{type:"Label",props:{y:0,x:325,valign:"middle",top:0,text:"特殊武器",fontSize:28,font:"SimHei",color:"#ffffff",centerX:0,bold:!1,anchorX:.5,align:"center"},compId:4},{type:"List",props:{y:55,x:0,width:643,var:"specialWeaponList",spaceY:50,spaceX:50,repeatY:4,repeatX:3,height:850},compId:5,child:[{type:"Box",props:{width:181,renderType:"render",height:230},compId:6,child:[{type:"Image",props:{y:0,x:0,width:181,height:230},compId:8,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:9},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:10},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:11},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:12}]},{type:"Image",props:{width:100,name:"icon",height:100,centerY:-20,centerX:0},compId:13},{type:"Label",props:{y:10,x:10,valign:"middle",text:"耐久 1",name:"durability",fontSize:24,font:"SimHei",color:"#ffffff",bold:!0,anchorX:0,align:"left"},compId:14},{type:"Label",props:{y:45,x:138.53125,valign:"middle",text:"x1",name:"amout",italic:!0,fontSize:24,font:"SimHei",color:"#ffffff",bold:!0,anchorX:1,align:"left"},compId:15},{type:"Label",props:{wordWrap:!0,width:120,valign:"middle",text:"名字",name:"name",fontSize:28,font:"SimHei",color:"#ffffff",centerY:-20,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:16},{type:"Label",props:{y:145,x:10,wordWrap:!0,width:80,valign:"middle",text:"属性:火",name:"attr",leading:5,height:20,fontSize:18,font:"SimHei",color:"#ffffff",bold:!0,anchorX:0,align:"left"},compId:32},{type:"Label",props:{y:145,x:170,wordWrap:!0,width:80,valign:"middle",text:"等级:2",name:"link",leading:5,height:20,fontSize:18,font:"SimHei",color:"#ffffff",bold:!0,anchorX:1,align:"right"},compId:34},{type:"Label",props:{y:170,x:10,wordWrap:!0,width:160,valign:"bottom",text:"素材:等级3的矛+等级3的其它武器",name:"info",leading:5,height:50,fontSize:18,font:"SimHei",color:"#ffffff",anchorX:0},compId:17},{type:"Label",props:{y:10,x:171,valign:"middle",text:"SR",name:"special",fontSize:24,font:"SimHei",color:"#ffffff",bold:!0,anchorX:1,align:"right"},compId:35}]}]}]},{type:"Box",props:{y:0,x:0,width:750,var:"mixBox",centerX:0},compId:37,child:[{type:"Label",props:{y:0,x:325,valign:"middle",top:0,text:"合成列表",fontSize:28,font:"SimHei",color:"#ffffff",centerX:0,bold:!1,anchorX:.5,align:"center"},compId:38},{type:"List",props:{y:55,width:750,var:"mixList",repeatY:11,repeatX:1,height:837,centerX:0},compId:39,child:[{type:"Box",props:{y:0,x:0,width:750,renderType:"render",height:80},compId:40,child:[{type:"Label",props:{wordWrap:!0,width:700,valign:"middle",name:"mix_lb",leading:5,fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,anchorY:.5,anchorX:.5,align:"center"},compId:60}]}]}]},{type:"Box",props:{y:1,x:-53,width:750,var:"descBox",centerX:0},compId:63,child:[{type:"Label",props:{y:0,x:325,valign:"middle",top:0,text:"说明",fontSize:28,font:"SimHei",color:"#ffffff",centerX:0,bold:!1,anchorX:.5,align:"center"},compId:64},{type:"Label",props:{y:95,wordWrap:!0,width:700,text:"看了大半年的vtuber，颇有感悟，于是写了这个缝合怪游戏。模拟经营模块缝合了《堆叠大陆》，并做了一些修改；战斗模块缝合了《Forward》，并简单的引入了《八方旅人》的破盾机制。虽然游戏很简陋，但用来自娱自乐足够了。没有新手引导，数值也是瞎填的，如果要玩的话就请慢慢摸索吧...",leading:20,height:750,fontSize:24,font:"SimHei",color:"#ffffff",centerX:0,bold:!1,anchorX:.5,align:"left"},compId:68},{type:"Label",props:{y:335,valign:"middle",text:"-碎破龙冰",right:25,fontSize:24,font:"SimHei",color:"#ffffff",bold:!1,anchorX:1,align:"center"},compId:69},{type:"Label",props:{y:379,var:"version",valign:"middle",text:"demo_1.0.3",right:25,fontSize:20,font:"SimHei",color:"#ffffff",bold:!1,anchorX:1,align:"right"},compId:70}]}]}],loadList:[],loadList3D:[]},t.SettingDeatil1DialogUI=m,yt("ui.Dialogs.SettingDeatil1DialogUI",m);class y extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(y.uiView)}}y.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.7},compId:3},{type:"Box",props:{y:0,x:0,width:500,var:"box",height:650,centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:4,child:[{type:"Image",props:{x:250,width:400,var:"specialWeaponBtn",sizeGrid:"20,20,20,20",height:100,centerY:-250,centerX:0,anchorY:.5,anchorX:.5},compId:10,child:[{type:"Image",props:{y:0,x:0,width:400,height:100},compId:12,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:13},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:14},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:15},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:16}]},{type:"Label",props:{valign:"middle",text:"查看已解锁的特殊武器",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:11}]},{type:"Image",props:{width:400,var:"youlikaBtn",sizeGrid:"20,20,20,20",height:100,centerY:-100,centerX:0,anchorY:.5,anchorX:.5},compId:17,child:[{type:"Image",props:{y:0,x:0,width:400,height:100},compId:18,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:19},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:20},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:21},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:22}]},{type:"Label",props:{valign:"middle",text:"查看已解锁的尤里卡",fontSize:36,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:23}]},{type:"Image",props:{x:250,width:400,var:"mixBookBtn",sizeGrid:"20,20,20,20",height:100,centerY:50,centerX:0,anchorY:.5,anchorX:.5},compId:31,child:[{type:"Image",props:{y:0,x:0,width:400,height:100},compId:32,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:33},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:34},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:35},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:36}]},{type:"Label",props:{valign:"middle",text:"查看合成表",fontSize:38,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:37}]},{type:"Image",props:{width:200,var:"backBtn",sizeGrid:"20,20,20,20",height:80,centerY:250,centerX:-160,anchorY:.5,anchorX:.5},compId:24,child:[{type:"Image",props:{y:0,x:0,width:200,height:80},compId:25,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:26},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:27},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:28},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:29}]},{type:"Label",props:{valign:"middle",text:"返回首页",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:30}]},{type:"Image",props:{width:200,var:"closeBtn",sizeGrid:"20,20,20,20",height:80,centerY:250,centerX:160,anchorY:.5,anchorX:.5},compId:45,child:[{type:"Image",props:{y:0,x:0,width:200,height:80},compId:46,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:47},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:48},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:49},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:50}]},{type:"Label",props:{valign:"middle",text:"关闭",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:51}]}]}],loadList:[],loadList3D:[]},t.SettingDialogUI=y,yt("ui.Dialogs.SettingDialogUI",y);class u extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(u.uiView)}}u.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#000000",alpha:.9},compId:62},{type:"Box",props:{width:500,var:"box",height:500,centerY:-100,centerX:0,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Label",props:{y:-80,x:250,var:"detailName",valign:"middle",text:"名字",fontSize:40,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:118},{type:"Box",props:{y:-30,width:500,name:"attrBox",height:210,centerX:0},compId:191,child:[{type:"Box",props:{width:200,name:"box1",left:0,height:70},compId:192,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:193},{type:"Image",props:{width:100,left:0,height:70},compId:194,child:[{type:"Label",props:{width:100,valign:"middle",text:"属性",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:195}]},{type:"Image",props:{y:0,width:100,right:0,name:"img1",height:70},compId:196,child:[{type:"Label",props:{y:35,x:50,var:"detailAttr",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:197}]}]},{type:"Box",props:{y:70,width:200,name:"box2",left:0,height:70},compId:198,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:199},{type:"Image",props:{width:100,left:0,height:70},compId:200,child:[{type:"Label",props:{width:100,valign:"middle",text:"攻击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:201}]},{type:"Image",props:{y:0,width:100,right:0,name:"img2",height:70},compId:202,child:[{type:"Label",props:{y:35,x:50,var:"detailAtk",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:203}]}]},{type:"Box",props:{y:140,width:200,name:"box3",left:0,height:70},compId:204,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:205},{type:"Image",props:{width:100,left:0,height:70},compId:206,child:[{type:"Label",props:{width:100,valign:"middle",text:"耐久度",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:207}]},{type:"Image",props:{y:0,width:100,right:0,name:"img3",height:70},compId:208,child:[{type:"Label",props:{y:35,x:50,var:"detailDurability",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:209}]}]},{type:"Box",props:{y:0,width:200,right:0,name:"box4",height:70},compId:210,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:211},{type:"Image",props:{width:100,left:0,height:70},compId:212,child:[{type:"Label",props:{width:100,valign:"middle",text:"罕见度",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:213}]},{type:"Image",props:{y:0,width:100,right:0,name:"img4",height:70},compId:214,child:[{type:"Label",props:{y:35,x:50,var:"detailSpecial",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:215}]}]},{type:"Box",props:{y:70,width:200,right:0,name:"box5",height:70},compId:216,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:217},{type:"Image",props:{width:100,left:0,height:70},compId:218,child:[{type:"Label",props:{width:100,valign:"middle",text:"护盾",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:219}]},{type:"Image",props:{y:0,width:100,right:0,name:"img5",height:70},compId:220,child:[{type:"Label",props:{y:35,x:50,var:"detailShield",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:221}]}]},{type:"Box",props:{y:140,width:200,right:0,name:"box6",height:70},compId:222,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:223},{type:"Image",props:{width:100,left:0,height:70},compId:224,child:[{type:"Label",props:{width:100,valign:"middle",text:"阶级",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:225}]},{type:"Image",props:{y:0,width:100,right:0,name:"img6",height:70},compId:226,child:[{type:"Label",props:{y:35,x:50,var:"detailLink",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:227}]}]}]},{type:"Label",props:{y:205,wordWrap:!0,width:500,var:"detailInfo",valign:"top",text:"合成/效果:\\nLv1X+Lv7X\\n登场:发动效果效果效果效果\\n永续:巴拉巴拉巴拉巴拉巴拉\\n主动:花费2耐久度，造成伤害伤害伤害伤害伤害伤害伤害伤害伤害",leading:20,height:271,fontSize:28,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,align:"left"},compId:125},{type:"Label",props:{y:834,var:"detailAdd",valign:"middle",text:"已使用2点连击值",fontSize:32,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,anchorY:1,anchorX:.5,align:"center"},compId:190},{type:"Image",props:{y:1e3,x:100,width:140,var:"detailUseBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:-150,bold:!1,anchorX:.5,align:"center"},compId:126,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:158,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:159},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:160},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:161},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:162}]},{type:"Label",props:{wordWrap:!0,width:120,valign:"middle",text:"使用主动技能",fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,align:"center"},compId:127}]},{type:"Image",props:{y:850,x:0,width:160,var:"detailUp1Btn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:-250,bold:!1,anchorX:.5,align:"center"},compId:167,child:[{type:"Image",props:{y:0,x:0,width:160,height:80},compId:168,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:169},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:170},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:171},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:172}]},{type:"Label",props:{wordWrap:!0,width:150,valign:"middle",text:"点击使用1点连击值",fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,align:"center"},compId:173}]},{type:"Image",props:{y:850,x:250,width:160,var:"detailUp2Btn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:0,bold:!1,anchorX:.5,align:"center"},compId:174,child:[{type:"Image",props:{y:0,x:0,width:160,height:80},compId:175,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:176},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:177},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:178},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:179}]},{type:"Label",props:{y:0,x:0,wordWrap:!0,width:150,valign:"middle",text:"点击使用2点连击值",fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,align:"center"},compId:188}]},{type:"Image",props:{y:850,x:500,width:160,var:"detailUp3Btn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:250,bold:!1,anchorX:.5,align:"center"},compId:181,child:[{type:"Image",props:{y:0,x:0,width:160,height:80},compId:182,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:183},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:184},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:185},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:186}]},{type:"Label",props:{y:0,x:0,wordWrap:!0,width:150,valign:"middle",text:"点击使用3点连击值",fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,align:"center"},compId:189}]},{type:"Image",props:{y:1e3,x:400,width:140,var:"detailCloseBtn",valign:"middle",text:"关闭",height:80,fontSize:40,color:"#ffffff",centerX:150,bold:!1,anchorX:.5,align:"center"},compId:19,child:[{type:"Image",props:{y:0,x:0,width:140,height:80},compId:143,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:144},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:145},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:146},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:147}]},{type:"Label",props:{text:"关闭",fontSize:32,font:"SimHei",color:"#ffffff",centerY:0,centerX:0},compId:20}]}]}],loadList:[],loadList3D:[]},t.WeaponShowDialogUI=u,yt("ui.Dialogs.WeaponShowDialogUI",u)}(t.Dialogs||(t.Dialogs={}))}(ot||(ot={})),function(t){!function(t){class e extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(e.uiView)}}e.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Box",props:{y:0,x:0,width:500,var:"box",height:800},compId:3,child:[{type:"Label",props:{y:90,var:"detailName",valign:"middle",text:"名字",fontSize:40,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:18},{type:"Box",props:{y:145,x:0,width:500,var:"attrBox",height:210,centerX:0},compId:19,child:[{type:"Box",props:{width:200,var:"hpBox",left:0,height:70},compId:20,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:21},{type:"Image",props:{width:100,left:0,height:70},compId:22,child:[{type:"Label",props:{width:100,valign:"middle",text:"生命",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:23}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:24,child:[{type:"Label",props:{y:35,x:50,var:"hpLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:25}]}]},{type:"Box",props:{y:70,width:200,var:"atkBox",left:0,height:70},compId:26,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:27},{type:"Image",props:{width:100,left:0,height:70},compId:28,child:[{type:"Label",props:{width:100,valign:"middle",text:"攻击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:29}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:30,child:[{type:"Label",props:{y:35,x:50,var:"atkLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:31}]}]},{type:"Box",props:{y:140,width:200,var:"hitBox",left:0,height:70},compId:32,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:33},{type:"Image",props:{width:100,left:0,height:70},compId:34,child:[{type:"Label",props:{width:100,valign:"middle",text:"命中",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:35}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:36,child:[{type:"Label",props:{y:35,x:50,var:"hitLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:37}]}]},{type:"Box",props:{y:0,width:200,var:"dodgeBox",right:0,height:70},compId:38,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:39},{type:"Image",props:{width:100,left:0,height:70},compId:40,child:[{type:"Label",props:{width:100,valign:"middle",text:"闪避",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:41}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:42,child:[{type:"Label",props:{y:35,x:50,var:"dodgeLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:43}]}]},{type:"Box",props:{y:70,width:200,var:"critBox",right:0,height:70},compId:44,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:45},{type:"Image",props:{width:100,left:0,height:70},compId:46,child:[{type:"Label",props:{width:100,valign:"middle",text:"暴击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:47}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:48,child:[{type:"Label",props:{y:35,x:50,var:"critLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:49}]}]},{type:"Box",props:{y:140,width:200,var:"critDamageBox",right:0,height:70},compId:50,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:51},{type:"Image",props:{width:100,left:0,height:70},compId:52,child:[{type:"Label",props:{width:100,valign:"middle",text:"暴击伤害",height:30,fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:53}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:54,child:[{type:"Label",props:{y:35,x:50,var:"critDamageLb",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:55}]}]},{type:"Label",props:{y:256,x:0,wordWrap:!0,width:500,var:"descBox",valign:"top",text:"这是一个说明",leading:20,height:250,fontSize:24,font:"SimHei",color:"#ffffff",bold:!0,align:"left"},compId:112}]},{type:"Box",props:{y:145,width:500,var:"infoBox",height:200,centerX:0},compId:65,child:[{type:"Label",props:{wordWrap:!0,var:"allInfo",valign:"top",top:0,text:"这是一个说明",right:0,left:0,leading:20,fontSize:32,font:"SimHei",color:"#ffffff",bottom:0,bold:!0,align:"center"},compId:66}]},{type:"Box",props:{y:0,x:0,var:"weaponBox"},compId:67,child:[{type:"Box",props:{y:145,x:0,width:500,height:210,centerX:0},compId:68,child:[{type:"Box",props:{width:200,left:0,height:70},compId:69,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:70},{type:"Image",props:{width:100,left:0,height:70},compId:71,child:[{type:"Label",props:{width:100,valign:"middle",text:"属性",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:72}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:73,child:[{type:"Label",props:{y:35,x:50,var:"wpAttr",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:74}]}]},{type:"Box",props:{y:70,width:200,left:0,height:70},compId:75,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:76},{type:"Image",props:{width:100,left:0,height:70},compId:77,child:[{type:"Label",props:{width:100,valign:"middle",text:"攻击",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:78}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:79,child:[{type:"Label",props:{y:35,x:50,var:"wpAtk",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:80}]}]},{type:"Box",props:{y:140,width:200,left:0,height:70},compId:81,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:82},{type:"Image",props:{width:100,left:0,height:70},compId:83,child:[{type:"Label",props:{width:100,valign:"middle",text:"耐久度",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:84}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:85,child:[{type:"Label",props:{y:35,x:50,var:"wpDurability",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:86}]}]},{type:"Box",props:{y:0,width:200,right:0,height:70},compId:87,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:88},{type:"Image",props:{width:100,left:0,height:70},compId:89,child:[{type:"Label",props:{width:100,valign:"middle",text:"罕见度",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:90}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:91,child:[{type:"Label",props:{y:35,x:50,var:"wpSpecial",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:92}]}]},{type:"Box",props:{y:70,width:200,right:0,height:70},compId:93,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:94},{type:"Image",props:{width:100,left:0,height:70},compId:95,child:[{type:"Label",props:{width:100,valign:"middle",text:"护盾",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:96}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:97,child:[{type:"Label",props:{y:35,x:50,var:"wpShield",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:98}]}]},{type:"Box",props:{y:140,width:200,right:0,height:70},compId:99,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:100},{type:"Image",props:{width:100,left:0,height:70},compId:101,child:[{type:"Label",props:{width:100,valign:"middle",text:"阶级",height:30,fontSize:28,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:102}]},{type:"Image",props:{y:0,width:100,right:0,height:70},compId:103,child:[{type:"Label",props:{y:35,x:50,var:"wpLink",valign:"middle",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:104}]}]}]},{type:"Label",props:{y:380,wordWrap:!0,width:500,var:"wpInfo",valign:"top",text:"合成/效果:\\nLv1X+Lv7X\\n",leading:20,height:90,fontSize:28,font:"SimHei",color:"#ffffff",centerX:0,bold:!0,align:"left"},compId:105}]}]}],loadList:[],loadList3D:[]},t.AddDetailsWithBattleUI=e,yt("ui.Items.AddDetailsWithBattleUI",e);class a extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(a.uiView)}}a.uiView={type:"Scene",props:{width:0,mouseThrough:!0,mouseEnabled:!0,height:0},compId:2,child:[{type:"Box",props:{y:0,x:0,width:500,var:"box",height:150,anchorY:1,anchorX:1},compId:16,child:[{type:"Label",props:{y:0,x:0,width:500,height:150,bgColor:"#cde6c7",alpha:1},compId:17},{type:"Image",props:{y:0,x:0,width:500,height:150},compId:18,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#000000"},compId:19},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#000000"},compId:20},{type:"Label",props:{y:0,x:0,width:0,top:0,left:0,bottom:0,bgColor:"#000000"},compId:21},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#000000"},compId:22}]},{type:"Label",props:{y:77,x:470,wordWrap:!0,width:40,var:"back",valign:"middle",text:"点击返回",height:120,fontSize:24,font:"SimHei",color:"#333333",borderColor:"#333333",bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:23},{type:"Image",props:{y:70,x:100,width:86,visible:!0,var:"seat7",name:"seat7",height:108,anchorY:.5,anchorX:.5},compId:24},{type:"Image",props:{y:70,x:225,width:86,visible:!0,var:"seat6",name:"seat6",height:108,anchorY:.5,anchorX:.5},compId:25},{type:"Image",props:{y:70,x:350,width:86,visible:!0,var:"seat5",name:"seat5",height:108,anchorY:.5,anchorX:.5},compId:26}]}],loadList:[],loadList3D:[]},t.AddDetailsWithLeftUI=a,yt("ui.Items.AddDetailsWithLeftUI",a);class i extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(i.uiView)}}i.uiView={type:"Scene",props:{width:0,height:0},compId:2,child:[{type:"Label",props:{top:0,right:0,left:0,bottom:0,bgColor:"#ffffff",alpha:.1},compId:9},{type:"Box",props:{y:0,x:0,width:330,var:"box",scaleY:.5,scaleX:.5,height:180,anchorY:1,anchorX:1},compId:4,child:[{type:"Label",props:{y:0,x:0,width:330,var:"icon",height:180,bgColor:"#000000",alpha:.5},compId:15},{type:"Image",props:{y:0,x:0,width:330,height:180},compId:10,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:11},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:12},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:13},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:14}]},{type:"Label",props:{top:30,text:"结束本月,喂食...",fontSize:32,font:"SimHei",color:"#ffffff",centerX:0,bold:!0},compId:5},{type:"Label",props:{x:105,width:120,var:"btn_ok",valign:"middle",text:"确定",height:60,fontSize:32,font:"SimHei",color:"#ffffff",bottom:25,borderColor:"#ffffff",align:"center"},compId:8}]}],loadList:[],loadList3D:[]},t.AddDetailsWithRightUI=i,yt("ui.Items.AddDetailsWithRightUI",i);class r extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(r.uiView)}}r.uiView={type:"Scene",props:{width:0,height:0},compId:2,child:[{type:"Label",props:{top:0,right:0,left:0,bottom:0,bgColor:"#ffffff",alpha:.1},compId:9},{type:"Box",props:{y:0,x:0,width:330,var:"box",scaleY:.5,scaleX:.5,height:180,anchorY:1,anchorX:1},compId:4,child:[{type:"Label",props:{y:0,x:0,width:330,var:"icon",height:180,bgColor:"#000000",alpha:.5},compId:15},{type:"Image",props:{y:0,x:0,width:330,height:180},compId:10,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:11},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:12},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:13},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:14}]},{type:"Label",props:{top:30,text:"进入下一个月...",fontSize:32,font:"SimHei",color:"#ffffff",centerX:0,bold:!0},compId:5},{type:"Label",props:{x:105,width:120,var:"btn_ok",valign:"middle",text:"确定",height:60,fontSize:32,font:"SimHei",color:"#ffffff",bottom:25,borderColor:"#ffffff",align:"center"},compId:8}]}],loadList:[],loadList3D:[]},t.AddDetailsWithRight2UI=r,yt("ui.Items.AddDetailsWithRight2UI",r);class s extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(s.uiView)}}s.uiView={type:"Scene",props:{width:0,mouseThrough:!0,mouseEnabled:!0,height:0},compId:2,child:[{type:"Box",props:{y:0,x:0,width:550,var:"box",scaleY:.5,scaleX:.5,height:200},compId:3,child:[{type:"Label",props:{y:0,x:0,width:550,var:"icon",height:200,bgColor:"#000000",alpha:.7},compId:13},{type:"Image",props:{y:0,x:0,width:550,height:200},compId:8,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:9},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:10},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:11},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:12}]},{type:"Label",props:{var:"more",valign:"top",top:10,text:"点击查看详情",right:10,left:10,fontSize:24,font:"Arial",color:"#ffffff",bottom:10,align:"right"},compId:6},{type:"Label",props:{x:25,var:"title",top:15,text:"名字",fontSize:32,font:"SimHei",color:"#ffffff",bold:!0},compId:5},{type:"Box",props:{x:25,var:"playerBox",top:65,bottom:10},compId:98,child:[{type:"Box",props:{x:25,width:450,var:"attrBox",height:80},compId:14,child:[{type:"Box",props:{width:200,left:0,height:40},compId:15,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:16},{type:"Image",props:{width:100,left:0,height:40},compId:17,child:[{type:"Label",props:{width:100,valign:"middle",text:"杂谈",height:30,fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:18}]},{type:"Image",props:{y:0,width:100,right:0,height:40},compId:19,child:[{type:"Label",props:{y:20,x:50,var:"talkAttr",valign:"middle",text:"20/20",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:20},{type:"Image",props:{y:32,x:0,width:100,var:"talkAttrPg1",height:8},compId:69,child:[{type:"Image",props:{y:0,x:0,width:100,height:8},compId:71,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:72},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:73},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:74},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:75}]},{type:"Label",props:{y:2,x:2,width:20,var:"talkAttrPg2",height:4,bgColor:"#ffc20e"},compId:70}]}]}]},{type:"Box",props:{y:0,width:200,right:0,height:40},compId:51,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:52},{type:"Image",props:{width:100,left:0,height:40},compId:53,child:[{type:"Label",props:{width:100,valign:"middle",text:"歌舞",height:30,fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:54}]},{type:"Image",props:{y:0,width:100,right:0,height:40},compId:55,child:[{type:"Label",props:{y:20,x:50,var:"talentAttr",valign:"middle",text:"20",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:56},{type:"Image",props:{y:32,x:0,width:100,var:"talentAttrPg1",height:8},compId:76,child:[{type:"Image",props:{y:0,x:0,width:100,height:8},compId:77,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:78},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:79},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:80},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:81}]},{type:"Label",props:{y:2,x:2,width:20,var:"talentAttrPg2",height:4,bgColor:"#ffc20e"},compId:82}]}]}]},{type:"Box",props:{y:40,width:200,left:0,height:40},compId:57,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:58},{type:"Image",props:{width:100,left:0,height:40},compId:59,child:[{type:"Label",props:{width:100,valign:"middle",text:"游戏",height:30,fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:60}]},{type:"Image",props:{y:0,width:100,right:0,height:40},compId:61,child:[{type:"Label",props:{y:20,x:50,var:"gameAttr",valign:"middle",text:"20",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:62},{type:"Image",props:{y:32,x:0,width:100,var:"gameAttrPg1",height:8},compId:83,child:[{type:"Image",props:{y:0,x:0,width:100,height:8},compId:84,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:85},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:86},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:87},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:88}]},{type:"Label",props:{y:2,x:2,width:20,var:"gameAttrPg2",height:4,bgColor:"#ffc20e"},compId:89}]}]}]},{type:"Box",props:{y:40,width:200,right:0,height:40},compId:63,child:[{type:"Label",props:{y:68,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:64},{type:"Image",props:{width:100,left:0,height:40},compId:65,child:[{type:"Label",props:{width:100,valign:"middle",text:"卖萌",height:30,fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!1,anchorY:.5,anchorX:.5,align:"center"},compId:66}]},{type:"Image",props:{y:0,width:100,right:0,height:40},compId:67,child:[{type:"Label",props:{y:20,x:50,var:"cuteAttr",valign:"middle",text:"20",fontSize:24,font:"SimHei",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:68},{type:"Image",props:{y:32,x:0,width:100,var:"cuteAttrPg1",height:8},compId:90,child:[{type:"Image",props:{y:0,x:0,width:100,height:8},compId:91,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:92},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:93},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:94},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:95}]},{type:"Label",props:{y:2,x:2,width:20,var:"cuteAttrPg2",height:4,bgColor:"#ffc20e"},compId:96}]}]}]}]},{type:"Label",props:{var:"skillPoint",valign:"middle",text:"可用技能点:1",fontSize:24,font:"SimHei",color:"#ffffff",bottom:0,align:"center"},compId:97},{type:"Label",props:{var:"cureLb",valign:"middle",text:"轻伤/治愈中...",fontSize:20,font:"SimHei",color:"#ffffff",centerX:15,bottom:0,align:"center"},compId:101}]},{type:"Box",props:{x:25,var:"otherBox",top:70,bottom:10},compId:99,child:[{type:"Label",props:{wordWrap:!0,width:500,var:"desc",valign:"middle",text:"名字名字名字名字名字名字名字名字名字名字名字名字",leading:8,height:70,fontSize:24,font:"SimHei",color:"#ffffff",align:"left"},compId:7},{type:"Label",props:{y:0,x:0,var:"level",valign:"middle",text:"秘境等级:1",fontSize:24,font:"SimHei",color:"#ffffff",bottom:0,align:"center"},compId:100}]}]}],loadList:[],loadList3D:[]},t.AddDetailsWithTopUI=s,yt("ui.Items.AddDetailsWithTopUI",s);class o extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(o.uiView)}}o.uiView={type:"Scene",props:{width:750,height:1334},compId:2,child:[{type:"Box",props:{width:500,var:"box",height:500},compId:3,child:[{type:"List",props:{y:0,x:0,width:430,var:"treasureList",spaceY:10,spaceX:10,repeatY:3,repeatX:4,height:400},compId:56,child:[{type:"Box",props:{width:100,renderType:"render",height:100},compId:57,child:[{type:"Image",props:{y:0,x:0,width:100,height:100},compId:58,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:59},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:60},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:61},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:62}]},{type:"Label",props:{wordWrap:!0,width:60,valign:"middle",text:"名字名字",name:"name",fontSize:24,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:63},{type:"Label",props:{valign:"middle",text:"12",right:8,name:"amout",fontSize:16,font:"SimHei",color:"#ffffff",bottom:5,bold:!0,anchorY:.5,anchorX:1,align:"right"},compId:64}]}]},{type:"Box",props:{y:400,x:0,width:430,var:"infoBox",height:180},compId:107,child:[{type:"Image",props:{y:0,x:0,width:430,height:180},compId:118,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#ffffff"},compId:119},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#ffffff"},compId:120},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#ffffff"},compId:121},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#ffffff"},compId:122}]},{type:"Label",props:{y:50,var:"detailName",valign:"middle",text:"名字",left:25,fontSize:32,font:"SimHei",color:"#ffffff",bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:115},{type:"Label",props:{y:82,wordWrap:!0,var:"detailDesc",text:"这是一个说明这是一个说明这是一个说明这是一个说明",right:25,left:25,leading:15,height:79,fontSize:28,font:"SimHei",color:"#ffffff",bold:!0,align:"left"},compId:117}]}]}],loadList:[],loadList3D:[]},t.AddDetailsWithTreasureUI=o,yt("ui.Items.AddDetailsWithTreasureUI",o);class n extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(n.uiView)}}n.uiView={type:"Scene",props:{},compId:2,child:[{type:"Box",props:{y:-15,x:0,width:32,var:"box",height:60,anchorX:.5},compId:10,child:[{type:"FontClip",props:{y:15,x:16,width:32,var:"one",value:"1",skin:"Number/num1.png",sheet:"0123456789+-/",scaleY:1,scaleX:1,height:30,anchorY:.5,anchorX:.5},compId:3},{type:"FontClip",props:{y:45,x:16,width:32,var:"two",value:"2",skin:"Number/num1.png",sheet:"0123456789+-/",scaleY:1,scaleX:1,height:30,anchorY:.5,anchorX:.5},compId:4},{type:"Label",props:{y:0,x:0,width:32,renderType:"mask",height:30,bgColor:"#ffffff"},compId:15}]}],loadList:["Number/num1.png"],loadList3D:[]},t.RandNumSkillUIUI=n,yt("ui.Items.RandNumSkillUIUI",n);class h extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(h.uiView)}}h.uiView={type:"Scene",props:{y:2,width:0,height:0},compId:2,child:[{type:"Label",props:{y:-5,x:0,width:1,var:"frf",height:12,bgColor:"#000000",alpha:.5},compId:4,child:[{type:"Label",props:{y:0,x:-3,width:7,height:1,bgColor:"#000000"},compId:11},{type:"Label",props:{y:12,x:-3,width:7,height:1,bgColor:"#000000"},compId:12},{type:"Image",props:{y:12,x:-10,width:20,var:"f1",height:20},compId:6,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:1,bgColor:"#000000"},compId:7},{type:"Label",props:{y:0,x:0,right:0,left:0,height:1,bottom:0,bgColor:"#000000"},compId:8},{type:"Label",props:{y:0,x:0,width:1,top:0,left:0,bottom:0,bgColor:"#000000"},compId:9},{type:"Label",props:{y:0,x:0,width:1,top:0,right:0,bottom:0,bgColor:"#000000"},compId:10}]},{type:"Image",props:{y:32,x:-10,width:20,var:"f2",height:20},compId:13,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:1,bgColor:"#000000"},compId:14},{type:"Label",props:{y:0,x:0,right:0,left:0,height:1,bottom:0,bgColor:"#000000"},compId:15},{type:"Label",props:{y:0,x:0,width:1,top:0,left:0,bottom:0,bgColor:"#000000"},compId:16},{type:"Label",props:{y:0,x:0,width:1,top:0,right:0,bottom:0,bgColor:"#000000"},compId:17}]},{type:"Image",props:{y:52,x:-10,width:20,var:"f3",height:20},compId:19,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:1,bgColor:"#000000"},compId:20},{type:"Label",props:{y:0,x:0,right:0,left:0,height:1,bottom:0,bgColor:"#000000"},compId:21},{type:"Label",props:{y:0,x:0,width:1,top:0,left:0,bottom:0,bgColor:"#000000"},compId:22},{type:"Label",props:{y:0,x:0,width:1,top:0,right:0,bottom:0,bgColor:"#000000"},compId:23}]}]},{type:"Label",props:{y:9,x:0,var:"txt1",valign:"middle",text:"敌",fontSize:16,color:"#ffffff",anchorX:.5,align:"center"},compId:5},{type:"Label",props:{y:29,x:0,var:"txt2",valign:"middle",text:"敌",fontSize:16,color:"#ffffff",anchorX:.5,align:"center"},compId:24},{type:"Label",props:{y:49,x:0,var:"txt3",valign:"middle",text:"敌",fontSize:16,color:"#ffffff",anchorX:.5,align:"center"},compId:25}],loadList:[],loadList3D:[]},t.SignStarUI=h,yt("ui.Items.SignStarUI",h);class l extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(l.uiView)}}l.uiView={type:"Scene",props:{width:750,height:1334},compId:2,loadList:[],loadList3D:[]},t.TestUI=l,yt("ui.Items.TestUI",l);class c extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(c.uiView)}}c.uiView={type:"Scene",props:{width:0,height:0},compId:2,child:[{type:"Box",props:{width:150,var:"box",height:16,anchorY:.5,anchorX:.5},compId:5,child:[{type:"Image",props:{top:0,skin:"UI/Bg/tipsBg.png",right:0,left:0,bottom:0,bgColor:"#000000",alpha:.5},compId:3},{type:"Label",props:{y:25,x:250,var:"showTxt",text:"XXXXXXXXXXXXX",fontSize:14,font:"SimHei",color:"#ffffff",centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:4}]}],loadList:["UI/Bg/tipsBg.png"],loadList3D:[]},t.TipsUIUI=c,yt("ui.Items.TipsUIUI",c);class d extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(d.uiView)}}d.uiView={type:"Scene",props:{},compId:2,child:[{type:"Image",props:{width:1024,var:"box",height:100,anchorY:.5,anchorX:.5},compId:3,child:[{type:"Label",props:{y:100,x:400,var:"mk",top:0,right:0,left:0,bottom:0,bgColor:"#000000",anchorY:.5,anchorX:.5,alpha:.7},compId:4},{type:"Label",props:{y:100,x:399,var:"txt",text:"己方回合",fontSize:20,color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5},compId:5}]}],loadList:[],loadList3D:[]},t.TitleBannerUI=d,yt("ui.Items.TitleBannerUI",d);class p extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(p.uiView)}}p.uiView={type:"Scene",props:{width:0,height:0},compId:2,child:[{type:"Box",props:{width:150,var:"box",height:32,anchorY:.5,anchorX:.5},compId:5,child:[{type:"Label",props:{y:32,x:150,var:"showTxt",valign:"middle",text:"000",strokeColor:"#000000",stroke:2,fontSize:28,font:"Arial",color:"#ffffff",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:4}]}],loadList:[],loadList3D:[]},t.ValuesUIUI=p,yt("ui.Items.ValuesUIUI",p)}(t.Items||(t.Items={}))}(ot||(ot={})),function(t){!function(t){class e extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(e.uiView)}}e.uiView={type:"Scene",props:{width:1024,mouseThrough:!0,mouseEnabled:!0,height:768},compId:2,loadList:[],loadList3D:[]},t.DialogSceneUI=e,yt("ui.Scenes.DialogSceneUI",e);class a extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(a.uiView)}}a.uiView={type:"Scene",props:{width:1024,mouseThrough:!0,mouseEnabled:!0,height:768},compId:2,loadList:[],loadList3D:[]},t.EffectSceneUI=a,yt("ui.Scenes.EffectSceneUI",a);class i extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(i.uiView)}}i.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Image",props:{y:0,x:0,top:0,skin:"UI/Bg/BattleBg.jpg",right:0,left:0,bottom:0},compId:200},{type:"Label",props:{top:0,right:0,left:-2,bottom:0,bgColor:"#000000",alpha:.3},compId:201},{type:"Image",props:{x:310,width:375,visible:!1,height:75,centerX:0,bottom:50},compId:203},{type:"Image",props:{x:309,width:66.5,visible:!1,var:"heroTemp1",scaleY:1,scaleX:1,height:88.5,centerY:139,centerX:0},compId:202},{type:"Image",props:{width:66.5,visible:!1,var:"heroTemp2",scaleY:1,scaleX:1,height:88.5,centerY:139,centerX:-80},compId:219},{type:"Image",props:{width:66.5,visible:!1,var:"heroTemp3",scaleY:1,scaleX:1,height:88.5,centerY:139,centerX:80},compId:220},{type:"Image",props:{width:66.5,visible:!1,var:"cardTemp2",scaleY:1,scaleX:1,height:88.5,centerY:24,centerX:0},compId:204},{type:"Image",props:{width:66.5,visible:!1,var:"cardTemp4",scaleY:1,scaleX:1,height:88.5,centerY:-81,centerX:0},compId:205},{type:"Image",props:{width:66.5,visible:!1,var:"cardTemp5",scaleY:1,scaleX:1,height:88.5,centerY:-186,centerX:0},compId:206},{type:"Image",props:{width:66.5,visible:!1,var:"cardTemp3",scaleY:1,scaleX:1,height:88.5,centerY:24,centerX:80},compId:209},{type:"Image",props:{width:66.5,visible:!1,var:"cardTemp1",scaleY:1,scaleX:1,height:88.5,centerY:24,centerX:-80},compId:210},{type:"Image",props:{width:66.5,visible:!1,var:"cardTemp6",scaleY:1,scaleX:1,height:88.5,centerY:-81,centerX:-80},compId:215},{type:"Image",props:{width:66.5,visible:!1,var:"cardTemp7",scaleY:1,scaleX:1,height:88.5,centerY:-81,centerX:80},compId:216},{type:"Image",props:{width:66.5,visible:!1,var:"cardTemp8",scaleY:1,scaleX:1,height:88.5,centerY:-186,centerX:-80},compId:217},{type:"Image",props:{width:66.5,visible:!1,var:"cardTemp9",scaleY:1,scaleX:1,height:88.5,centerY:-186,centerX:80},compId:218},{type:"Image",props:{width:66.5,visible:!1,var:"heroTemp4",scaleY:1,scaleX:1,height:88.5,centerY:29.5,centerX:0},compId:221},{type:"Image",props:{width:66.5,visible:!1,var:"cardTemp10",scaleY:1,scaleX:1,height:88.5,centerY:-84.5,centerX:0},compId:222},{type:"Image",props:{width:200,var:"detailTemp",right:10,height:320,centerY:99},compId:251},{type:"Image",props:{width:200,var:"treasureTemp",left:10,height:320,centerY:-70},compId:252}],loadList:["UI/Bg/BattleBg.jpg"],loadList3D:[]},t.ExploreSceneUI=i,yt("ui.Scenes.ExploreSceneUI",i);class r extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(r.uiView)}}r.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Script",props:{y:0,x:-200,width:200,height:768,density:100,runtime:"laya.physics.BoxCollider"},compId:22},{type:"Script",props:{type:"static",gravityScale:0,allowRotation:!1,runtime:"laya.physics.RigidBody"},compId:23},{type:"Script",props:{y:0,x:1024,width:200,height:768,density:100,runtime:"laya.physics.BoxCollider"},compId:24},{type:"Script",props:{y:-200,x:-200,width:1424,height:200,density:100,runtime:"laya.physics.BoxCollider"},compId:25},{type:"Script",props:{y:768,x:-200,width:1424,height:200,density:100,runtime:"laya.physics.BoxCollider"},compId:26},{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,bottom:0,bgColor:"#CAE2CA"},compId:27},{type:"Image",props:{y:691,width:43,visible:!0,var:"seat7",right:640,name:"seat7",height:54,bottom:25,anchorY:.5,anchorX:.5},compId:119},{type:"Image",props:{y:691,width:43,visible:!0,var:"seat6",right:570,name:"seat6",height:54,bottom:25,anchorY:.5,anchorX:.5},compId:118},{type:"Image",props:{y:691,width:43,visible:!0,var:"seat5",right:500,name:"seat5",height:54,bottom:25,anchorY:.5,anchorX:.5},compId:117},{type:"Image",props:{width:43,visible:!0,var:"seat4",right:430,name:"seat4",height:54,bottom:25,anchorY:.5,anchorX:.5},compId:40},{type:"Image",props:{width:43,visible:!0,var:"seat3",right:360,name:"seat3",height:54,bottom:25,anchorY:.5,anchorX:.5},compId:41},{type:"Image",props:{width:43,visible:!0,var:"seat2",right:290,name:"seat2",height:54,bottom:25,anchorY:.5,anchorX:.5},compId:42},{type:"Image",props:{width:43,visible:!0,var:"seat1",right:220,name:"seat1",height:54,bottom:25,anchorY:.5,anchorX:.5},compId:43},{type:"Image",props:{width:43,visible:!0,var:"sell",right:150,name:"sell",height:54,bottom:25,anchorY:.5,anchorX:.5},compId:44},{type:"Box",props:{width:900,top:40,height:51,centerX:13,anchorY:.5},compId:46,child:[{type:"Image",props:{y:0,x:29,skin:"UI/Line/Lines.png",scaleY:.2,scaleX:.2},compId:51},{type:"Image",props:{y:0,x:201,skin:"UI/Line/Lines.png",scaleY:.2,scaleX:.2},compId:52},{type:"Image",props:{y:0,x:376,skin:"UI/Line/Lines.png",scaleY:.2,scaleX:.2},compId:53},{type:"Image",props:{y:0,x:542,skin:"UI/Line/Lines.png",scaleY:.2,scaleX:.2},compId:54},{type:"Image",props:{y:0,x:709,skin:"UI/Line/Lines.png",scaleY:.2,scaleX:.2},compId:55}]},{type:"Box",props:{width:280,var:"timeBar",right:100,height:20,bottom:90},compId:66,child:[{type:"Image",props:{width:280,skin:"UI/PgB/synthesis_bar.png",sizeGrid:"2,2,2,2",height:20},compId:67,child:[{type:"Label",props:{width:556,var:"time_base",top:2,right:2,left:2,height:36,bottom:2,bgColor:"#d2e2d1"},compId:68},{type:"Label",props:{y:2,x:2,width:100,var:"time_bar",top:2,bottom:2,bgColor:"#e0bca9"},compId:69},{type:"Label",props:{y:0,var:"time_record",valign:"middle",top:0,text:"第1年1月 春",left:10,fontSize:12,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"left"},compId:70}]}]}],loadList:["UI/Line/Lines.png","UI/PgB/synthesis_bar.png"],loadList3D:[]},t.MapSceneUI=r,yt("ui.Scenes.MapSceneUI",r);class s extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(s.uiView)}}s.uiView={type:"Scene",props:{width:1024,mouseThrough:!0,mouseEnabled:!0,height:768},compId:2,loadList:[],loadList3D:[]},t.UISceneUI=s,yt("ui.Scenes.UISceneUI",s)}(t.Scenes||(t.Scenes={}))}(ot||(ot={})),function(t){!function(t){class e extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(e.uiView)}}e.uiView={type:"Scene",props:{width:1024,mouseThrough:!0,mouseEnabled:!0,height:768},compId:2,loadList:[],loadList3D:[]},t.EffectFrontViewUI=e,yt("ui.Views.EffectFrontViewUI",e);class a extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(a.uiView)}}a.uiView={type:"Scene",props:{width:1024,mouseThrough:!0,mouseEnabled:!0,height:768},compId:2,loadList:[],loadList3D:[]},t.EffectGameViewUI=a,yt("ui.Views.EffectGameViewUI",a);class i extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(i.uiView)}}i.uiView={type:"Scene",props:{width:1024,mouseThrough:!0,mouseEnabled:!0,height:768},compId:2,child:[{type:"Image",props:{width:50,var:"btn_setting",top:25,left:15,height:50,anchorY:.5,anchorX:.5},compId:69,child:[{type:"Image",props:{y:0,x:0,width:50,height:50},compId:112,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#000000"},compId:114},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#000000"},compId:115},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#000000"},compId:116},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#000000"},compId:117}]},{type:"Label",props:{y:0,x:0,wordWrap:!0,valign:"middle",text:"退出",fontSize:16,font:"SimHei",centerY:0,centerX:0,align:"center"},compId:113}]},{type:"Label",props:{width:100,var:"lb_silver",valign:"middle",text:"小星星\\n0",left:25,fontSize:16,font:"SimHei",color:"#000000",bottom:155,anchorY:.5,anchorX:.5,align:"center"},compId:71},{type:"Label",props:{width:100,var:"lb_batter",valign:"middle",text:"连击点\\n0",left:25,fontSize:16,font:"SimHei",color:"#000000",bottom:55,anchorY:.5,anchorX:.5,align:"center"},compId:80},{type:"Label",props:{width:100,var:"lb_fightback",valign:"middle",text:"反击点\\n0",left:25,fontSize:16,font:"SimHei",color:"#000000",bottom:105,anchorY:.5,anchorX:.5,align:"center"},compId:81},{type:"Label",props:{var:"lb_title",top:24,text:"地方",fontSize:24,color:"#000000",centerX:0,bold:!0,anchorY:.5,anchorX:.5},compId:98},{type:"Image",props:{width:64,var:"btn_mix",skin:"UI/Btn/Diamond2.png",rotation:5,height:64,centerX:160,bottom:55},compId:72,child:[{type:"Label",props:{y:0,x:0,valign:"middle",text:"图纸",rotation:-5,name:"name",fontSize:12,font:"SimHei",color:"#f6f5ec",centerY:0,centerX:0,align:"center"},compId:74}]},{type:"List",props:{width:277,var:"list_weapon",spaceX:10,repeatY:1,repeatX:4,height:64,centerX:-25,bottom:50,anchorY:.5},compId:73,child:[{type:"Box",props:{width:64,renderType:"render",height:64},compId:75,child:[{type:"Image",props:{width:64,skin:"UI/Btn/Circle2.png",name:"box",height:64},compId:76,child:[{type:"Label",props:{valign:"middle",text:"切割·启",name:"name",fontSize:10,font:"SimHei",color:"#f6f5ec",centerY:0,centerX:0,align:"center"},compId:77},{type:"Label",props:{valign:"middle",text:"金",name:"attr",fontSize:12,font:"SimHei",color:"#dbce5f",centerY:-17,centerX:0,align:"center"},compId:78},{type:"Label",props:{x:0,valign:"middle",text:"3",name:"dur",fontSize:12,font:"SimHei",color:"#333333",centerY:17,centerX:0,align:"center"},compId:79}]}]}]},{type:"Box",props:{x:150,width:250,var:"box_bar",top:60,centerX:0},compId:99,child:[{type:"Image",props:{y:0,x:0,var:"container_bar"},compId:110},{type:"Image",props:{width:250,var:"box_bar1",skin:"UI/PgB/synthesis_bar.png",sizeGrid:"2,2,2,2",height:6,alpha:.7},compId:100},{type:"Image",props:{y:2,x:2,width:100,var:"box_bar2",skin:"UI/PgB/dua_bar.png",sizeGrid:"2,2,2,2",height:2},compId:101}]}],loadList:["UI/Btn/Diamond2.png","UI/Btn/Circle2.png","UI/PgB/synthesis_bar.png","UI/PgB/dua_bar.png"],loadList3D:[]},t.ExploreViewUI=i,yt("ui.Views.ExploreViewUI",i);class r extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(r.uiView)}}r.uiView={type:"Scene",props:{width:1024,height:768},compId:2,child:[{type:"Label",props:{top:0,styleSkin:"UI/Bg/GridBg.png",right:0,left:0,bottom:0,bgColor:"#feeeed"},compId:45},{type:"Label",props:{width:200,var:"descBtn",valign:"middle",text:"说明",height:80,fontSize:32,centerY:270,centerX:0,borderColor:"#000000",align:"center"},compId:47},{type:"Label",props:{width:200,var:"startBtn",valign:"middle",text:"开始新游戏",height:80,fontSize:32,centerY:160,centerX:0,borderColor:"#000000",align:"center"},compId:42},{type:"Label",props:{width:200,var:"continueBtn",valign:"middle",text:"继续游戏",height:80,fontSize:32,centerY:50,centerX:0,borderColor:"#000000",align:"center"},compId:43},{type:"Label",props:{text:"虚拟狗狗的一生",fontSize:60,font:"Helvetica",color:"#000000",centerY:-150,centerX:0,bold:!0,anchorY:.5,anchorX:.5},compId:44}],loadList:["UI/Bg/GridBg.png"],loadList3D:[]},t.MainViewUI=r,yt("ui.Views.MainViewUI",r);class s extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.createView(s.uiView)}}s.uiView={type:"Scene",props:{width:1024,mouseThrough:!0,mouseEnabled:!0,height:768},compId:2,child:[{type:"Box",props:{y:0,x:0,width:1024,var:"box_top",top:0,height:70,centerX:0},compId:186,child:[{type:"Box",props:{width:120,height:60,centerY:5,centerX:11,anchorY:.5,anchorX:.5},compId:189,child:[{type:"Label",props:{valign:"middle",top:0,text:"食物",right:60,left:0,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:190},{type:"Label",props:{y:0,var:"res_food",valign:"middle",top:0,text:"0/0",right:0,left:60,height:60,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:191}]},{type:"Box",props:{width:120,height:60,centerY:5,centerX:131,anchorY:.5,anchorX:.5},compId:192,child:[{type:"Label",props:{valign:"middle",top:0,text:"人口",right:60,left:0,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:193},{type:"Label",props:{var:"res_population",valign:"middle",top:0,text:"0/20",right:0,left:60,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:194}]},{type:"Box",props:{width:120,height:60,centerY:5,centerX:251,anchorY:.5,anchorX:.5},compId:195,child:[{type:"Label",props:{valign:"middle",top:0,text:"金币",right:60,left:0,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:196},{type:"Label",props:{var:"res_coin",valign:"middle",top:0,text:"0",right:0,left:60,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:197}]},{type:"Box",props:{width:120,height:60,centerY:5,centerX:370,anchorY:.5,anchorX:.5},compId:198,child:[{type:"Label",props:{valign:"middle",top:0,text:"卡牌",right:60,left:0,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:199},{type:"Label",props:{var:"res_card",valign:"middle",top:0,text:"0/20",right:0,left:60,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:200}]},{type:"Box",props:{width:160,height:60,centerY:5,centerX:-329,anchorY:.5,anchorX:.5},compId:201,child:[{type:"Label",props:{valign:"middle",top:0,text:"粉丝",right:100,left:0,height:60,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:202},{type:"Label",props:{y:30,x:110,width:100,var:"res_fans",valign:"middle",top:0,text:"10000",right:0,left:60,height:60,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:203}]},{type:"Box",props:{width:200,pivotY:30,pivotX:100,height:60,centerY:5,centerX:-149},compId:204,child:[{type:"Label",props:{valign:"middle",top:0,text:"回赠礼物",right:90,left:0,height:60,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:205},{type:"Label",props:{var:"res_gift",valign:"middle",top:0,text:"10000",right:0,left:110,fontSize:16,font:"SimHei",color:"#333333",bottom:0,bold:!0,align:"center"},compId:206}]}]},{type:"Image",props:{y:0,x:0,width:100,var:"box_time",skin:"UI/Btn/Circle.png",right:20,height:100,bottom:20},compId:187,child:[{type:"Label",props:{wordWrap:!0,width:125,var:"btn_time",valign:"middle",text:"暂停",padding:"0,20,0,20",height:125,fontSize:20,font:"SimHei",color:"#333333",centerY:0,centerX:0,bold:!0,anchorY:.5,anchorX:.5,align:"center"},compId:207}]},{type:"Image",props:{y:0,x:0,width:50,var:"btn_setting",top:15,left:25,height:50,anchorY:.5,anchorX:.5},compId:188,child:[{type:"Image",props:{y:0,x:0,width:50,height:50},compId:208,child:[{type:"Label",props:{y:0,x:0,top:0,right:0,left:0,height:2,bgColor:"#000000"},compId:209},{type:"Label",props:{y:0,x:0,right:0,left:0,height:2,bottom:0,bgColor:"#000000"},compId:210},{type:"Label",props:{y:0,x:0,width:2,top:0,left:0,bottom:0,bgColor:"#000000"},compId:211},{type:"Label",props:{y:0,x:0,width:2,top:0,right:0,bottom:0,bgColor:"#000000"},compId:212}]},{type:"Label",props:{valign:"middle",text:"设置",fontSize:16,font:"SimHei",centerY:0,centerX:0,align:"center"},compId:213}]}],loadList:["UI/Btn/Circle.png"],loadList3D:[]},t.MapViewUI=s,yt("ui.Views.MapViewUI",s)}(t.Views||(t.Views={}))}(ot||(ot={}));class ut extends ot.Scenes.MapSceneUI{constructor(){super(),this.layerIndex={LayerTree:0},this.width=Laya.stage.width,this.height=Laya.stage.height,this.initGame()}static get instance(){return ut._instance||(ut._instance=new ut),ut._instance}initGame(){}onShow(t){t?(this.visible=!0,this.addEvent(),this.initRepeat()):(this.visible=!1,this.removeEvent())}addEvent(){a.log("MapScene: true"),this.on(Laya.Event.MOUSE_DOWN,this,this.OnMouseDown),this.on(Laya.Event.MOUSE_MOVE,this,this.OnMouseMove),this.on(Laya.Event.MOUSE_UP,this,this.OnMouseUp)}removeEvent(){this.off(Laya.Event.MOUSE_DOWN,this,this.OnMouseDown),this.off(Laya.Event.MOUSE_MOVE,this,this.OnMouseMove),this.off(Laya.Event.MOUSE_UP,this,this.OnMouseUp)}initRepeat(){}OnMouseDown(t){}OnMouseMove(t){}OnMouseUp(t){a.log("OnMouseUp"),Be.instance.onShow(!1,null),Ae.instance.OnFreed()}}class gt{constructor(t,e){this.key=e?e.key:z.generateUUID(),this.init(t,e)}init(t,e){e?(this.data=e.data,this.dataID=e.curStat.id,this.homeID=e.curStat.homeID,this.name=e.curStat.name,this.desc=e.curStat.desc,this.type=e.curStat.type,this.icon=e.curStat.icon,this.largeIcon=e.curStat.largeIcon,this.level=e.curStat.level,this.link=e.curStat.link,this.addCompleteHp=e.curStat.addCompleteHp,this.shieleAmout=e.curStat.shieleAmout,this.atk=e.curStat.atk,this.addDodge=e.curStat.addDodge,this.addHit=e.curStat.addHit,this.addCrit=e.curStat.addCrit,this.addCritDamage=e.curStat.addCritDamage,this.addAtk=e.curStat.addAtk,this.durability=e.curStat.durability,this.battleSkill=e.curStat.battleSkill,this.special=e.curStat.special,this.rare=e.curStat.rare,this.effectDebutInfo=e.curStat.effectDebutInfo,this.effectPassiveInfo=e.curStat.effectPassiveInfo,this.effectInitiativeInfo=e.curStat.effectInitiativeInfo,this.attributes=e.curStat.attributes,this.fightback=e.curStat.fightback,this.coinPrice=e.curStat.coinPrice):(this.data=t,this.dataID=t.ID,this.homeID=t.HomeID,this.name=t.Name,this.desc=t.Desc,this.type=t.Type,this.icon=t.Icon,this.largeIcon=t.LargeIcon,this.level=t.Level,this.link=t.Link,this.addCompleteHp=t.AddCompleteHp,this.shieleAmout=t.ShieleAmout,this.atk=t.Atk,this.addDodge=t.AddDodge,this.addHit=t.AddHit,this.addCrit=t.AddCrit,this.addCritDamage=t.AddCritDamage,this.addAtk=t.AddAtk,this.durability=t.Durability||0,this.battleSkill=t.BattleSkill,this.special=t.Special,this.rare=t.Rare,this.effectDebutInfo=t.EffectDebutInfo||"",this.effectPassiveInfo=t.EffectPassiveInfo||"",this.effectInitiativeInfo=t.EffectInitiativeInfo||"",this.attributes=t.Attributes,this.fightback=t.Fightback,this.coinPrice=t.Price),this.initArgs(),this.setAttr()}initArgs(){this.InMix=!1}setAttr(){if(-1==this.attributes){let t=[S.Jin,S.Mu,S.Shui,S.Huo,S.Tu,S.Yin,S.Yang,S.Wu],e=[13,13,13,13,13,11,11,13],a=z.randomOneByTradition(e);this.attributes=t[a]}}}class bt{constructor(){this.skillItvType=-1,this.cost=0,this.values=[],this.damages=[],this.heals=[],this.armors=[],this.states=[],this.stateValues=[],this.skillType=[],this.launchRate=0,this.launchBase=0,this.skillDuration=0,this.skillRadius=0,this.addAblity={hpPt:0,comhpPt:0,atkPt:0,hitPt:0,critPt:0,critDamagePt:0},this.skillHit=0,this.skillCrit=0,this.skillCritDamage=0,this.skillBatterArr=[10015,10016,10018]}static get instance(){return bt._instance||(bt._instance=new bt),bt._instance}CreateSkill(t,e){var a=new bt;return a.id=t,a.characterId=e,a}CheckBatterByArr(t){return this.skillBatterArr.intersect(t).length>0}}!function(t){t[t.Damage=1]="Damage",t[t.AddState=2]="AddState",t[t.Heal=3]="Heal",t[t.RemoveState=4]="RemoveState",t[t.Armor=5]="Armor",t[t.ExposedWeak=6]="ExposedWeak",t[t.Rand1=7]="Rand1",t[t.Boom=8]="Boom"}(nt||(nt={})),function(t){t[t.Normal=0]="Normal",t[t.Passive=1]="Passive",t[t.Initiative=2]="Initiative",t[t.Talent=3]="Talent",t[t.DefAttack=4]="DefAttack",t[t.Charge=5]="Charge"}(ht||(ht={})),function(t){t[t.That=1]="That",t[t.Self=2]="Self",t[t.Enemy=3]="Enemy",t[t.Our=4]="Our",t[t.VisionEnemy=5]="VisionEnemy",t[t.AboveEnmey=6]="AboveEnmey"}(lt||(lt={})),function(t){t[t.None=0]="None",t[t.Hp=1]="Hp",t[t.Atk=2]="Atk",t[t.Hit=3]="Hit",t[t.Dodge=4]="Dodge",t[t.Crit=5]="Crit"}(ct||(ct={})),function(t){t[t.None=0]="None",t[t.Hp=1]="Hp",t[t.Attack=2]="Attack",t[t.Hit=3]="Hit",t[t.Dodge=4]="Dodge",t[t.PhyDefence=5]="PhyDefence",t[t.MagicDefence=6]="MagicDefence",t[t.Crit=7]="Crit",t[t.CritDamage=8]="CritDamage",t[t.MoveSpeed=9]="MoveSpeed",t[t.AtkSpeed=10]="AtkSpeed",t[t.ComHp=11]="ComHp",t[t.Hurt=12]="Hurt",t[t.Shield=13]="Shield"}(dt||(dt={})),function(t){t[t.None=0]="None",t[t.Hp=1]="Hp",t[t.Attack=2]="Attack",t[t.Hit=3]="Hit",t[t.Dodge=4]="Dodge",t[t.PhyDefence=5]="PhyDefence",t[t.MagicDefence=6]="MagicDefence",t[t.Crit=7]="Crit",t[t.CritDamage=8]="CritDamage",t[t.MoveSpeed=9]="MoveSpeed",t[t.AtkSpeed=10]="AtkSpeed",t[t.ComHp=11]="ComHp",t[t.Hurt=12]="Hurt",t[t.Shield=13]="Shield"}(pt||(pt={})),function(t){t[t.AtkBuff=0]="AtkBuff",t[t.DefBuff=1]="DefBuff",t[t.Debuff=2]="Debuff",t[t.RestoreBuff=3]="RestoreBuff"}(ft||(ft={})),function(t){t[t.Poison=1]="Poison",t[t.Blood=2]="Blood",t[t.EverDefense=3]="EverDefense",t[t.AddPT1=4]="AddPT1",t[t.AddPT2=5]="AddPT2",t[t.AddPT3=6]="AddPT3",t[t.AddHp=7]="AddHp",t[t.AddAttack=8]="AddAttack",t[t.AddHit=9]="AddHit",t[t.AddDodge=10]="AddDodge",t[t.AddCrit=11]="AddCrit",t[t.AddCritDamage=12]="AddCritDamage",t[t.Restore=13]="Restore",t[t.AddShield=14]="AddShield"}(mt||(mt={}));class St{constructor(t,e){this.dataId=t,this.launch=e,this.data=E.instance.select(L.BattleState).asDict[this.dataId],this.TypeofEffect()}get Name(){return this.data.Name}get Info(){return this.data.Info}TypeofEffect(){this.polarity=this.data.Polarity,this.maxTime=this.data.Continued,this.time=this.data.Continued,this.type=this.data.Type,this.value=this.data.Value,this.maxFloor=this.data.MaxFloor,this.valueBase=this.data.ValueBase}}class xt{init(t){this.people=t,this.initUp()}initUp(){}selectSkill(t){return this.people.battleSkillGroup.select(e=>e.skillItvType==t)}findSkills(){return this.people.battleSkillGroup}beHit(t){let e=[];if(a.log("受到攻击或加血或上buff",t.skillType,t.damages),t.skillType.contains(nt.Damage)||t.skillType.contains(nt.Boom)){this.people.IsDizzy&&(t.damages=t.damages.concat(t.damages));for(let a=0;a<t.damages.length;a++){let i=t.damages[a],r=i+i*t.skillCritDamage/100;this.people.type!=g[g.Hero]&&(this.people.IsDizzy||this.people.IsBreak?(i=Math.floor(1.5*i),r=Math.floor(1.5*r)):this.people.weak.contains(t.skillAttr)&&(i=Math.floor(1.5*i),r=Math.floor(1.5*r)));let s=0;s=z.randFloat(1,100)<=t.skillCrit?r:i,s=Math.floor(s),e.push(this.costAttack(t.skillHit,s,t.skillAttr))}}if(t.skillType.contains(nt.Heal))for(let a=0;a<t.heals.length;a++){let i=this.people.FinalCompleteHp,r=Math.floor(i*t.heals[a]/100);e.push(this.restoreBlood(r))}if(t.skillType.contains(nt.Armor))for(let a=0;a<t.armors.length;a++)this.people.type==g[g.Hero]?e.push(this.dealArmor(t.armors[a]>=0,Math.abs(t.armors[a]))):e.push(this.dealStance(t.armors[a]>=0,Math.abs(t.armors[a])));if(t.skillType.contains(nt.AddState))for(let e=0;e<t.states.length;e++){let a=t.states[e];if(E.instance.select(L.BattleState).asDict[a].Polarity==ft.Debuff){let e=new St(a,t.launchRate);this.people.stateGruop.push(e)}}if(t.skillType.indexOf(nt.RemoveState)>=0)for(let t=0;t<this.people.stateGruop.length;t++){this.people.stateGruop[t].polarity==ft.Debuff&&this.people.stateGruop.splice(t--,1)}if(t.skillType.indexOf(nt.ExposedWeak)>=0){let t=[];for(let e=0;e<this.people.exposedWeak.length;e++){0==this.people.exposedWeak[e]&&t.push(e)}t.length>0&&(this.people.exposedWeak[t[z.randInt(0,t.length-1)]]=1)}return a.log("values:",e),e}dealArmor(t,e){var a;return a=Math.floor(e),t?this.addShield(a):this.costShield(a),Math.abs(a)+""}dealStance(t,e){var a;return a=Math.floor(e),t?this.addStance(a):this.costStance(a),Math.abs(a)+""}costAttack(t,e,i){var r=!1,s=0,o=0;s=1*e;let n=t-this.people.FinalDodge;if(a.log("伤害~~~",s,n,t,this.people.FinalDodge),n<=0)return s=0,this.miss(),"MISS";if(z.getRandom(1,100)>n)return s=0,this.miss(),"MISS";if(this.people.type==g[g.Hero])o=s-this.people.shieleAmout,this.dealArmor(!1,s),(o=Math.floor(o))<=0&&(o=0),a.log("最终伤害",o,s),(o-=this.people.FinalReduceHurt)<=0&&(o=0);else{let t=this.people.weak.indexOf(i);t>=0&&(0==this.people.exposedWeak[t]&&(r=!0),this.dealStance(!1,1)),o=s,(o-=this.people.FinalReduceHurt)<=0&&(o=0)}return this.costHp(o),0==o?"NODAMAGE":(Math.abs(o)>=2992?2992:Math.abs(o))+(r?"Weak":"")}restoreBlood(t){var e;return e=Math.floor(t),this.addHp(e),Math.abs(e)+""}costHp(t){a.log("造成"+t+"伤害");var e=t;return this.people.currentHp-t<=0&&(e=this.people.currentHp),this.people.currentHp-=e,this.people.currentHp<=0&&(this.people.currentHp=0),e}addHp(t){a.log("回复"+t+"血量");var e=t;return this.people.currentHp+t>=this.people.FinalCompleteHp&&(e=this.people.FinalCompleteHp-this.people.currentHp),this.people.currentHp+=e,this.people.currentHp>=this.people.FinalCompleteHp&&(this.people.currentHp=this.people.FinalCompleteHp),e}addShield(t){return a.log("增加"+t+"护盾"),this.people.shieleAmout+=t,t}costShield(t){var e=t;return this.people.shieleAmout-t<=0&&(e=this.people.shieleAmout),this.people.shieleAmout-=e,this.people.shieleAmout<=0&&(this.people.shieleAmout=0),a.log("给予护盾"+t+"伤害",this.people.shieleAmout),e}addStance(t){return a.log("增加"+t+"架势条"),this.people.shieleAmout+=t,t}costStance(t){var e=t;return this.people.shieleAmout-t<=0&&(e=this.people.shieleAmout),this.people.shieleAmout-=e,this.people.shieleAmout<=0&&(this.people.shieleAmout=0),a.log("扣除"+t+"架势条",this.people.shieleAmout),e}miss(){a.log("miss,没命中")}nodamage(){a.log("NoDamage,没伤害")}selectValueBase(t){let e=0;switch(t){case dt.ComHp:e=this.people.FinalCompleteHp;break;case dt.Hp:e=this.people.currentHp;break;case dt.Attack:e=this.people.FinalAtk;break;case dt.Hit:e=this.people.FinalHit;break;case dt.Crit:e=this.people.FinalCrit;break;case dt.CritDamage:e=this.people.FinalCritDamage}return e}selectValueBaseAndPt(t,e){let a=0;switch(t){case dt.ComHp:a=Math.floor(this.people.FinalCompleteHp*e.comhpPt/100);break;case dt.Hp:a=Math.floor(this.people.currentHp*e.hpPt/100);break;case dt.Attack:a=Math.floor(this.people.FinalAtk*e.atkPt/100)}return a}filling(t,e=-1){let i=[],r=[],s=[],o=0,n=0,h=0,l=this.selectValueBase(dt.Hit),c=this.selectValueBase(dt.Crit),d=this.selectValueBase(dt.CritDamage);for(let a=0;a<t.skillType.length;a++){let l=t.skillType[a];if(this.people.type==g[g.Hero]&&(-1==e?Wt.instance.batter>0&&(Wt.instance.batter>A.useBatterPoint?(h=A.useBatterPoint,Wt.instance.batter-=h):(h=Wt.instance.batter,Wt.instance.batter=0),Wt.instance.addBatterPoint(!1,Wt.instance.batter)):(h=e,Wt.instance.batter-=h,Wt.instance.addBatterPoint(!1,Wt.instance.batter))),t.skillItvType==ht.Initiative?(o=z.randInt(t.values[0],t.values[1]),n=A.addHurtBatterPoint*h):(o=z.randInt(t.values[0],t.values[1]+h),n=0),l==nt.Damage||l==nt.Boom)for(let e=0;e<o;e++){let e=0;e+=this.selectValueBaseAndPt(dt.ComHp,t.addAblity)+this.selectValueBaseAndPt(dt.Hp,t.addAblity)+this.selectValueBaseAndPt(dt.Attack,t.addAblity),e+=Math.floor(e*n/100),i.push(Math.floor(e))}if(l==nt.Armor)for(let e=0;e<o;e++){let e=0;e+=this.selectValueBaseAndPt(dt.ComHp,t.addAblity)+this.selectValueBaseAndPt(dt.Hp,t.addAblity)+this.selectValueBaseAndPt(dt.Attack,t.addAblity),t.skillItvType==ht.DefAttack&&(e=-e),s.push(Math.floor(e))}if(l==nt.Heal)for(let e=0;e<o;e++){let e=0;e+=this.selectValueBaseAndPt(dt.ComHp,t.addAblity)+this.selectValueBaseAndPt(dt.Hp,t.addAblity)+this.selectValueBaseAndPt(dt.Attack,t.addAblity),e+=Math.floor(e*n/100),r.push(Math.floor(e))}}t.skillHit=l+t.addAblity.hitPt,t.skillCrit=c+t.addAblity.critPt,t.skillCritDamage=d+t.addAblity.critDamagePt,t.damages=i,t.heals=r,t.armors=s,t.skillAttr=this.people.getAtkWeapon().attributes,a.log("filling:",this.people.type,t.skillHit,t.skillCrit,t.skillCritDamage,t.damages,t.armors,t.heals,o,h,n,t.values[0],t.values[1]+h)}}class wt{get AtkUp(){return this.atkUp}get CompleteHpUp(){return this.completeHpUp}get HitUp(){return this.hitUp}get DodgeUp(){return this.dodgeUp}get CritUp(){return this.critUp}get CritDamageUp(){return this.critDamageUp}get ShieldUp(){return this.shieldUp}get HurtUp(){return this.hurtUp}get AtkDown(){return this.atkDown}get CompleteHpDown(){return this.completeHpDown}get HitDown(){return this.hitDown}get DodgeDown(){return this.dodgeDown}get CritDown(){return this.critDown}get CritDamageDown(){return this.critDamageDown}get ShieldDown(){return this.shieldDown}get HurtDown(){return this.hurtDown}constructor(t,e){this.init(t,e)}init(t,e){e?(this.data=e.data,this.dataID=e.curStat.id,this.homeID=e.curStat.homeID,this.weaponID=e.curStat.weaponID,this.name=e.curStat.name,this.desc=e.curStat.desc,this.type=e.curStat.type,this.icon=e.curStat.icon,this.largeIcon=e.curStat.largeIcon,this.level=e.curStat.level,this.completeHp=e.curStat.completeHp,this.currentHp=e.curStat.currentHp,this.shieleAmout=e.curStat.shieleAmout,this.atk=e.curStat.atk,this.dodge=e.curStat.dodge,this.hit=e.curStat.hit,this.crit=e.curStat.crit,this.critDamage=e.curStat.critDamage,this.atkWeaponWithBattle=[],this.stateGruop=[],this.battleSkillGroup=[]):(this.data=t,this.dataID=t.ID,this.homeID=t.HomeID,this.weaponID=t.WeaponID,this.name=t.Name,this.desc=t.Desc,this.type=t.Type,this.icon=t.Icon,this.level=t.Level,this.completeHp=t.CompleteHp,this.currentHp=t.CurrentHp,this.shieleAmout=t.ShieleAmout,this.atk=t.Atk,this.dodge=t.Dodge,this.hit=t.Hit,this.crit=t.Crit,this.critDamage=t.CritDamage,this.atkWeaponWithBattle=[],this.stateGruop=[],this.battleSkillGroup=[]),this.desc=this.desc.split("(")[0],this.initStateArgs(),this.battleSkillComponents=new xt,this.battleSkillComponents.init(this)}initStateArgs(){this.IsBreak=!1,this.IsDizzy=!1,this.turnDizzy=0,this.atkUp=0,this.completeHpUp=0,this.hitUp=0,this.dodgeUp=0,this.critUp=0,this.critDamageUp=0,this.shieldUp=0,this.hurtUp=0,this.atkDown=0,this.completeHpDown=0,this.hitDown=0,this.dodgeDown=0,this.critDown=0,this.critDamageDown=0,this.shieldDown=0,this.hurtDown=0}initBattleSkill(t){this.battleSkillGroup=[];for(let e=0;e<t.length;e++){if(t[e]<=0)continue;let i,r,s=t[e];switch(i=E.instance.select(L.BattleSkill).asDict[s],a.log("initBattleSkill:",s,i),(r=bt.instance.CreateSkill(s,this.weaponID)).values=[],i.Value.forEach((t,e)=>{0!=e?r.values.push(t):r.cost=t}),r.skillItvType=i.ItvType,r.launchBase=i.Launch[0],r.launchBase){case ct.None:r.launchRate=100;break;case ct.Atk:r.launchRate=Math.floor(this.FinalAtk*(i.Launch[1]/100));break;case ct.Hp:r.launchRate=Math.floor(this.FinalCompleteHp*(i.Launch[1]/100));break;case ct.Hit:r.launchRate=Math.floor(this.FinalHit*(i.Launch[1]/100));break;case ct.Dodge:r.launchRate=Math.floor(this.FinalDodge*(i.Launch[1]/100));break;case ct.Crit:r.launchRate=Math.floor(this.FinalCrit*(i.Launch[1]/100))}r.addAblity.hpPt=i.AddHpPt,r.addAblity.comhpPt=i.AddComHpPt,r.addAblity.atkPt=i.AddAtkPt,r.addAblity.hitPt=i.AddHitPt,r.addAblity.critPt=i.AddCritPt,r.addAblity.critDamagePt=i.AddCritDamagePt,r.skillTarget=i.Target,r.states=[],i.State.forEach((t,e)=>{0!=t&&r.states.push(t)}),r.stateValues=[],i.StateValue.forEach((t,e)=>{0!=t&&r.stateValues.push(t)}),r.skillType=[],i.Type.forEach((t,e)=>{0!=t&&r.skillType.push(t)}),this.battleSkillGroup.push(r)}a.log("BattleSkillData:",this.name,this.battleSkillGroup)}checkAtkWeapon(){}getAtkWeapon(){return null}get FinalCompleteHp(){return 0}get FinalAtk(){return 0}get FinalShield(){return 0}get FinalHit(){return 0}get FinalDodge(){return 0}get FinalCrit(){return 0}get FinalCritDamage(){return 0}get FinalReduceHurt(){return 0}setShield(t){}}class vt extends wt{init(t,e){super.init(t,e),this.IsFightback=!0,this.weaponSelect=0;let a=[];if((a=e?e.curStat.weak:t.Weak).length>=3&&-1!=a[1]&&-1!=a[2])this.weak=[a[1],a[2]];else{let t=[S.Jin,S.Mu,S.Shui,S.Huo,S.Tu,S.Yin,S.Yang,S.Wu],e=[10,10,10,10,10,12,12,10],a=z.randomSomeByOriginalSort(e,2);a.sort((t,e)=>t.originIdx-e.originIdx),this.weak=[t[a[0].originIdx],t[a[1].originIdx]]}let i=z.randomOneByTradition([50,50]);this.exposedWeak=[0,0],this.exposedWeak[i]=1,this.initWeapon()}initWeapon(){let t=new gt(E.instance.select(L.BattleWeapon).asDict[this.weaponID],null);this.atkWeaponWithBattle[this.weaponSelect]=t,this.initBattleSkill(this.atkWeaponWithBattle[this.weaponSelect].battleSkill)}restoreShield(){this.battleSkillComponents.dealStance(!0,this.data.ShieleAmout)}weakExposed(t){if(this.weak.contains(t)){let e=this.weak.indexOf(t);if(0==this.exposedWeak[e])return this.exposedWeak[e]=1,!0}return!1}checkAtkWeapon(){return super.checkAtkWeapon(),!!this.atkWeaponWithBattle}getAtkWeapon(){return super.getAtkWeapon(),this.atkWeaponWithBattle[this.weaponSelect]}get FinalCompleteHp(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().addCompleteHp),this.completeHp+t+this.CompleteHpUp+this.CompleteHpDown}get FinalAtk(){let t=0,e=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().atk,e=this.getAtkWeapon().addAtk),this.atk+e+t+this.AtkUp+this.AtkDown}get FinalShield(){return this.shieleAmout}get FinalHit(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().addHit),this.hit+t+this.HitUp+this.HitDown}get FinalDodge(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().addDodge),this.dodge+t+this.DodgeUp+this.DodgeDown}get FinalCrit(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().addCrit),this.crit+t+this.CritUp+this.CritDown}get FinalCritDamage(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().addCritDamage),this.critDamage+t+this.CritDamageUp+this.CritDamageDown}get FinalReduceHurt(){return this.HurtDown}}class It extends wt{init(t,e){super.init(t,e),this.IsFightback=!1,this.atkWeaponKey=e.curStat.atkWeaponKey,this.weaponSelect=0,this.initTreasureArgs(),this.initWeapon()}initTreasureArgs(){this.treasuresWithBattle=[],this.treasureAtkUp=0,this.treasureCompleteHpUp=0,this.treasureHitUp=0,this.treasureDodgeUp=0,this.treasureCritUp=0,this.treasureCritDamageUp=0,this.treasureShieldUp=0,this.treasureHurtUp=0,this.treasureAtkDown=0,this.treasureCompleteHpDown=0,this.treasureHitDown=0,this.treasureDodgeDown=0,this.treasureCritDown=0,this.treasureCritDamageDown=0,this.treasureShieldDown=0,this.treasureHurtDown=0}initWeapon(){let t=null,e=E.instance.select(L.BattleWeapon).asDict[this.weaponID],i=new gt(e,null);this.atkWeaponWithBattle.push(i),null!=this.atkWeaponKey&&(t=new gt(null,j.instance.weaponItems[this.atkWeaponKey]),this.atkWeaponWithBattle.push(t)),this.weaponSelect=this.atkWeaponWithBattle.length-1,a.log("atkInitWeapon1:",this.weaponSelect,this.atkWeaponWithBattle,this.atkWeaponKey,j.instance.weaponItems[this.atkWeaponKey]),this.initBattleSkill(this.atkWeaponWithBattle[this.weaponSelect].battleSkill)}setNewWeapon(t){let e=E.instance.select(L.BattleWeapon).asDict[t],a=null;if(e.ShieleAmout>0){let t=new gt(e,null);a=t.key,this.battleSkillComponents.dealArmor(!0,t.shieleAmout)}else{let t=new gt(e,null);a=t.key,this.atkWeaponWithBattle.push(t)}return a}setExistingWeapon(t,e){let i=!1;if(a.log("setExistingWeapon:",this.atkWeaponWithBattle.length,t,this.weaponSelect,1==this.atkWeaponWithBattle[this.weaponSelect].special),1==this.atkWeaponWithBattle[this.weaponSelect].special){i=!0;let t=this.atkWeaponWithBattle.splice(this.weaponSelect--,1)[0];if(!e&&Wt.instance.saveSpWeaponDataSO[t.key]&&Wt.instance.saveSpWeaponDataSO[t.key].keyArr.length>0){this.atkWeaponWithBattle.filter(e=>Wt.instance.saveSpWeaponDataSO[t.key].keyArr.contains(e.key)).forEach(t=>{t.InMix=!1}),delete Wt.instance.saveSpWeaponDataSO[t.key]}}return this.weaponSelect=this.atkWeaponWithBattle.findIndex(e=>e.key==t),this.initBattleSkill(this.atkWeaponWithBattle[this.weaponSelect].battleSkill),i}costDurability(t,e){if(this.weaponSelect<=0)return!1;if(e)this.atkWeaponWithBattle[this.weaponSelect].durability=0;else{if(t<=0)return!1;this.atkWeaponWithBattle[this.weaponSelect].durability-=t}if(a.log("costDurability:",t),this.atkWeaponWithBattle[this.weaponSelect].durability<=0){for(;this.atkWeaponWithBattle[this.weaponSelect].durability<=0&&this.weaponSelect>0;){let t=this.atkWeaponWithBattle.splice(this.weaponSelect,1)[0];if(1==t.special&&Wt.instance.saveSpWeaponDataSO[t.key]&&Wt.instance.saveSpWeaponDataSO[t.key].keyArr.length>0){this.atkWeaponWithBattle.filter(e=>Wt.instance.saveSpWeaponDataSO[t.key].keyArr.contains(e.key)).forEach(t=>{t.InMix=!1}),delete Wt.instance.saveSpWeaponDataSO[t.key]}this.weaponSelect=0}return this.setExistingWeapon(this.atkWeaponWithBattle[this.weaponSelect].key,!1),!0}return!1}setTreasures(t){this.treasuresWithBattle.push(t),this.initTreasure(t)}initTreasure(t){let e=E.instance.select(L.BattleTreasure).asDict[t];switch(e.BuffBase){case dt.ComHp:this.treasureCompleteHpUp+=e.BuffValue;break;case dt.Attack:this.treasureAtkUp+=e.BuffValue;break;case dt.Hit:this.treasureHitUp+=e.BuffValue;break;case dt.Dodge:this.treasureDodgeUp+=e.BuffValue;break;case dt.Crit:this.treasureCritUp+=e.BuffValue;break;case dt.CritDamage:this.treasureCritDamageUp+=e.BuffValue}switch(e.DeBuffBase){case pt.ComHp:this.treasureCompleteHpDown+=e.DeBuffValue;break;case pt.Attack:this.treasureAtkDown+=e.DeBuffValue;break;case pt.Hit:this.treasureHitDown+=e.DeBuffValue;break;case pt.Dodge:this.treasureDodgeDown+=e.DeBuffValue;break;case pt.Crit:this.treasureCritDown+=e.DeBuffValue;break;case pt.CritDamage:this.treasureCritDamageDown+=e.DeBuffValue;break;case pt.Hurt:this.treasureHurtDown+=e.DeBuffValue}}setFightback(t){this.IsFightback=t}checkAtkWeapon(){return super.checkAtkWeapon(),this.atkWeaponWithBattle.length>0}getAtkWeapon(){return super.getAtkWeapon(),this.atkWeaponWithBattle[this.weaponSelect]}get FinalCompleteHp(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().addCompleteHp),this.completeHp+t+this.CompleteHpUp+this.CompleteHpDown+this.treasureCompleteHpUp+this.treasureCompleteHpDown}get FinalAtk(){let t=0,e=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().atk,e=this.getAtkWeapon().addAtk),this.atk+e+t+this.AtkUp+this.AtkDown+this.treasureAtkUp+this.treasureAtkDown}get FinalShield(){return this.shieleAmout}get FinalHit(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().addHit),this.hit+t+this.HitUp+this.HitDown+this.treasureHitUp+this.treasureHitDown}get FinalDodge(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().addDodge),this.dodge+t+this.DodgeUp+this.DodgeDown+this.treasureDodgeUp+this.treasureDodgeDown}get FinalCrit(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().addCrit),this.crit+t+this.CritUp+this.CritDown+this.treasureCritUp+this.treasureCritDown}get FinalCritDamage(){let t=0;return this.checkAtkWeapon()&&(t=this.getAtkWeapon().addCritDamage),this.critDamage+t+this.CritDamageUp+this.CritDamageDown+this.treasureCritDamageUp+this.treasureCritDamageDown}get FinalReduceHurt(){return this.HurtDown+this.treasureHurtDown}}class Lt{constructor(){}init(t,e,i){this.data=t,this.cardID=t.ID,this.cardDesc=t.Desc||"",this.cardIcon=t.Icon||"",this.cardName=t.Name,this.cardType=t.Type,this.cardValue=e,this.cardPrice=-1,this.cardFloor=0,this.cardRow=0,this.cardOrder=i,this.cardLock=!1,this.initArgs(),this.cardType==g[g.Weapon]&&this.cardOrder==b.AtkWeapon?(this.vrWeapon=new gt(this.data,null),this.setPrice(this.vrWeapon.coinPrice)):this.cardType==g[g.Weapon]&&this.cardOrder==b.DefWeapon?(this.vrWeapon=new gt(this.data,null),this.setPrice(this.vrWeapon.coinPrice)):this.cardType==g[g.Animal]?Wt.instance.currentBattleType==d[d.Animal]?this.vrEnemy=new vt(null,j.instance.animalItems[Wt.instance.currentBattleKey.otherKey]):this.vrEnemy=new vt(this.data,null):this.cardType==g[g.Enemy]?Wt.instance.currentBattleType==d[d.Enemy]?this.vrEnemy=new vt(null,j.instance.enemyItems[Wt.instance.currentBattleKey.otherKey]):this.vrEnemy=new vt(this.data,null):this.cardType==g[g.Hero]?(this.vrHero=new It(null,j.instance.heroItems[Wt.instance.currentBattleKey.heroKey]),this.cardName=this.vrHero.name):this.cardType==g[g.Next]?this.cardName=Wt.instance.currentBattleData.DetailName[Wt.instance.maxBranchArr[this.cardValue]]:this.cardType==g[g.Treasure]&&this.setPrice(this.data.Price),a.log("this.cardType:",this.cardType)}initArgs(){this.vrWeapon=null,this.vrEnemy=null}setFloor(t){this.cardFloor=t}setRow(t){this.cardRow=t}setLock(t){this.cardLock=t}setPrice(t){this.cardPrice=t}}class Ct extends Laya.Script{static createAni(t,e,a,i,r){let s=Laya.Pool.getItemByClass(t,Laya.Animation);return s.interval=r,s.zOrder=0,this.anis.push(s),s.loadAtlas(e,Laya.Handler.create(this,()=>{let t=a;Laya.Animation.createFrames(this.aniUrls(t,i),"ani_"+this.anis.length)})),s}static aniUrls(t,e){for(var a=[],i=0;i<=e;i++)a.push(t+i+".png");return a}static playerCreateAni(t,e,a,i,r,s){let o=Laya.Pool.getItemByClass(e,Laya.Animation);return o.interval=s,o.zOrder=0,o.loadAtlas(a,Laya.Handler.create(this,()=>{let e=i;for(var a=0;a<4;a++)for(var s=0;s<9;s+=2)if(!(3==a&&s>0)){var o=t+"_"+a+"_"+s;Laya.Animation.createFrames(this.playerAniUrls(e,t,a,s,r),o)}})),o}static playerAniUrls(t,e,a,i,r){for(var s=[],o=0;o<=r;o++)s.push(t+e+"_"+a+"_"+i+"_"+o+".png");return s}static transitionAnim(t,e){return a.log("transitionAnim:",e),new Promise(e=>{this.isTransition=!0,this.layer||(this.layer=new Laya.Sprite,Laya.stage.addChild(this.layer)),this.layer.visible=!0,this.layer.cacheAs="bitmap",this.layer.zOrder=15,this.blackBg||(this.blackBg=new Laya.Sprite,this.layer.addChild(this.blackBg)),this.blackBg.visible=!0,this.blackBg.size(2*Laya.stage.width,2*Laya.stage.height),this.blackBg.graphics.drawRect(0,0,Laya.stage.width,Laya.stage.height,"#000000");this.mask||(this.mask=new Laya.Sprite,this.layer.addChild(this.mask)),this.mask.visible=!0,this.mask.size(200,200),this.mask.pivot(100,100),this.mask.pos(Laya.stage.width/2,Laya.stage.height/2),this.mask.graphics.drawCircle(100,100,10,"#ff0000"),this.mask.blendMode="destination-out",this.mask.scale(100,100),Laya.Tween.to(this.mask,{scaleX:0,scaleY:0},t,null,Laya.Handler.create(this,()=>{e()})),Laya.Tween.to(this.mask,{scaleX:100,scaleY:100},t,null,Laya.Handler.create(this,()=>{Ct.layer.visible=!1,Ct.blackBg.visible=!1,Ct.mask.visible=!1,this.isTransition=!1}),t+300)})}}Ct.anis=[],Ct.isTransition=!1;class kt extends Laya.Script{get ID(){return this.data.cardID}get Type(){return this.data.cardType}get entity(){return this.owner}get x(){return this.entity.x}set x(t){this.entity.x=t}get y(){return this.entity.y}set y(t){this.entity.y=t}get width(){return this.entity.width*this.entity.scaleX}get height(){return this.entity.height*this.entity.scaleY}init(t,e){this.data=t,this.setUI(),this.refreshUI(),e&&(this.cardRotBox.scale(0,0),Laya.Tween.to(this.cardRotBox,{scaleX:1,scaleY:1},500,Laya.Ease.backOut,null,0,!1)),a.log("color:",this.Type,this.cardName.color)}setUI(){if(this.entity.visible=!0,this.entity.alpha=1,this.entity.zOrder=0,this.cardRotBox=this.entity.getChildByName("rot_box"),this.cardShadow=this.cardRotBox.getChildByName("card_shadow"),this.cardBox1=this.cardRotBox.getChildByName("card_box1"),this.cardOther=this.cardBox1.getChildByName("card_other"),this.cardIcon=this.cardBox1.getChildByName("card_icon"),this.cardHpBox=this.cardBox1.getChildByName("card_hpbox"),this.cardNum=this.cardHpBox.getChildByName("card_num"),this.cardBox2=this.cardBox1.getChildByName("card_box2"),this.cardNum2=this.cardBox2.getChildByName("card_num"),this.cardName=this.cardBox1.getChildByName("card_name"),this.weaponShadow=this.cardRotBox.getChildByName("weapon_shadow"),this.weaponBox1=this.cardRotBox.getChildByName("weapon_box1"),this.weaponIcon=this.weaponBox1.getChildByName("weapon_icon"),this.weaponBox2=this.weaponBox1.getChildByName("weapon_box2"),this.weaponNum=this.weaponBox2.getChildByName("weapon_num"),this.weaponName=this.weaponBox1.getChildByName("weapon_name"),this.shieldBox=this.cardBox1.getChildByName("shield_box"),this.shieldNum=this.shieldBox.getChildByName("card_num"),this.cardLine=this.cardBox1.getChildByName("card_line"),this.cardExclamation=this.cardBox1.getChildByName("card_exclamation"),this.cardFightback=this.cardExclamation.getChildByName("card_fightback"),this.weaponBarBox=this.weaponBox1.getChildByName("weapon_barbox"),this.weaponBar=this.weaponBarBox.getChildByName("weapon_bar"),this.weakBox1=this.cardBox1.getChildByName("weak_box1"),this.weakBox2=this.cardBox1.getChildByName("weak_box2"),this.weakBox3=this.cardBox1.getChildByName("weak_box3"),this.weakAttr1=this.weakBox1.getChildByName("weak_attr1"),this.weakAttr2=this.weakBox2.getChildByName("weak_attr2"),this.weakAttr3=this.weakBox3.getChildByName("weak_attr3"),this.lock=this.cardRotBox.getChildByName("lock"),this.price=this.cardBox1.getChildByName("card_price"),this.cardOther.visible=!1,this.cardLine.visible=!1,this.cardIcon.visible=!1,this.weaponIcon.visible=!1,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.shieldBox.visible=!1,this.cardExclamation.visible=!1,this.cardFightback.visible=!1,this.weaponBarBox.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.lock.visible=!1,this.price.visible=!1,this.cardRotBox.rotation=z.randFloat(-2,2),this.Type==g[g.Hero]||this.Type==g[g.Enemy]||this.Type==g[g.Animal]){let t=z.randFloat(-3,3);this.weaponShadow.rotation=t,this.weaponBox1.rotation=t}this.Type==g[g.Hero]?this.weaponBox1.on(Laya.Event.CLICK,this,t=>{Wt.instance.OnShowHeroWeapon()}):this.Type==g[g.Enemy]||this.Type==g[g.Animal]?(this.refreshWeakUI(),this.weaponBox1.offAll()):this.weaponBox1.offAll()}refreshUI(){switch(this.cardName.text=this.data.cardName+"",this.Type){case g[g.Hero]:this.cardBox1.skin="BattleCard/Card6.png",this.cardOther.visible=!0,this.cardBox2.visible=!1,this.cardHpBox.visible=!0,this.weaponShadow.visible=!0,this.weaponBox1.visible=!0,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#2D2A25",this.weaponName.color="#2D2A25",this.cardNum.text=this.data.vrHero.currentHp+"",this.weaponNum.text=this.data.vrHero.FinalAtk+"",this.weaponName.text=this.data.vrHero.getAtkWeapon().name+"",0==this.data.vrHero.weaponSelect?this.weaponBarBox.visible=!1:(this.weaponBarBox.visible=!0,this.weaponBar.width=this.data.vrHero.getAtkWeapon().durability*(this.weaponBarBox.width-2)/this.data.vrHero.getAtkWeapon().data.Durability),this.data.vrHero.shieleAmout>0?(this.shieldBox.visible=!0,this.shieldNum.text=""+this.data.vrHero.shieleAmout):this.shieldBox.visible=!1;break;case g[g.Enemy]:case g[g.Animal]:this.cardBox1.skin="BattleCard/Card8.png",this.cardBox2.skin="BattleCard/CardTop2.png",this.cardOther.visible=!0,this.cardBox2.visible=!0,this.cardHpBox.visible=!1,this.weaponShadow.visible=!0,this.weaponBox1.visible=!0,this.weakBox1.visible=!0,this.weakBox2.visible=!0,this.weakBox3.visible=!0,this.cardName.color="#2D2A25",this.weaponName.color="#2D2A25",this.weaponNum.text=this.data.vrEnemy.FinalAtk+"",this.weaponName.text=this.data.vrEnemy.getAtkWeapon().name+"",this.cardNum2.text=this.data.vrEnemy.currentHp+"",this.weakAttr1.text=this.data.vrEnemy.shieleAmout+"";break;case g[g.Weapon]:this.cardBox1.skin="BattleCard/Card5.png",this.cardBox2.skin="BattleCard/CardTop3.png",this.cardOther.visible=!0,this.cardBox2.visible=!0,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#2D2A25",this.data.cardOrder==b.AtkWeapon?this.cardNum2.text=this.data.vrWeapon.atk+"":this.cardNum2.text=this.data.vrWeapon.shieleAmout+"";break;case g[g.Back]:this.cardBox1.skin="BattleCard/Card6.png",this.cardOther.visible=!0,this.cardBox2.visible=!1,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#2D2A25";break;case g[g.Box]:this.cardBox1.skin="BattleCard/Card2.png",this.cardOther.visible=!1,this.cardBox2.visible=!1,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#2D2A25";break;case g[g.Camp]:this.cardBox1.skin="BattleCard/Card7.png",this.cardBox2.skin="BattleCard/CardTop1.png",this.cardOther.visible=!0,this.cardBox2.visible=!0,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#2D2A25",this.cardNum2.text=this.data.cardValue+"";break;case g[g.Hole]:this.cardBox1.skin="BattleCard/Card1.png",this.cardOther.visible=!1,this.cardBox2.visible=!1,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#ffffff";break;case g[g.Road]:this.cardBox1.skin="BattleCard/Card6.png",this.cardOther.visible=!0,this.cardBox2.visible=!1,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#2D2A25";break;case g[g.Next]:this.cardBox1.skin="BattleCard/Card4.png",this.cardOther.visible=!1,this.cardBox2.visible=!1,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#ffffff";break;case g[g.Silver]:this.cardBox1.skin="BattleCard/Card3.png",this.cardBox2.skin="BattleCard/CardTop5.png",this.cardOther.visible=!0,this.cardBox2.visible=!0,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#2D2A25",this.cardNum2.text=this.data.cardValue+"";break;case g[g.Store]:this.cardBox1.skin="BattleCard/Card1.png",this.cardOther.visible=!1,this.cardBox2.visible=!1,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#ffffff";break;case g[g.Treasure]:this.cardBox1.skin="BattleCard/Card4.png",this.cardOther.visible=!1,this.cardBox2.visible=!1,this.cardHpBox.visible=!1,this.weaponShadow.visible=!1,this.weaponBox1.visible=!1,this.weakBox1.visible=!1,this.weakBox2.visible=!1,this.weakBox3.visible=!1,this.cardName.color="#ffffff"}}refreshWeaponUI(t=!1,e=!1){if(!e){this.weaponName.color="#2D2A25",this.weaponNum.text=this.data.vrHero.FinalAtk+"",this.weaponName.text=this.data.vrHero.getAtkWeapon().name+"";let t=z.randFloat(-3,3);this.weaponShadow.rotation=t,this.weaponBox1.rotation=t}0==this.data.vrHero.weaponSelect?this.weaponBarBox.visible=!1:(this.weaponBarBox.visible=!0,this.weaponBar.width=this.data.vrHero.getAtkWeapon().durability*(this.weaponBarBox.width-2)/this.data.vrHero.getAtkWeapon().data.Durability),t&&(a.log("动"),Wt.instance.banClick=!0,this.weaponShadow.pos(87,171),this.weaponBox1.pos(120,137),Laya.Tween.to(this.weaponShadow,{x:102,y:156},300,Laya.Ease.circIn,null,0,!0),Laya.Tween.to(this.weaponBox1,{x:105,y:152},300,Laya.Ease.circIn,new Laya.Handler(this,()=>{if(this.data){let t=this.data.vrHero.battleSkillComponents.selectSkill(ht.Talent);t&&Wt.instance.castSkill(t,0),Wt.instance.banClick=!1}}),0,!0))}refreshWeakUI(t=!1){if(this.data.vrEnemy.weak&&this.data.vrEnemy.weak.length>1){let e=[this.weakAttr2,this.weakAttr3],a=[this.weakBox2,this.weakBox3];for(let i=0;i<this.data.vrEnemy.exposedWeak.length;i++)if(1==this.data.vrEnemy.exposedWeak[i]){if("?"===e[i].text&&t){let t=a[i].localToGlobal(new Laya.Point(a[i].width/2,a[i].height+5));ke.instance.layerEffect.sceneGame.createShowWeak([t.x,t.y])}e[i].changeText(ke.instance.layerExplore.setAttrTxt(this.data.vrEnemy.weak[i])[0]+"")}else e[i].changeText("?")}}refreshLockUI(){this.data.cardLock?(this.lock.visible=!0,this.lock.scale(0,0),Laya.Tween.to(this.lock,{scaleX:1,scaleY:1},600,Laya.Ease.backOut,null,0,!0)):this.lock.visible=!1}refreshPriceUI(){-1!=this.data.cardPrice&&(this.price.visible=!0,this.price.changeText(this.data.cardPrice+"c"))}setXY(...t){let e=t[0],a=t[1];this.entity.pos(e,a)}syncOrder(){this.entity.zOrder=this.y}showShadow(t,e,a){if(t)this.entity.zOrder=9998,Laya.Tween.to(this.cardShadow,{x:61-e,y:93+e},50,Laya.Ease.sineOut,new Laya.Handler(this,()=>{Laya.Tween.to(this.cardShadow,{x:61-a,y:93+a},450,Laya.Ease.sineOut,null,0,!0)}),0,!0),Laya.Tween.to(this.cardBox1,{x:66+e,y:88-e},50,Laya.Ease.sineOut,new Laya.Handler(this,()=>{Laya.Tween.to(this.cardBox1,{x:66+a,y:88-a},450,Laya.Ease.sineOut,null,0,!0)}),0,!0),Laya.Tween.to(this.weaponShadow,{x:102+e,y:156-e},50,Laya.Ease.sineOut,new Laya.Handler(this,()=>{Laya.Tween.to(this.weaponShadow,{x:102+a,y:156-a},450,Laya.Ease.sineOut,null,0,!0)}),0,!0),Laya.Tween.to(this.weaponBox1,{x:105+e,y:152-e},50,Laya.Ease.sineOut,new Laya.Handler(this,()=>{Laya.Tween.to(this.weaponBox1,{x:105+a,y:152-a},450,Laya.Ease.sineOut,null,0,!0)}),0,!0);else{this.syncOrder();let t=Math.floor(61-this.cardShadow.x);t=t<=2?1:t,Laya.Tween.to(this.cardShadow,{x:61,y:93},50*t,Laya.Ease.sineOut,null,0,!0),Laya.Tween.to(this.cardBox1,{x:66,y:88},50*t,Laya.Ease.sineOut,null,0,!0),Laya.Tween.to(this.weaponShadow,{x:102,y:156},50*t,Laya.Ease.sineOut,null,0,!0),Laya.Tween.to(this.weaponBox1,{x:105,y:152},50*t,Laya.Ease.sineOut,null,0,!0)}}showSeleteLine(t){this.cardLine.visible=t}showExclamation(t,e){return t?(this.cardFightback.visible=!0,this.cardFightback.text="反击"):(this.cardFightback.visible=!1,this.cardFightback.text=""),new Promise(t=>{this.cardExclamation.visible=!0,this.cardExclamation.scale(0,0),Laya.Tween.to(this.cardExclamation,{scaleX:1,scaleY:1,alpha:1},e,Laya.Ease.backOut,new Laya.Handler(this,()=>{Laya.Tween.to(this.cardExclamation,{alpha:0},e,Laya.Ease.circIn,new Laya.Handler(this,()=>{this.cardExclamation.visible=!1,t()}))}))})}showBreak(t,e){return this.cardFightback.visible=!0,this.cardFightback.text=t?"晕眩":"破防",this.syncOrder(),new Promise(t=>{this.cardExclamation.visible=!0,this.cardExclamation.scale(0,0),Laya.Tween.to(this.cardExclamation,{scaleX:1,scaleY:1,alpha:1},e,Laya.Ease.backOut,new Laya.Handler(this,()=>{t()}))})}showFightback(t){return this.cardFightback.visible=!0,this.cardFightback.text="防反",new Promise(e=>{this.cardExclamation.visible=!0,this.cardExclamation.scale(0,0),Laya.Tween.to(this.cardExclamation,{scaleX:1,scaleY:1,alpha:1},t,Laya.Ease.backOut,new Laya.Handler(this,()=>{Laya.Tween.to(this.cardExclamation,{alpha:0},t,Laya.Ease.circIn,new Laya.Handler(this,()=>{this.cardExclamation.visible=!1,e()}))}))})}hideBreak(t){Laya.Tween.to(this.cardExclamation,{alpha:0},t,Laya.Ease.circIn,new Laya.Handler(this,()=>{this.cardExclamation.visible=!1}))}showMoveReady(t,e){t?(this.entity.zOrder=1e4,Laya.Tween.to(this.cardRotBox,{scaleX:1.2,scaleY:1.2},e,Laya.Ease.circOut,null,0,!0),Laya.Tween.to(this.cardShadow,{x:56,y:98},e,Laya.Ease.circOut,null,0,!0),Laya.Tween.to(this.cardBox1,{x:71,y:83},e,Laya.Ease.circOut,null,0,!0),Laya.Tween.to(this.weaponShadow,{x:107,y:151},e,Laya.Ease.circOut,null,0,!0),Laya.Tween.to(this.weaponBox1,{x:110,y:147},e,Laya.Ease.circOut,null,0,!0)):(this.syncOrder(),Laya.Tween.to(this.cardRotBox,{scaleX:1,scaleY:1},e,Laya.Ease.circIn,null,0,!0),Laya.Tween.to(this.cardShadow,{x:61,y:93},e,Laya.Ease.circIn,null,0,!0),Laya.Tween.to(this.cardBox1,{x:66,y:88},e,Laya.Ease.circIn,null,0,!0),Laya.Tween.to(this.weaponShadow,{x:102,y:156},e,Laya.Ease.circIn,null,0,!0),Laya.Tween.to(this.weaponBox1,{x:105,y:152},e,Laya.Ease.circIn,null,0,!0))}showHide(t,e){return new Promise(a=>{Laya.Tween.to(this.entity,{alpha:0,y:e},t,Laya.Ease.sineOut,new Laya.Handler(this,()=>{this.entity.visible=!1,a()}),0,!0)})}showScale(t,e,a){t?(this.entity.zOrder=9999,Laya.Tween.to(this.cardRotBox,{scaleX:e,scaleY:e},a,Laya.Ease.circOut,null,0,!1)):(this.syncOrder(),Laya.Tween.to(this.cardRotBox,{scaleX:1,scaleY:1},a,Laya.Ease.cubicOut,null,0,!1))}showRotation(t,e,a){if(t)Laya.Tween.to(this.cardRotBox,{rotation:e},a,Laya.Ease.circOut,null,0,!1);else{let t=z.randFloat(-2,2);Laya.Tween.to(this.cardRotBox,{rotation:t},a,Laya.Ease.sineOut,null,0,!1)}}showTrailAni(t){this.trailAni=Ct.createAni("CreateTrail","res/atlas/Ani/CardTrail.atlas","Ani/CardTrail/",3,120),this.cardRotBox.addChild(this.trailAni),this.trailAni.pos(0,0),this.trailAni.scale(3,3),this.trailAni.pivot(220-this.cardRotBox.width/2/3,180-this.cardRotBox.height/2.5/3),this.trailAni.play(0,!0),this.trailAni.alpha=0,Laya.Tween.to(this.trailAni,{alpha:1},t,Laya.Ease.circOut,null,0,!1)}hideTrailAni(t){Laya.Tween.to(this.trailAni,{alpha:0},t,Laya.Ease.sineOut,new Laya.Handler(this,()=>{this.trailAni.stop(),this.trailAni.removeSelf(),Laya.Pool.recover("CreateTrail",this.trailAni)}),0,!1)}dispose(){this.trailAni&&(this.trailAni.stop(),this.trailAni.removeSelf(),Laya.Pool.recover("CreateTrail",this.trailAni)),this.entity.removeSelf(),Laya.Pool.recover("BattleNormalCard",this.entity)}}class Bt{constructor(t,e,a){this.data=new Lt,this.data.init(t,e,a)}dispose(t=!1){this.refreshEvent(!1),this.removeEvent(),null!=this.render&&(this.render.dispose(),this.render=null),null!=this.data&&(this.data=null)}addEvent(){}removeEvent(){}createRender(t,e=!1){return new Promise(a=>{Laya.loader.load("prefab/BattleNormalCard.json",Laya.Handler.create(this,i=>{let r=new Laya.Prefab;r.json=i;let s=Laya.Pool.getItemByCreateFun("BattleNormalCard",r.create,r);s.visible=!1,Wt.instance.cardParent.addChild(s),this.render=s.addComponent(kt),this.render.init(this.data,e),this.render.setXY(t[0],t[1]),this.render.entity.visible=!0,this.refreshEvent(!0),this.addEvent(),a()}))})}flushRender(){this.render.refreshUI()}refreshEvent(t){}}class Dt{constructor(t=null){this.cardList=null!=t?t:new Array}dispose(t){for(var e=0;e<this.cardList.length;e++)this.cardList[e].dispose(t);this.cardList=[]}findTypeCard(t){let e=[];for(let a=0;a<this.cardList.length;a++)this.cardList[a].data.cardType==g[t]&&e.push(this.cardList[a]);return e}checkOneTypeCard(t){let e=!0;for(let a=0;a<this.cardList.length;a++)this.cardList[a].data.cardType!=g[t]&&(e=!1);return e}checkTwoTypeCard(t,e){let a=!0;this.cardList[0].data.cardType,g[t];for(let t=1;t<this.cardList.length;t++)this.cardList[t].data.cardType!=g[e]&&(a=!1);return a}getFirstCard(){return this.cardList.length>0?this.cardList[0]:null}getLastCard(){if(this.cardList.length>0){var t=this.cardList.length-1;return this.cardList[t]}return null}getIndexCard(t){return this.cardList.length>0?this.cardList[t]:null}getLastCardIndex(){return this.cardList.length>0?this.cardList.length-1:-1}concat(t){this.cardList=this.cardList.concat(t.cardList),t.cardList.splice(0)}flushAllCardRender(){this.cardList.forEach(t=>{t.render.refreshUI()})}spliteGroupByTopNum(t){let e=null;if(this.cardList.length<=t)e=this.spliteGroup(0);else{let i=this.cardList.length-t;a.log("spliteGroupByTopNum:",i),e=this.spliteGroup(i)}return e}spliteGroupFromFront(t){let e=null;if(t>=this.cardList.length)e=this.cardList,this.cardList=new Array;else{let a=this.cardList.slice(this.cardList.length-t,this.cardList.length),i=this.cardList.slice(0,this.cardList.length-t);e=a,this.cardList.splice(0),this.cardList=i}return new Dt(e)}clearGroup(){let t=this.cardList;return this.cardList=new Array,new Dt(t)}spliteGroupFromType(t){let e=this.findTypeCard(t);return this.cardList=this.cardList.minus(e),new Dt(e)}spliteGroup(t){let e=this.cardList.slice(t);return this.cardList.splice(t),new Dt(e)}sliceGroup(t){let e=this.cardList.slice(t);return new Dt(e)}cloneGroup(t){let e=new Array;for(let a=t;a<this.cardList.length;a++){let t=this.cardList[a].data.data,i=this.cardList[a].data.cardValue,r=this.cardList[a].data.cardOrder,s=new Bt(t,i,r);e.push(s)}return new Dt(e)}createFull(){this.cardList=new Array,this.cardList=[]}addGroup(t){this.cardList.push(t)}unshiftGroup(t){this.cardList.unshift(t)}}class At{static initFloor(t){var e=t,a=[];if(this.xa=[],this.xa2=[],e>60&&e<=100){var i=Math.floor(e/2),r=e-i;this.xxx2(i,30,this.xa),this.xxx2(r,30,this.xa2);var s=z.quickSort2(this.xa,"s",0,this.xa.length-1),o=z.quickSort2(this.xa2,"s",0,this.xa2.length-1);a=a.concat(s[s.length-1].sum,o[o.length-1].sum)}else if(this.xxx2(e,30,this.xa),this.xa.length>1){s=z.quickSort2(this.xa,"s",0,this.xa.length-1);a=a.concat(s[s.length-1].sum)}else{s=this.xa[0];a=a.concat(s.sum)}for(var n=a.splice(a.length-2,a.length-1),h=0;h<3;h++)this.shuffle(a);return a.splice(0,0,n[0]),a.push(n[1]),a}static shuffle(t){for(var e=t.length-1,a=0;a<e;a++){var i=z.getRandom(0,e),r=Math.floor(i);if(r!=a){var s=t[a],o=t[r];t[a]=o,t[r]=s}}}static half(t){var e=Math.floor(t/3),a=t-e;e>3?this.half(e):this.narray.push(e),a>3?this.half(a):this.narray.push(a)}static xxx(t,e){var a=new Array;for(let i=0;i<t+1;i++){a[i]=[];for(let t=0;t<e+1;t++)a[i][t]=0}a[0][0]=1;for(let i=1;i<=t;i++)for(let t=1;t<=e;t++)i>=t&&(a[i][t]=Number(a[i-t][t])+Number(a[i-1][t-1]),a[i][t])}static xxx2(t,e,a){var i=[];!function summation(e,r,s){if(e>0){for(var o=r;o<=e;o++)i[s]=o,summation(e-o,o,s+1);return}if(i[0]==t)return;var n=[];n.push(i[0]);let h=1,l=0,c=0;for(var d=1;d<s;d++){if(n.push(i[d]),i[d]>3)return;3==i[d]&&(c+=1),2==i[d]&&(l+=1),1==i[d]&&(h+=1)}c<=h||l>=c||h>1&&l>0&&c>0&&h+l>=Math.floor(c/2)&&a.push({sum:n,s:s})}(t,1,0)}static xxx3(t,e){}}At.xa=[],At.xa2=[],At.narray=[];class Tt extends ot.Items.ValuesUIUI{constructor(){super()}}class Et extends Laya.Script{static get instance(){return Et._instance||(Et._instance=new Et),Et._instance}showTips(t,e,a,i="#ffffff",r=28){var s=new Tt;s.showTxt.text=t+"",s.showTxt.color=i,s.showTxt.fontSize=r,s.pos(e,a+50),ke.instance.layerEffect.addChild(s),s.zOrder=998,s.alpha=0,Laya.Tween.to(s,{y:a-50,alpha:1},500,Laya.Ease.circOut,Laya.Handler.create(this,()=>{s.removeSelf(),s.destroy()}))}showMoreTips(t,e,a,i,r=0,s="#ffffff",o=28){e.length>0&&Laya.timer.once(r,this,()=>{this.loopShowTips(t,0,e,a,i,s,o)})}loopShowTips(t,e,i,r=Laya.stage.width/2,s=Laya.stage.height/2,o="#ffffff",n=28){var h=new Tt;h.showTxt.text=i[e]+"",h.showTxt.color=o,h.showTxt.fontSize=n,h.pos(r,s+50),ke.instance.layerEffect.addChild(h),h.zOrder=998,h.alpha=0,Laya.Tween.to(h,{y:s-50,alpha:1},500,Laya.Ease.circOut,Laya.Handler.create(this,()=>{h.removeSelf(),h.destroy()})),e+=1,a.log("loopShowTips:",r,s,e,t),e>=t?Laya.timer.clear(this,this.loopShowTips):Laya.timer.once(200,this,this.loopShowTips,[t,e,i,r,s])}}class Mt extends ot.Items.TitleBannerUI{static get instance(){return Mt._instance||(Mt._instance=new Mt),Mt._instance}showBroadcastBanner(t,e=500){return Laya.stage.addChild(this),this.zOrder=Laya.stage.height,this.pos(Laya.stage.width/2,Laya.stage.height/2),a.log("BroadcastBanner:",t),this.txt.text=t+"",new Promise(t=>{this.alpha=0,Laya.Tween.to(this,{alpha:1},e,Laya.Ease.sineOut,new Laya.Handler(this,()=>{Laya.Tween.to(this,{alpha:0,y:0},e,Laya.Ease.sineOut,new Laya.Handler(this,()=>{this.removeSelf(),t()}))}))})}}class Gt extends ot.Items.TipsUIUI{}class Pt extends Laya.Script{static get instance(){return Pt._instance||(Pt._instance=new Pt),Pt._instance}showTips(t){var e=new Gt;e.showTxt.text=t,e.pos(Laya.stage.width/2,Laya.stage.height/2-200),Laya.stage.addChild(e),e.zOrder=998,Laya.Tween.to(e,{y:Laya.stage.height/2-300},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{e.removeSelf(),e.destroy()}))}showMoreTips(t,e){e.length>0&&this.loopShowTips(t,0,e)}loopShowTips(t,e,i){var r=new Gt;r.showTxt.text=i[e],r.pos(Laya.stage.width/2,Laya.stage.height/2-200),Laya.stage.addChild(r),r.zOrder=998,Laya.Tween.to(r,{y:Laya.stage.height/2-300},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{r.removeSelf(),r.destroy()})),e+=1,a.log("loopShowTips:",e,t),e>=t?Laya.timer.clear(this,this.loopShowTips):Laya.timer.once(100,this,this.loopShowTips,[t,e,i])}}class Ht extends ot.Items.AddDetailsWithBattleUI{constructor(){super(),this.scaleNum=.4,this.isShow=!1}static get instance(){return Ht._instance||(Ht._instance=new Ht),Ht._instance}get IsShow(){return this.isShow}initGame(t){t.addChild(this),this.visible=!1,this.isShow=!1,this.box.scale(this.scaleNum,this.scaleNum),this.pos(0,0)}onShow(t,e,a=!1){if(t){if(this.isShow)return;this.visible=!0,this.zOrder=1,this.card=e,this.initRepeat(),this.isShow=!0}else{if(!this.isShow)return;this.zOrder=0,this.visible=!1,this.isShow=!1}}initRepeat(){if(this.card)switch(this.card.data.cardType){case g[g.Hero]:this.infoBox.visible=!1,this.attrBox.visible=!0,this.weaponBox.visible=!1,this.detailName.text=this.card.data.vrHero.name+"",this.hpLb.text=this.card.data.vrHero.currentHp+"/"+this.card.data.vrHero.FinalCompleteHp,this.atkLb.text=this.card.data.vrHero.FinalAtk+"",this.hitLb.text=this.card.data.vrHero.FinalHit+"",this.dodgeLb.text=this.card.data.vrHero.FinalDodge+"",this.critLb.text=this.card.data.vrHero.FinalCrit+"",this.critDamageLb.text=this.card.data.vrHero.FinalCritDamage+"",this.descBox.text=this.card.data.vrHero.desc+"";break;case g[g.Enemy]:case g[g.Animal]:this.infoBox.visible=!1,this.attrBox.visible=!0,this.weaponBox.visible=!1,this.detailName.text=this.card.data.vrEnemy.name+"",this.hpLb.text=this.card.data.vrEnemy.currentHp+"/"+this.card.data.vrEnemy.FinalCompleteHp,this.atkLb.text=this.card.data.vrEnemy.FinalAtk+"",this.hitLb.text=this.card.data.vrEnemy.FinalHit+"",this.dodgeLb.text=this.card.data.vrEnemy.FinalDodge+"",this.critLb.text=this.card.data.vrEnemy.FinalCrit+"",this.critDamageLb.text=this.card.data.vrEnemy.FinalCritDamage+"",this.descBox.text=this.card.data.vrEnemy.desc+"";break;case g[g.Weapon]:this.infoBox.visible=!1,this.attrBox.visible=!1,this.weaponBox.visible=!0,this.detailName.text=""+this.card.data.vrWeapon.name,this.wpAttr.text=""+ke.instance.layerExplore.setAttrTxt(this.card.data.vrWeapon.attributes)[0],this.wpAtk.text=""+this.card.data.vrWeapon.atk,this.wpDurability.text=""+(-1==this.card.data.vrWeapon.durability?"∞":this.card.data.vrWeapon.durability),this.wpSpecial.text=this.card.data.vrWeapon.rare+"",this.wpShield.text=this.card.data.vrWeapon.shieleAmout+"",this.wpLink.text=this.card.data.vrWeapon.link+"阶";let t=this.card.data.vrWeapon.desc+"\n";""!=this.card.data.vrWeapon.effectDebutInfo&&(t+="登场:"+this.card.data.vrWeapon.effectDebutInfo+"\n"),""!=this.card.data.vrWeapon.effectPassiveInfo&&(t+="永久:"+this.card.data.vrWeapon.effectPassiveInfo+"\n"),""!=this.card.data.vrWeapon.effectInitiativeInfo&&(t+="主动:"+this.card.data.vrWeapon.effectInitiativeInfo),this.wpInfo.text=t;break;default:this.infoBox.visible=!0,this.attrBox.visible=!1,this.weaponBox.visible=!1,this.detailName.text=""+this.card.data.cardName,this.allInfo.text=""+this.card.data.cardDesc}}}class Ot extends ot.Items.AddDetailsWithTreasureUI{constructor(){super(),this.scaleNum=.4}static get instance(){return Ot._instance||(Ot._instance=new Ot),Ot._instance}initGame(t){t.addChild(this),this.box.scale(this.scaleNum,this.scaleNum),this.pos(0,0),this.treasureList.renderHandler=new Laya.Handler(this,this.updateTreasureList),this.treasureList.vScrollBarSkin="",this.treasureList.scrollBar.elasticBackTime=50,this.treasureList.scrollBar.elasticDistance=20,this.treasureList.scrollBar.hide=!0}initRepeat(){this.treasureList.array=[],this.infoBox.visible=!1}refresh(){let t=[],e=[];for(let a=0;a<Wt.instance.playerGroupData.cardList[0].data.vrHero.treasuresWithBattle.length;a++){let i=Wt.instance.playerGroupData.cardList[0].data.vrHero.treasuresWithBattle[a],r=E.instance.select(L.BattleTreasure).asDict[i];e.contains(i)?t.select(t=>t.id).amout+=1:(e.push(i),t.push({id:i,data:r,amout:1}))}this.treasureList.array=t}updateTreasureList(t,e){let a=t.dataSource.data,i=t.dataSource.amout,r=t.getChildByName("name"),s=t.getChildByName("amout");r.text=""+a.Name,s.text=""+i,t.offAll(),t.on(Laya.Event.MOUSE_OVER,this,this.OnMouseOverTr,[a]),t.on(Laya.Event.MOUSE_OUT,this,this.OnMouseOutTr,[a])}OnMouseOverTr(t){this.infoBox.visible=!0,this.detailName.text=""+t.Name,this.detailDesc.text=""+t.Desc}OnMouseOutTr(t){this.infoBox.visible=!1}}class Wt{constructor(){this.silver=0,this.batter=0,this.fightback=0,this.battlePlaceRes=null,this.battleEnemyRes=null,this.battleHeroRes=null,this.battleAnimalRes=null,this.battleCardRes=null,this.battleWeaponRes=null,this.battleTreasureRes=null,this.specailWeaponRes=null,this.nowTimeDown=0,this.currentBattleKey=null,this.currentBattleType=null,this.currentBattleData=null,this.currentSpecialWeaponData=null,this.currentDetail=null,this.currentDeckMaxCard=0,this.currentDeckMaxFloor=0,this.currentDeckFloor=0,this.currentSubMaxCard=0,this.currentSubMaxFloor=0,this.currentSubFloor=0,this.isIntoSub=!1,this.banClick=!1,this.saveSpWeaponDataSO=null}static get instance(){return Wt._instance||(Wt._instance=new Wt),Wt._instance}init(){this.dragMovingStartPos=new Laya.Point,this.mouseStartPos=new Laya.Point,this.isStartDraging=!1,this.isStartDragMoved=!1,this.nowTimeDown=0,this.battlePlaceRes=E.instance.select(L.BattlePlace).asDict,this.battleEnemyRes=E.instance.select(L.BattleEnemy).asDict,this.battleHeroRes=E.instance.select(L.BattleHero).asDict,this.battleAnimalRes=E.instance.select(L.BattleAnimal).asDict,this.battleCardRes=E.instance.select(L.BattleCard).asDict,this.battleWeaponRes=E.instance.select(L.BattleWeapon).asDict,this.battleTreasureRes=E.instance.select(L.BattleTreasure).asDict,this.specailWeaponRes=E.instance.select(L.MixWeapon).asDict}initRepeat(){this.cardParent=ke.instance.layerExplore,this.currentBattleKey={},this.currentBattleType=""}initArg(){this.silver=0,this.batter=0,this.fightback=0,this.banClick=!1,this.startGroupData=null,this.deckGroupData=null,this.subGroupData=null,this.playerGroupData=null,this.currentGroupData=null,this.currentBranch=0,this.maxBranchArr=[],this.detailArr=[],this.currentDetail={},this.currentDeckMaxCard=0,this.currentDeckMaxFloor=0,this.currentDeckFloor=0,this.currentDeckFloorArr=[],this.currentSubMaxCard=0,this.currentSubMaxFloor=0,this.currentSubFloor=0,this.currentSubFloorArr=[],this.savePlayerXBeforeIntoSub=0,this.currentFloor=0,this.currentFloorArr=[],this.currentFloorSign={},this.isIntoSub=!1,this.typeIntoSub="",this.isStartDraging=!1,this.isStartDragMoved=!1,this.mouseStartPos.set(0,0),this.dragMovingStartPos.set(0,0),this.nowTimeDown=0,this.saveSpWeaponDataSO={},this.currentSpecialWeaponData={};let t=T.instance.get(null,I.SpecialWeaponData);for(let e in t)if(t[e]){let a=this.specailWeaponRes[t[e].id];this.currentSpecialWeaponData[e]={data:a,amout:t[e].amout}}a.log("Object.assign:",this.currentSpecialWeaponData,t)}setBattle(t,e,a){this.currentBattleKey={type:t,heroKey:e,otherKey:a},this.currentBattleType=t,T.instance.set("SaveBattleDataSO",this.currentBattleKey,I.GameItems,!1),T.instance.save(),F.instance.runTime(!1),ke.instance.layerDialog.onDialogBattleConfirminquiry()}backBattle(t){this.currentBattleKey=t,this.currentBattleType=t.type,F.instance.runTime(!1),ke.instance.layerDialog.onDialogBattleConfirminquiry()}clearBattle(){let t=-1;this.playerGroupData&&this.playerGroupData.cardList.length>0&&this.playerGroupData.cardList[0].data.vrHero&&(t=this.playerGroupData.cardList[0].data.vrHero.currentHp);let e=this.destoryTakeAlongWeapon();this.clearGroup();let i=this.currentBattleKey.heroKey;Ae.instance.outOfBattle(i,e,t),this.currentBattleKey={},this.currentBattleType="",T.instance.delete("SaveBattleDataSO",I.GameItems),T.instance.save(),a.log("clearBattle",T.instance.get("SaveBattleDataSO",I.GameItems)),F.instance.runTime(!0)}endBattle(t){let e=-1;this.playerGroupData&&this.playerGroupData.cardList.length>0&&this.playerGroupData.cardList[0].data.vrHero&&(e=this.playerGroupData.cardList[0].data.vrHero.currentHp);let i=this.destoryTakeAlongWeapon();this.clearGroup();let r=Object.assign({},this.currentBattleKey);Ae.instance.endBattle(t,r,i,e),this.currentBattleKey={},this.currentBattleType="",T.instance.delete("SaveBattleDataSO",I.GameItems),T.instance.save(),a.log("clearBattle",T.instance.get("SaveBattleDataSO",I.GameItems))}destoryTakeAlongWeapon(){if(this.playerGroupData&&this.playerGroupData.cardList.length>0&&this.playerGroupData.cardList[0].data.vrHero&&this.playerGroupData.cardList[0].data.vrHero.atkWeaponKey){let t=this.playerGroupData.cardList[0].data.vrHero.atkWeaponKey,e=this.playerGroupData.cardList[0].data.vrHero.atkWeaponWithBattle.select(e=>e.key==t);if(!e)return!0;j.instance.weaponItems[t].refreshDurability(e.durability)}return!1}clearGroup(){this.startGroupData&&this.startGroupData.dispose(!1),this.deckGroupData&&this.deckGroupData.dispose(!1),this.subGroupData&&this.subGroupData.dispose(!1),this.playerGroupData&&this.playerGroupData.dispose(!1),this.currentGroupData&&this.currentGroupData.dispose(!1)}playerDeath(){ke.instance.layerDialog.onDialogExploreEnd(!1)}bossDeath(){ke.instance.layerDialog.onDialogExploreEnd(!0)}designCard(){if(!this.currentBattleKey||!this.currentBattleKey.heroKey||!this.currentBattleKey.otherKey)return;this.initArg(),this.startGroupData=new Dt,this.deckGroupData=new Dt,this.subGroupData=new Dt,this.playerGroupData=new Dt,this.currentGroupData=new Dt;let t=j.instance.heroItems[this.currentBattleKey.heroKey].data,e=new Bt(t,0,-1);if(e.createRender([this.currentBattleType==d[d.Animal]||this.currentBattleType==d[d.Enemy]?this.cardParent.heroTemp4.x:this.cardParent.heroTemp1.x,this.currentBattleType==d[d.Animal]||this.currentBattleType==d[d.Enemy]?this.cardParent.heroTemp4.y:this.cardParent.heroTemp1.y]).then(()=>{this.playerGroupData.addGroup(e),this.flushGroupClick(),D.event(r.RefreshSilver,0),this.addBatterPoint(!1,0),this.addFightbackPoint([],null,0),D.event(r.RefreshWeapon,[!0])}),this.currentBattleType==d[d.Animal]){let t=j.instance.animalItems[this.currentBattleKey.otherKey].data,a=new Bt(t,0,b.Boss);this.currentDeckMaxFloor=1,this.currentFloorArr=[1],this.deckGroupData.addGroup(a),this.currentGroupData=this.deckGroupData,a.data.setFloor(1),a.createRender([this.cardParent.cardTemp10.x,this.cardParent.cardTemp10.y-800]).then(()=>{let t=[{floor:this.currentDeckMaxFloor,x:this.cardParent.cardTemp10.x,y:this.cardParent.cardTemp10.y,entity:a.render.entity}];this.startCardSorting(t)}),this.setCurFloorAndStart(e,"狩猎")}else if(this.currentBattleType==d[d.Enemy]){a.log("Enemy:",this.currentBattleKey.otherKey,j.instance.enemyItems);let t=j.instance.enemyItems[this.currentBattleKey.otherKey].data,i=new Bt(t,0,b.Boss);this.currentDeckMaxFloor=1,this.currentFloorArr=[1],this.deckGroupData.addGroup(i),this.currentGroupData=this.deckGroupData,i.data.setFloor(1),i.createRender([this.cardParent.cardTemp10.x,this.cardParent.cardTemp10.y-800]).then(()=>{let t=[{floor:this.currentDeckMaxFloor,x:this.cardParent.cardTemp10.x,y:this.cardParent.cardTemp10.y,entity:i.render.entity}];this.startCardSorting(t)}),this.setCurFloorAndStart(e,"狩猎")}else{let t=T.instance.get(this.currentBattleKey.otherKey,I.MapNormalCard);if(t){let a=t.cardID,i=t.cardLevel,r=[];for(const t in this.battlePlaceRes)this.battlePlaceRes[t]&&this.battlePlaceRes[t].HomeID==a&&this.battlePlaceRes[t].Level==i&&r.push(t);if(this.currentBattleData=this.battlePlaceRes[r[z.randInt(0,r.length-1)]],!this.currentBattleData)throw"unknow place:"+a;this.maxBranchArr=[],this.maxBranchArr=z.randomSomeByOriginalSort(this.currentBattleData.DetailProbability,this.currentBattleData.Branch).map(t=>t.originIdx),this.detailArr=this.currentBattleData.Detail,this.designPlace(e,z.randInt(0,this.maxBranchArr.length-1))}}}designPlace(t,e){this.deckGroupData.dispose(!1),this.startGroupData.dispose(!1),this.currentDeckMaxCard=0,this.currentDetail={},this.currentFloorSign={},this.currentBranch=this.maxBranchArr.splice(e,1)[0];let i=this.detailArr[this.currentBranch].split("-");a.log("currentBattleData:",e,this.maxBranchArr,this.detailArr,this.currentBattleData,this.currentBranch),i.forEach((t,e)=>{let a=Number(t);e==b.Next&&(a=this.maxBranchArr.length>=3?3:this.maxBranchArr.length),e==b.Boss&&0==this.maxBranchArr.length&&(a=1),this.currentDetail[b[e]]=a,this.currentDeckMaxCard+=a,this.currentDetail.arr||(this.currentDetail.arr=[]);for(let t=0;t<a;t++)this.currentDetail.arr.push(b[e])}),this.currentDeckFloorArr=At.initFloor(this.currentDeckMaxCard),this.currentDeckMaxFloor=this.currentDeckFloorArr.length,this.currentDetail.Boss>0?(this.adjustFloorArr(1,0,1,0),this.adjustFloorArr(3,1,2,1)):(this.adjustFloorArr(this.maxBranchArr.length>=3?3:this.maxBranchArr.length,0,1,0),this.adjustFloorArr(1,1,2,1)),this.adjustFloorArr(3,this.currentDeckMaxFloor-1,1,1),a.log("designCard:",this.currentDeckMaxFloor,this.currentDeckMaxCard,this.currentDetail,this.currentDeckFloorArr),this.createStartGroupData(),this.createDeckGroupData(),this.startRenderCard();let r=this.currentBattleData.DetailName[this.currentBranch];this.setCurFloorAndStart(t,r)}setCurFloorAndStart(t,e){this.currentFloorArr=this.currentDeckFloorArr,this.currentDeckFloor=this.currentDeckMaxFloor+1,t.data.setFloor(this.currentDeckFloor),this.currentFloor=this.currentDeckFloor,Mt.instance.showBroadcastBanner(e).then(()=>{D.event(r.RefreshBattleTitle,e),this.currentFloorArr.length>1&&(D.event(r.RefreshBattleBar,[!1,0,this.currentFloorArr.length]),D.event(r.RefreshBattleBarSign,[!0,this.currentFloorArr.length,this.currentFloorSign]))})}createStartGroupData(){if(this.currentDetail.Boss>0)for(let t=0;t<this.currentDetail.Boss;t++)this.addStartProbabilityChain(this.currentBattleData.BossEnemy,this.currentBattleData.BossEnemyProbability,this.battleEnemyRes,b.Boss);if(this.currentDetail.Store>0)for(let t=0;t<this.currentDetail.Store;t++)this.addStartEventChain(20002,null,this.battleCardRes,b.Store);if(this.currentDetail.Box>0)for(let t=0;t<this.currentDetail.Box;t++)this.addStartEventChain(20003,null,this.battleCardRes,b.Box);if(this.currentDetail.Treasure>0)for(let t=0;t<this.currentDetail.Treasure;t++)this.addStartProbabilityChain(this.currentBattleData.Treasure,this.currentBattleData.TreasureProbability,this.battleTreasureRes,b.Treasure);if(this.currentDetail.NormalEnemy>0)for(let t=0;t<this.currentDetail.NormalEnemy;t++)this.addStartProbabilityChain(this.currentBattleData.NormalEnemy,this.currentBattleData.NormalEnemyProbability,this.battleEnemyRes,b.NormalEnemy);if(this.currentDetail.Camp>0)for(let t=0;t<this.currentDetail.Camp;t++)this.addStartEventChain(20004,this.currentBattleData.Camp,this.battleCardRes,b.Camp);if(this.currentDetail.AtkWeapon>0)for(let t=0;t<this.currentDetail.AtkWeapon;t++)this.addStartProbabilityChain(this.currentBattleData.AtkWeapon,this.currentBattleData.AtkWeaponProbability,this.battleWeaponRes,b.AtkWeapon);if(this.currentDetail.DefWeapon>0)for(let t=0;t<this.currentDetail.DefWeapon;t++)this.addStartProbabilityChain(this.currentBattleData.DefWeapon,this.currentBattleData.DefWeaponProbability,this.battleWeaponRes,b.DefWeapon);if(this.currentDetail.Silver>0)for(let t=0;t<this.currentDetail.Silver;t++)this.addStartEventChain(20001,this.currentBattleData.Silver,this.battleCardRes,b.Silver);if(this.currentDetail.EliteEnemy>0)for(let t=0;t<this.currentDetail.EliteEnemy;t++)this.addStartProbabilityChain(this.currentBattleData.EliteEnemy,this.currentBattleData.EliteEnemyProbability,this.battleEnemyRes,b.EliteEnemy);if(this.currentDetail.Next>0)for(let t=0;t<this.currentDetail.Next;t++)this.addStartEventChain(20011,[0,t,t],this.battleCardRes,b.Next);this.startGroupData.cardList.sort((t,e)=>e.data.cardValue-t.data.cardValue),a.log("createStartGroupData:",this.startGroupData,this.currentDetail.arr)}createDeckGroupData(){if(this.currentDeckFloorArr.length<=0)return;for(let t=0;t<this.currentDeckFloorArr.length;t++)this.deckGroupData.cardList.push(void 0);let t=0;if(this.currentDetail.Boss>0){this.selectTypeGroup(!1,1,t,b.Boss),t++;for(let e=0;e<this.currentDeckFloorArr[1];e++)this.selectTypeGroup(!1,2,t,b.Camp,b.AtkWeapon,b.DefWeapon,b.Treasure,b.Box),t++}else{for(let e=0;e<this.currentDeckFloorArr[0];e++)this.selectTypeGroup(!1,1,t,b.Next),t++;this.selectTypeGroup(!1,2,t,b.EliteEnemy),t++}for(let t=0;t<this.currentDeckFloorArr[this.currentDeckMaxFloor-1];t++)this.selectTypeGroup(!0,this.currentDeckMaxFloor,this.currentDeckMaxCard-t-1,b.Silver,b.AtkWeapon,b.DefWeapon,b.Treasure);for(let e=2;e<this.currentDeckMaxFloor-1;e++){let a=this.currentDeckFloorArr[e];for(let i=0;i<a;i++){let i=!1;1==a&&(i=this.selectTypeGroup(!1,e+1,t,b.EliteEnemy,b.NormalEnemy,b.Box,b.Store,b.Treasure)),i||this.selectTypeGroup(!1,e+1,t,b.Silver,b.Camp,b.AtkWeapon,b.DefWeapon,b.Treasure,b.Box,b.EliteEnemy,b.NormalEnemy,b.Store),t++}}this.currentGroupData=this.deckGroupData,a.log("setPartition:",this.startGroupData,this.deckGroupData,this.currentDetail.arr,this.currentGroupData)}adjustFloorArr(t,e,a,i){if(this.currentDeckFloorArr[e]!=t)for(let r=a;r<this.currentDeckFloorArr.length-i;r++){if(this.currentDeckFloorArr[r]==t){z.exchange(this.currentDeckFloorArr,r,e);break}}}addStartProbabilityChain(t,e,a,i){let r=t[z.randomOneByTradition(e)],s=new Bt(a[r],0,i);this.startGroupData.addGroup(s)}addStartEventChain(t,e,a,i){let r=0;null!=e&&e.length>0&&(r=z.randInt(e[1],e[2]));let s=new Bt(a[t],r,i);this.startGroupData.addGroup(s)}selectTypeGroup(t,e,a,...i){let r=[],s=[],o=[];i.contains(b.Boss)&&(r.push(this.currentDetail.arr.contains(b[b.Boss])),s.push(g.Enemy),o.push(b.Boss)),i.contains(b.Store)&&(r.push(this.currentDetail.arr.contains(b[b.Store])),s.push(g.Store),o.push(b.Store)),i.contains(b.Silver)&&(r.push(this.currentDetail.arr.contains(b[b.Silver])),s.push(g.Silver),o.push(b.Silver)),i.contains(b.AtkWeapon)&&(r.push(this.currentDetail.arr.contains(b[b.AtkWeapon])),s.push(g.Weapon),o.push(b.AtkWeapon)),i.contains(b.DefWeapon)&&(r.push(this.currentDetail.arr.contains(b[b.DefWeapon])),s.push(g.Weapon),o.push(b.DefWeapon)),i.contains(b.Treasure)&&(r.push(this.currentDetail.arr.contains(b[b.Treasure])),s.push(g.Treasure),o.push(b.Treasure)),i.contains(b.NormalEnemy)&&(r.push(this.currentDetail.arr.contains(b[b.NormalEnemy])),s.push(g.Enemy),o.push(b.NormalEnemy)),i.contains(b.EliteEnemy)&&(r.push(this.currentDetail.arr.contains(b[b.EliteEnemy])),s.push(g.Enemy),o.push(b.EliteEnemy)),i.contains(b.Camp)&&(r.push(this.currentDetail.arr.contains(b[b.Camp])),s.push(g.Camp),o.push(b.Camp)),i.contains(b.Box)&&(r.push(this.currentDetail.arr.contains(b[b.Box])),s.push(g.Box),o.push(b.Box)),i.contains(b.Next)&&(r.push(this.currentDetail.arr.contains(b[b.Next])),s.push(g.Next),o.push(b.Next));let n=-1;if(r.contains(!0))do{n=z.randInt(0,r.length-1)}while(!r[n]);return-1!=n&&(this.spliteTypeGroup(t,e,a,s[n],o[n]),!0)}spliteTypeGroup(t,e,a,i,r){if(t){for(let t=this.startGroupData.cardList.length-1;t>=0;t--)if(this.startGroupData.cardList[t].data.cardType==g[i]&&this.startGroupData.cardList[t].data.cardOrder==r){this.setSpChain(t,e,a);break}}else for(let t=0;t<this.startGroupData.cardList.length;t++)if(this.startGroupData.cardList[t].data.cardType==g[i]&&this.startGroupData.cardList[t].data.cardOrder==r){this.setSpChain(t,e,a);break}}setSpChain(t,e,a){let i=this.startGroupData.cardList.splice(t,1)[0];this.currentDetail.arr.contains(b[i.data.cardOrder])&&this.currentDetail.arr.splice(this.currentDetail.arr.indexOf(b[i.data.cardOrder]),1),i.data.setFloor(e),i.data.cardOrder!=b.Boss&&i.data.cardOrder!=b.EliteEnemy&&i.data.cardOrder!=b.Store&&i.data.cardOrder!=b.Box||(this.currentFloorSign[e]?this.currentFloorSign[e].arr.push(i.data.cardOrder):this.currentFloorSign[e]={arr:[i.data.cardOrder]}),this.deckGroupData.cardList[a]=i}startRenderCard(){a.log("startRenderCard:",this.deckGroupData,this.currentDeckMaxFloor);let t=[];for(let e=0;e<this.currentDeckMaxFloor;e++)t.push(0);let e=[],i=0,r=(this.currentDeckFloorArr[this.currentDeckMaxFloor-1]||0)+(this.currentDeckFloorArr[this.currentDeckMaxFloor-2]||0)+(this.currentDeckFloorArr[this.currentDeckMaxFloor-3]||0);for(let a=this.deckGroupData.cardList.length-1;a>=0;a--){let s=this.deckGroupData.cardList[a];if(s.data.cardFloor==this.currentDeckMaxFloor){let a=this.checkNewPos(t,this.currentDeckMaxFloor-1,this.cardParent.cardTemp2,this.cardParent.cardTemp1,this.cardParent.cardTemp3);a.length>0&&s.createRender(a).then(()=>{e.push({floor:this.currentDeckMaxFloor,x:a[0],y:this.cardParent.cardTemp2.y,entity:s.render.entity}),++i==r&&this.startCardSorting(e)})}else if(s.data.cardFloor==this.currentDeckMaxFloor-1){let a=this.checkNewPos(t,this.currentDeckMaxFloor-2,this.cardParent.cardTemp4,this.cardParent.cardTemp6,this.cardParent.cardTemp7);a.length>0&&s.createRender(a).then(()=>{e.push({floor:this.currentDeckMaxFloor-1,x:a[0],y:this.cardParent.cardTemp4.y,entity:s.render.entity}),++i==r&&this.startCardSorting(e)})}else if(s.data.cardFloor==this.currentDeckMaxFloor-2){let a=this.checkNewPos(t,this.currentDeckMaxFloor-3,this.cardParent.cardTemp5,this.cardParent.cardTemp8,this.cardParent.cardTemp9);a.length>0&&s.createRender(a).then(()=>{e.push({floor:this.currentDeckMaxFloor-2,x:a[0],y:this.cardParent.cardTemp5.y,entity:s.render.entity}),++i==r&&this.startCardSorting(e)})}}}onceRenderCard(t){let e=[0],a=0,i=this.currentFloorArr[t-1]||0;for(let r=this.currentGroupData.cardList.length-1;r>=0;r--){let s=this.currentGroupData.cardList[r];if(s.data.cardFloor==t){let r=!1,o=!1,n=!1;this.isIntoSub&&this.typeIntoSub==g[g.Store]&&(r=!0,n=!0,o=t%2!=0);let h=this.checkNewPos(e,0,this.cardParent.cardTemp5,this.cardParent.cardTemp8,this.cardParent.cardTemp9,r,o);h.length>0&&s.createRender(h).then(()=>{n&&s.render.refreshPriceUI(),a++,this.cardFalling(0,s.render.entity,s.render.x,this.cardParent.cardTemp5.y).then(()=>{a==i&&this.flushGroupClick()})})}}}checkNewPos(t,e,a,i,r,s=!1,o=!1){let n=[];if(0==t[e])t[e]=1,n=[a.x,a.y];else if(1==t[e]){let a=1*Math.random();s&&(a=o?0:1),a<.5?(t[e]=-2,n=[i.x,i.y]):(t[e]=2,n=[r.x,r.y])}else-2==t[e]?(t[e]=3,n=[r.x,r.y]):2==t[e]&&(t[e]=3,n=[i.x,i.y]);return[n[0],n[1]-400]}flushGroupClick(){for(let t=0;t<this.currentGroupData.cardList.length;t++)if(this.currentGroupData.cardList[t].render){let e=this.currentGroupData.cardList[t].render.entity;e.offAll(),e.on(Laya.Event.MOUSE_OVER,this,this.OnMouseOver,[!1,t]),e.on(Laya.Event.MOUSE_OUT,this,this.OnMouseOut,[!1,t]),e.on(Laya.Event.MOUSE_DOWN,this,this.OnMounseDown,[!1,t]),e.on(Laya.Event.MOUSE_MOVE,this,this.OnMounseMove,[!1,t]),e.on(Laya.Event.MOUSE_UP,this,this.OnMounseUp,[!1,t])}for(let t=0;t<this.playerGroupData.cardList.length;t++)if(this.playerGroupData.cardList[t].render){let e=this.playerGroupData.cardList[t].render.entity;e.offAll(),e.on(Laya.Event.MOUSE_OVER,this,this.OnMouseOver,[!0,t]),e.on(Laya.Event.MOUSE_OUT,this,this.OnMouseOut,[!0,t]),e.on(Laya.Event.MOUSE_DOWN,this,this.OnMounseDown,[!0,t]),e.on(Laya.Event.MOUSE_MOVE,this,this.OnMounseMove,[!0,t]),e.on(Laya.Event.MOUSE_UP,this,this.OnMounseUp,[!0,t])}}OnMounseDown(t,e,i){this.banClick||(this.selectGroup=t?this.playerGroupData.cardList[e]:this.currentGroupData.cardList[e],this.isStartDraging=!0,this.isStartDragMoved=!1,this.mouseStartPos.x=i.stageX,this.mouseStartPos.y=i.stageY,this.nowTimeDown=(new Date).getTime(),Laya.timer.once(500,this,this.OnLongDown),a.log("OnMounseDown:",this.selectGroup.render.y,this.cardParent.cardTemp2.y,this.cardParent.cardTemp10.y),this.selectGroup.render.y==this.cardParent.cardTemp2.y||this.selectGroup.render.y==this.cardParent.cardTemp10.y?this.selectGroup.render.showSeleteLine(!0):this.selectGroup.render.showShadow(!0,2,3))}OnMounseMove(t,e,i){if(a.log("OnMounseMove",e),this.banClick)return;if(!this.isStartDraging)return;let r=i.stageX,s=i.stageY;var o=r-this.mouseStartPos.x,n=s-this.mouseStartPos.y;this.isStartDragMoved||new Laya.Point(o,n).distance(0,0)>20&&(this.isStartDragMoved=!0)}OnMounseUp(t,e,i){this.banClick||this.isStartDraging&&(this.isStartDragMoved?a.log("移动完毕"):(a.log("点击完毕"),t||!this.selectGroup||!this.selectGroup.render||this.selectGroup.render.y!=this.cardParent.cardTemp2.y&&this.selectGroup.render.y!=this.cardParent.cardTemp10.y||(this.currentGroupData.cardList[e].data.cardLock||this.isIntoSub&&this.typeIntoSub==g[g.Store]&&-1!=this.selectGroup.data.cardPrice&&this.silver<this.selectGroup.data.cardPrice?(this.selectGroup.render.showSeleteLine(!1),this.currentGroupData.cardList[e].data.cardLock||Pt.instance.showTips("小星星不足")):this.dealCardEvent(this.playerGroupData.cardList[0],this.currentGroupData.cardList[e]))),this.OnFreed())}OnShowHeroWeapon(){ke.instance.layerDialog.onDialogWeaponShow(this.playerGroupData.cardList[0])}OnShowEnemyOrAnimalWeapon(t){ke.instance.layerDialog.onDialogMessageShow(t)}OnLongDown(){this.banClick||this.isStartDraging&&0!=this.nowTimeDown&&(new Date).getTime()-this.nowTimeDown>=500&&0!=this.nowTimeDown&&(a.log("长按完毕"),this.selectGroup&&this.selectGroup.render.showSeleteLine(!1),this.OnFreed())}OnFreed(){this.banClick||this.selectGroup&&(this.selectGroup.render&&this.selectGroup.render.y!=this.cardParent.cardTemp2.y&&this.selectGroup.render.y!=this.cardParent.cardTemp10.y&&this.selectGroup.render.showShadow(!1,0,0),this.isStartDraging=!1,this.isStartDragMoved=!1,this.nowTimeDown=0,this.selectGroup=null)}OnMouseOver(t,e,i){a.log("OnMouseOver",i.target);let r=t?this.playerGroupData.cardList[e]:this.currentGroupData.cardList[e];Ht.instance.onShow(!0,r)}OnMouseOut(t,e,i){a.log("OnMouseOut"),Ht.instance.onShow(!1,null)}startCardSorting(t){t.sort((t,e)=>t.floor!==e.floor?e.floor-t.floor:t.x-e.x),a.log("currentRender:",t,this.deckGroupData,this.subGroupData);for(let e=0;e<t.length;e++){let a=t[e];this.cardFalling(50*e,a.entity,a.x,a.y).then(()=>{e==t.length-1&&(this.banClick=!1,this.flushGroupClick())})}}cardFalling(t,e,a,i){return new Promise(r=>{Laya.timer.once(t,this,()=>{Laya.Tween.to(e,{x:a,y:i},600,Laya.Ease.sineOut,new Laya.Handler(this,()=>{r()}))})})}dealCardEvent(t,e){switch(this.isIntoSub&&this.typeIntoSub==g[g.Store]&&-1!=this.selectGroup.data.cardPrice&&this.silver>=this.selectGroup.data.cardPrice&&(this.silver-=this.selectGroup.data.cardPrice,D.event(r.RefreshSilver,this.silver)),e.data.cardType){case g[g.Hero]:break;case g[g.Enemy]:case g[g.Animal]:e.data.vrEnemy.IsBreak?this.playerMove(t,e).then(()=>{this.currentBattleData&&this.currentBattleData.Silver?this.silver+=z.randInt(this.currentBattleData.Silver[0],this.currentBattleData.Silver[1]):this.silver=0,D.event(r.RefreshSilver,this.silver);let a=this.checkRaid(t);this.missingCard(!0,a,t,e)}):this.playerBattle(t,e);break;case g[g.Silver]:this.playerMove(t,e).then(()=>{this.silver+=e.data.cardValue,D.event(r.RefreshSilver,this.silver);let a=this.checkRaid(t);this.missingCard(!0,a,t,e)});break;case g[g.Camp]:this.playerMove(t,e).then(()=>{t.data.vrHero.battleSkillComponents.restoreBlood(e.data.cardValue),t.flushRender();let a=this.checkRaid(t);this.missingCard(!0,a,t,e)});break;case g[g.Weapon]:this.playerMove(t,e).then(()=>{t.data.vrHero.setNewWeapon(e.data.vrWeapon.dataID),t.flushRender(),D.event(r.RefreshWeapon,[!0]);let a=this.checkRaid(t);this.missingCard(!0,a,t,e)});break;case g[g.Treasure]:this.playerMove(t,e).then(()=>{t.data.vrHero.setTreasures(e.data.cardID),t.flushRender();let a=this.checkRaid(t);this.missingCard(!0,a,t,e),Ot.instance.refresh()});break;case g[g.Road]:this.playerMove(t,e).then(()=>{let a=this.checkRaid(t);this.missingCard(!0,a,t,e)});break;case g[g.Back]:this.playerBack(t,e);break;case g[g.Box]:case g[g.Hole]:case g[g.Store]:this.playerInto(t,e);break;case g[g.Next]:this.playerNext(t,e)}}playerMove(t,e){this.banClick=!0;let r=50*Math.floor(Math.abs(e.render.x-t.render.x)/(160*t.render.entity.scaleX)),s=300+(r=i.Clamp(r,0,100));a.log("playerMoveTime:",s,r);let o=z.randInt(30*t.render.entity.scaleY,50*t.render.entity.scaleY);return t.render.showMoveReady(!0,s),new Promise(a=>{Laya.Tween.to(t.render.entity,{x:e.render.x,y:e.render.y+o},s,Laya.Ease.circOut,new Laya.Handler(this,()=>{Laya.timer.once(Math.floor(s/3),this,()=>{t.render.showMoveReady(!1,Math.floor(s/2)),Laya.Tween.to(t.render.entity,{x:e.render.x,y:e.render.y},Math.floor(s/2),Laya.Ease.circIn,new Laya.Handler(this,()=>{this.addBatterPoint(!1),a()}))})}))})}checkRaid(t){let e=t.render.x,i=this.cardParent.cardTemp4.y;for(let t=0;t<this.currentGroupData.cardList.length;t++){let r=this.currentGroupData.cardList[t];if(r.render&&this.currentFloor-2>=0&&r.data.cardFloor==this.currentFloor-2&&r.render.x==e&&r.render.y==i&&(r.data.cardType==g[g.Enemy]||r.data.cardType==g[g.Animal]))return a.log("存在敌人"),r}return null}missingCard(t,e,i,r){if(t&&(this.currentGroupData.cardList.remove(r),r.dispose(),Ht.instance.onShow(!1,null)),e)if(i.data.vrHero.IsFightback){let t=i.data.vrHero.battleSkillComponents.selectSkill(ht.DefAttack);i.data.vrHero.battleSkillComponents.filling(t,0);let r=e.data.vrEnemy.battleSkillComponents.beHit(t);a.log("senderskill:",t,r),this.battleAnim3(i,e,r,!1).then(()=>{this.addFightbackPoint([],null,0),i.data.vrHero.setFightback(!1),i.flushRender(),e.flushRender(),this.checkEnemyDead(!0,i,e),this.fallingCreater(null,i)})}else{let t=e.data.vrEnemy.battleSkillComponents.selectSkill(ht.Charge);e.data.vrEnemy.battleSkillComponents.filling(t);let r=i.data.vrHero.battleSkillComponents.beHit(t);a.log("senderskill:",t,r);let s=!!t.skillType.contains(nt.Boom);this.battleAnim2(e,i,r,s).then(t=>{t?this.boomEnemyDead(e).then(()=>{i.flushRender(),i.data.vrHero.currentHp<=0?this.playerDeath():this.fallingCreater(null,i)}):(e.flushRender(),i.flushRender(),i.data.vrHero.currentHp<=0?this.playerDeath():this.fallingCreater(null,i))})}else this.fallingCreater(null,i)}fallingCreater(t,e){this.currentFloor--,a.log("fff:",this.currentFloorArr.length+1-this.currentFloor,this.currentFloorArr.length),this.currentFloorArr.length>1&&D.event(r.RefreshBattleBar,[this.isIntoSub,this.currentFloorArr.length+1-this.currentFloor,this.currentFloorArr.length]),this.cardFalling(0,e.render.entity,e.render.x,this.cardParent.heroTemp1.y).then(()=>{if(t)if(e.data.vrHero.IsFightback){let i=e.data.vrHero.battleSkillComponents.selectSkill(ht.DefAttack);e.data.vrHero.battleSkillComponents.filling(i,0);let r=t.data.vrEnemy.battleSkillComponents.beHit(i);a.log("senderskill:",i,r),this.battleAnim3(e,t,r,!1).then(()=>{this.addFightbackPoint([],null,0),e.data.vrHero.setFightback(!1),e.flushRender(),t.flushRender(),this.checkEnemyDead(!0,e,t),this.banClick=!1})}else{let i=t.data.vrEnemy.battleSkillComponents.selectSkill(ht.Charge);t.data.vrEnemy.battleSkillComponents.filling(i);let r=e.data.vrHero.battleSkillComponents.beHit(i);a.log("senderskill:",i,r);let s=!!i.skillType.contains(nt.Boom);this.battleAnim2(t,e,r,s).then(a=>{a?(this.boomEnemyDead(t),e.flushRender(),e.data.vrHero.currentHp<=0?this.playerDeath():this.banClick=!1):(t.flushRender(),e.flushRender(),e.data.vrHero.currentHp<=0?this.playerDeath():this.banClick=!1)})}else this.banClick=!1});for(let t=0;t<this.currentGroupData.cardList.length;t++)if(this.currentGroupData.cardList[t].render){let i=this.currentGroupData.cardList[t],r=i.render.y+(this.cardParent.cardTemp1.centerY-this.cardParent.cardTemp6.centerY);a.log("Mat1",!this.isIntoSub,i.render.y,r,Math.abs(e.render.x-i.render.x)>=160*e.render.entity.scaleX*2),this.currentGroupData.cardList[t].data.cardFloor==this.currentFloor?(this.currentGroupData.cardList.splice(t--,1),i.render.showHide(600,r).then(()=>{i.dispose()})):(a.log("Mat2",!this.isIntoSub,i.render.y,this.cardParent.cardTemp6.y,Math.abs(e.render.x-i.render.x)>=160*e.render.entity.scaleX*2),!this.isIntoSub&&i.render.y==this.cardParent.cardTemp6.y&&Math.abs(e.render.x-i.render.x)>=160*e.render.entity.scaleX*2&&(i.data.setLock(!0),i.render.refreshLockUI()),this.cardFalling(0,i.render.entity,i.render.x,r))}this.onceRenderCard(this.currentFloor-3)}playerBattle(t,e){let i=t.data.vrHero.battleSkillComponents.selectSkill(ht.Normal),s=i.cost;t.data.vrHero.battleSkillComponents.filling(i);let o=e.data.vrEnemy.battleSkillComponents.beHit(i);a.log("senderskill:",i,o,s),this.battleAnim1(t,e,o).then(()=>{if(o.findIndex(t=>"MISS"!=t)>=0){this.addFightbackPoint(o,t);let e=t.data.vrHero.costDurability(s,!1);D.event(r.RefreshWeapon,[e]),e?t.render.refreshWeaponUI(!0):t.render.refreshWeaponUI(!1,!0)}t.flushRender(),e.flushRender(),this.checkEnemyDead(!1,t,e)})}battleAnim1(t,e,r){this.banClick=!0;let s=e.render.height/2,o=t.render.x-e.render.x==0?0:t.render.x-e.render.x>0?e.render.width/2:-e.render.width/2,n=20*Math.floor(Math.abs(t.render.x-e.render.x)/(160*t.render.entity.scaleX)),h=300+(n=i.Clamp(n,0,40)),l=z.getAngle2(t.render.x,t.render.y,e.render.x,e.render.y),c=z.PolarToCartesian(l,150),p=0;p=this.currentBattleType==d[d.Animal]||this.currentBattleType==d[d.Enemy]?this.cardParent.heroTemp4.y:this.cardParent.heroTemp1.y;let f=[t.render.x,p];return e.data.vrEnemy.currentHp<=0&&(f[0]=e.render.x),a.log("battleAnim1:",l,c,t.data.cardFloor,this.currentFloor),new Promise(i=>{t.render.showScale(!0,1.1,h),t.render.showRotation(!0,l+90,h),t.render.showTrailAni(h),Laya.Tween.to(t.render.entity,{x:t.render.x-c.x,y:t.render.y-c.y},h,Laya.Ease.quadOut,new Laya.Handler(this,()=>{Laya.timer.once(Math.floor(h/4),this,()=>{t.render.showScale(!1,1,Math.floor(1*h/2)),Laya.Tween.to(t.render.entity,{x:e.render.x+o,y:e.render.y+s},Math.floor(1*h/2),Laya.Ease.backOut,new Laya.Handler(this,()=>{if(ke.instance.layerEffect.sceneGame.createAttack1([e.render.x+e.render.width/2,e.render.y+e.render.height/2]),r.findIndex(t=>t.indexOf("Weak")>=0)>=0){for(let t=0;t<r.length;t++){let e=r[t];r[t]=e.substring(0,e.length-4)}a.log("vvv:",r),e.data.vrEnemy.weakExposed(t.data.vrHero.getAtkWeapon().attributes)&&e.render.refreshWeakUI(!0)}Et.instance.showMoreTips(r.length,r,e.render.x+e.render.width/2,e.render.y+e.render.height/2,100),t.render.hideTrailAni(h),t.render.showRotation(!1,0,Math.floor(3*h/2)),Laya.Tween.to(t.render.entity,{x:f[0],y:f[1]},Math.floor(3*h/2),Laya.Ease.linearIn,new Laya.Handler(this,()=>{i()}))}))})}))})}fightBackAnim(t,e){if(e.data.vrHero.IsFightback){let i=e.data.vrHero.battleSkillComponents.selectSkill(ht.DefAttack);e.data.vrHero.battleSkillComponents.filling(i,0);let r=t.data.vrEnemy.battleSkillComponents.beHit(i);a.log("senderskill:",i,r),this.battleAnim3(e,t,r,!0).then(()=>{this.addFightbackPoint([],null,0),e.data.vrHero.setFightback(!1),t.flushRender(),e.flushRender(),this.checkEnemyDead(!0,e,t)})}else{let i=350,r=t.data.vrEnemy.battleSkillComponents.selectSkill(ht.Normal);t.data.vrEnemy.battleSkillComponents.filling(r);let s=e.data.vrHero.battleSkillComponents.beHit(r);a.log("fightBackAnim:",r,s),t.render.showExclamation(!0,i).then(()=>{t.flushRender(),e.flushRender(),e.data.vrHero.currentHp<=0&&this.playerDeath(),ke.instance.layerEffect.sceneGame.createAttack2([e.render.x+e.render.width/2,e.render.y+e.render.height/2]),Et.instance.showMoreTips(s.length,s,e.render.x+e.render.width/2,e.render.y+e.render.height/2,200),Laya.timer.once(i,this,()=>{this.banClick=!1,this.addBatterPoint(!0),t.render.showSeleteLine(!1)})})}}battleAnim2(t,e,i,r){this.banClick=!0;let s=t.render.height/2,o=0;o=this.currentBattleType==d[d.Animal]||this.currentBattleType==d[d.Enemy]?this.cardParent.cardTemp10.y:this.currentFloor-t.data.cardFloor==2?this.cardParent.cardTemp6.y:this.cardParent.cardTemp1.y;let n=[t.render.x,o];return a.log("battleAnim2:",t.data.cardFloor,this.currentFloor),new Promise(a=>{t.render.showExclamation(!1,350).then(()=>{t.render.showScale(!0,1.1,300),Laya.Tween.to(t.render.entity,{x:e.render.x,y:e.render.y-s},300,Laya.Ease.circOut,new Laya.Handler(this,()=>{Laya.timer.once(100,this,()=>{r?ke.instance.layerEffect.sceneGame.createBallBoom([e.render.x+e.render.width/2,e.render.y+e.render.height/2]):ke.instance.layerEffect.sceneGame.createAttack2([e.render.x+e.render.width/2,e.render.y+e.render.height/2]),Et.instance.showMoreTips(i.length,i,e.render.x+e.render.width/2,e.render.y+e.render.height/2,200),Laya.Tween.to(t.render.entity,{alpha:0,y:e.render.y},200,Laya.Ease.quadOut,new Laya.Handler(this,()=>{t.render.showScale(!1,1,200),t.render.showRotation(!1,0,200),t.render.setXY(n[0],n[1]),r?Laya.timer.once(200,this,()=>{this.addBatterPoint(!0),a(!0)}):Laya.Tween.to(t.render.entity,{alpha:1},Math.floor(100),Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addBatterPoint(!0),a(!1)}))}))})}))})})}battleAnim3(t,e,a,i){this.banClick=!0;return new Promise(r=>{e.render.showExclamation(i,350).then(()=>{t.render.showFightback(200).then(()=>{ke.instance.layerEffect.sceneGame.createAttack1([e.render.x+e.render.width/2,e.render.y+e.render.height/2]),Et.instance.showMoreTips(a.length,a,e.render.x+e.render.width/2,e.render.y+e.render.height/2,100,"#a9d9d5"),Laya.timer.once(200,this,()=>{r()})})})})}addBatterPoint(t,e=-1){if(-1!=e)this.batter=e;else if(t){let t=this.playerGroupData.cardList[0].data.vrHero.currentHp,e=this.playerGroupData.cardList[0].data.vrHero.FinalCompleteHp;this.batter+=t>=.7*e?1:t>=.4*e&&t<.7*e?z.randInt(1,2):t>=.1*e&&t<.4*e?z.randInt(1,3):z.randInt(1,4)}else this.batter+=1;this.batter>=A.maxBatterPoint&&(this.batter=A.maxBatterPoint),D.event(r.RefreshBatter,[this.batter,A.maxBatterPoint])}addFightbackPoint(t,e,a=-1,i=-1){let s=A.maxFightbackPoint;if(-1!=a)this.fightback=a;else{if(this.fightback==s)return;let a=0;t.forEach(t=>{"MISS"==t||a++}),this.fightback+=a,this.fightback>=s&&(this.fightback=s,e.data.vrHero.setFightback(!0))}D.event(r.RefreshFightback,[this.fightback,s])}checkEnemyDead(t,e,a){if(a.data.vrEnemy.currentHp<=0){let i=a.data.cardOrder;if(this.currentBattleData&&this.currentBattleData.Silver?this.silver+=z.randInt(this.currentBattleData.Silver[0],this.currentBattleData.Silver[1]):this.silver=0,D.event(r.RefreshSilver,this.silver),t){let t=a.data.cardFloor,e=[a.render.x,a.render.y];this.currentGroupData.cardList.remove(a),a.dispose(),Ht.instance.onShow(!1,null);let i=z.randInt(1,100),r=null;r=A.holeShowRand>=i?this.battleCardRes[20009]:this.battleCardRes[20008];let s=new Bt(r,0,-1);s.data.setFloor(t),s.createRender(e,!0).then(()=>{this.currentGroupData.addGroup(s),this.flushGroupClick()})}else{let t=this.checkRaid(e);this.fallingCreater(t,e)}i==b.Boss&&this.bossDeath()}else a.data.vrEnemy.IsDizzy?(a.data.vrEnemy.turnDizzy--,a.data.vrEnemy.turnDizzy<=0&&(a.render.hideBreak(350),a.data.vrEnemy.restoreShield(),a.data.vrEnemy.IsDizzy=!1,a.data.vrEnemy.turnDizzy=0,a.flushRender()),this.banClick=!1,a.render.showSeleteLine(!1),this.addBatterPoint(!0)):0==a.data.vrEnemy.FinalShield?(a.data.cardOrder==b.Boss?(a.data.vrEnemy.IsDizzy=!0,a.data.vrEnemy.turnDizzy=A.turnDizzy):a.data.vrEnemy.IsBreak=!0,a.render.showBreak(a.data.cardOrder==b.Boss,500).then(()=>{this.banClick=!1,a.render.showSeleteLine(!1)})):!t&&a.data.vrEnemy.IsFightback?this.fightBackAnim(a,e):(this.banClick=!1,a.render.showSeleteLine(!1))}boomEnemyDead(t){return new Promise(e=>{this.currentBattleData&&this.currentBattleData.Silver?this.silver+=z.randInt(this.currentBattleData.Silver[0],this.currentBattleData.Silver[1]):this.silver=0,D.event(r.RefreshSilver,this.silver);let a=t.data.cardFloor,i=[t.render.x,t.render.y];this.currentGroupData.cardList.remove(t),t.dispose(),Ht.instance.onShow(!1,null);let s=z.randInt(1,100),o=null;o=A.holeShowRand>=s?this.battleCardRes[20009]:this.battleCardRes[20008];let n=new Bt(o,0,-1);n.data.setFloor(a),n.createRender(i,!0).then(()=>{this.currentGroupData.addGroup(n),this.flushGroupClick(),e()})})}castSkill(t,e){let a=this.playerGroupData.cardList[0],i=a.render.x,r=!1;for(let s=0;s<this.currentGroupData.cardList.length;s++){let o=this.currentGroupData.cardList[s];if(o.render)switch(t.skillTarget){case lt.AboveEnmey:this.currentFloor-1>=0&&o.data.cardFloor==this.currentFloor-1&&(o.data.cardType==g[g.Enemy]||o.data.cardType==g[g.Animal])&&(this._castSkill(t,a,o,e),r=!0);break;case lt.VisionEnemy:let s=3;this.currentFloor-s<0&&(s=this.currentFloor),this.currentFloor-1>=0&&this.currentFloor-s>=0&&o.data.cardFloor<=this.currentFloor-1&&o.data.cardFloor>=this.currentFloor-s&&(o.data.cardType==g[g.Enemy]||o.data.cardType==g[g.Animal])&&(this._castSkill(t,a,o,e),r=!0);break;case lt.That:this.currentFloor-1>=0&&o.data.cardFloor==this.currentFloor-1&&o.render.x==i&&(o.data.cardType==g[g.Enemy]||o.data.cardType==g[g.Animal])&&(this._castSkill(t,a,o,e),r=!0)}}r||Pt.instance.showTips("技能范围内没有目标")}_castSkill(t,e,i,s){e.data.vrHero.battleSkillComponents.filling(t,s),this.addFightbackPoint(["1"],e);let o=e.data.vrHero.costDurability(t.cost,-1==t.cost);D.event(r.RefreshWeapon,[o]),o?e.render.refreshWeaponUI(!0):e.render.refreshWeaponUI(!1,!0),a.log("技能目标",t.skillType,t.cost);let n=i.data.vrEnemy.battleSkillComponents.beHit(t);if(t.skillType.contains(nt.Damage)){if(ke.instance.layerEffect.sceneGame.createAttack1([i.render.x+i.render.width/2,i.render.y+i.render.height/2]),n.findIndex(t=>t.indexOf("Weak")>=0)>=0){for(let t=0;t<n.length;t++){let e=n[t];n[t]=e.substring(0,e.length-4)}i.data.vrEnemy.weakExposed(t.skillAttr)&&i.render.refreshWeakUI(!0)}Et.instance.showMoreTips(n.length,n,i.render.x+i.render.width/2,i.render.y+i.render.height/2,100),i.flushRender(),this.checkEnemyDead(!0,e,i)}t.skillType.contains(nt.ExposedWeak)&&(i.render.refreshWeakUI(!0),i.flushRender(),this.checkEnemyDead(!0,e,i)),t.skillType.contains(nt.Rand1)&&(a.log("rand1"),ke.instance.layerDialog.onDialogRandNumber({player:e,item:i}))}playerNext(t,e){this.playerMove(t,e).then(()=>{this.designPlace(t,e.data.cardValue),this.cardFalling(0,t.render.entity,this.cardParent.heroTemp1.x,this.cardParent.heroTemp1.y)})}playerBack(t,e){this.playerMove(t,e).then(()=>{this.isIntoSub=!1,this.typeIntoSub="",this.currentGroupData=this.deckGroupData,this.currentFloorArr=this.currentDeckFloorArr,t.data.setFloor(this.currentDeckFloor),this.currentFloor=this.currentDeckFloor,this.subGroupData.dispose(!1);for(let t=0;t<this.deckGroupData.cardList.length;t++){let e=this.deckGroupData.cardList[t];e.render&&(e.render.entity.visible=!0)}let a=300*Math.floor(Math.abs(this.savePlayerXBeforeIntoSub-t.render.x)/(160*t.render.entity.scaleX));Laya.Tween.to(t.render.entity,{x:this.savePlayerXBeforeIntoSub},a,Laya.Ease.sineOut,new Laya.Handler(this,()=>{let a=this.checkRaid(t);this.missingCard(!1,a,t,e)})),D.event(r.RefreshBattleBar,[!1,this.currentFloorArr.length-this.currentFloor,this.currentFloorArr.length]),D.event(r.RefreshBattleBarSign,[!1,this.currentFloorArr.length,this.currentFloorSign]),Mt.instance.showBroadcastBanner(this.currentBattleData.DetailName[this.currentBranch]).then(()=>{D.event(r.RefreshBattleTitle,this.currentBattleData.DetailName[this.currentBranch])})})}playerInto(t,e){this.playerMove(t,e).then(()=>{this.isIntoSub=!0,this.typeIntoSub=e.data.cardType;let a=e.data.cardFloor,i=e.data.cardName;this.createSubGroupData();for(let t=0;t<this.deckGroupData.cardList.length;t++){let e=this.deckGroupData.cardList[t];e.render&&(e.render.entity.visible=!1,e.data.cardFloor==a&&(this.deckGroupData.cardList.splice(t--,1),e.dispose()))}this.subRenderCard(),this.savePlayerXBeforeIntoSub=t.render.x,this.cardFalling(0,t.render.entity,this.cardParent.heroTemp1.x,this.cardParent.heroTemp1.y),this.currentDeckFloor=this.currentFloor,this.currentFloorArr=this.currentSubFloorArr,this.currentSubFloor=this.currentSubMaxFloor+1,t.data.setFloor(this.currentSubFloor),this.currentFloor=this.currentSubFloor,D.event(r.RefreshBattleBar,[!0,0,this.currentFloorArr.length]),D.event(r.RefreshBattleBarSign,[!0,0,null]),Mt.instance.showBroadcastBanner(i).then(()=>{D.event(r.RefreshBattleTitle,i)})})}createSubGroupData(){if(this.subGroupData.dispose(!1),this.isIntoSub&&this.typeIntoSub==g[g.Box])this.currentSubMaxCard=4,this.currentSubMaxFloor=2,this.currentSubFloorArr=[1,3],this.addSubEventChain(20010,null,this.battleCardRes,-1,1),this.addSubProbabilityChain(this.currentBattleData.Treasure,this.currentBattleData.TreasureProbability,this.currentSubMaxCard-1,!1,2);else if(this.isIntoSub&&this.typeIntoSub==g[g.Hole])this.currentSubMaxCard=4,this.currentSubMaxFloor=2,this.currentSubFloorArr=[1,3],this.addSubEventChain(20010,null,this.battleCardRes,-1,1),this.addSubProbabilityChain(this.currentBattleData.Treasure,this.currentBattleData.TreasureProbability,this.currentSubMaxCard-1,!1,2);else if(this.isIntoSub&&this.typeIntoSub==g[g.Store]){this.currentSubMaxCard=9,this.currentSubMaxFloor=5,this.currentSubFloorArr=[1,2,2,2,2];for(let t=0;t<this.currentSubMaxCard;t++)0==t?this.addSubEventChain(20010,null,this.battleCardRes,-1,1):t%2==0?this.addSubEventChain(20008,null,this.battleCardRes,-1,Math.floor((t+1)/2)+1):this.addSubProbabilityChain(this.currentBattleData.Store,this.currentBattleData.StoreProbability,1,!1,Math.floor((t+1)/2)+1)}this.currentGroupData=this.subGroupData,a.log("createSubGroupData:",this.subGroupData,this.currentGroupData)}addSubProbabilityChain(t,e,a,i,r){if(1==a){let a=t[z.randomOneByTradition(e)],i=null,s=null;a>2e4?(i=this.battleTreasureRes[a],s=b.Treasure):s=0==(i=this.battleWeaponRes[a]).Atk?b.DefWeapon:b.AtkWeapon;let o=new Bt(i,0,s);o.data.setFloor(r),this.subGroupData.addGroup(o)}else{let s=[];s=i?z.randomSomeByTradition(e,a,i):z.randomSomeByOriginalSort(e,a);for(let e=0;e<a;e++){let a=t[i?s[e]:s[e].originIdx],o=null,n=null;a>2e4?(o=this.battleTreasureRes[a],n=b.Treasure):n=0==(o=this.battleWeaponRes[a]).Atk?b.DefWeapon:b.AtkWeapon;let h=new Bt(o,0,n);h.data.setFloor(r),this.subGroupData.addGroup(h)}}}addSubEventChain(t,e,a,i,r){let s=0;null!=e&&e.length>0&&(s=z.randInt(e[1],e[2]));let o=new Bt(a[t],s,i);o.data.setFloor(r),this.subGroupData.addGroup(o)}subRenderCard(){let t=[];for(let e=0;e<this.currentSubMaxFloor;e++)t.push(0);let e=[],a=0,i=(this.currentSubFloorArr[this.currentSubMaxFloor-1]||0)+(this.currentSubFloorArr[this.currentSubMaxFloor-2]||0)+(this.currentSubFloorArr[this.currentSubMaxFloor-3]||0);for(let r=this.subGroupData.cardList.length-1;r>=0;r--){let s=this.subGroupData.cardList[r],o=!1,n=!1,h=!1;if(this.isIntoSub&&s.data.cardFloor==this.currentSubMaxFloor){this.typeIntoSub==g[g.Store]&&(o=!0,n=!0,h=!0);let r=this.checkNewPos(t,this.currentSubMaxFloor-1,this.cardParent.cardTemp2,this.cardParent.cardTemp1,this.cardParent.cardTemp3,o,n);r.length>0&&s.createRender(r).then(()=>{h&&s.render.refreshPriceUI(),e.push({floor:this.currentSubMaxFloor,x:r[0],y:this.cardParent.cardTemp2.y,entity:s.render.entity}),++a==i&&this.startCardSorting(e)})}else if(s.data.cardFloor==this.currentSubMaxFloor-1){this.isIntoSub&&this.typeIntoSub==g[g.Store]&&(o=!0,n=!1,h=!0);let r=this.checkNewPos(t,this.currentSubMaxFloor-2,this.cardParent.cardTemp4,this.cardParent.cardTemp6,this.cardParent.cardTemp7,o,n);r.length>0&&s.createRender(r).then(()=>{h&&s.render.refreshPriceUI(),e.push({floor:this.currentSubMaxFloor-1,x:r[0],y:this.cardParent.cardTemp4.y,entity:s.render.entity}),++a==i&&this.startCardSorting(e)})}else if(s.data.cardFloor==this.currentSubMaxFloor-2){this.isIntoSub&&this.typeIntoSub==g[g.Store]&&(o=!0,n=!0,h=!0);let r=this.checkNewPos(t,this.currentSubMaxFloor-3,this.cardParent.cardTemp5,this.cardParent.cardTemp8,this.cardParent.cardTemp9,o,n);r.length>0&&s.createRender(r).then(()=>{h&&s.render.refreshPriceUI(),e.push({floor:this.currentSubMaxFloor-2,x:r[0],y:this.cardParent.cardTemp5.y,entity:s.render.entity}),++a==i&&this.startCardSorting(e)})}}}skillRandNumber(t,e,a){1==a?(e.data.vrEnemy.battleSkillComponents.costHp(5),ke.instance.layerEffect.sceneGame.createAttack1([e.render.x+e.render.width/2,e.render.y+e.render.height/2]),Et.instance.showMoreTips(1,[5],e.render.x+e.render.width/2,e.render.y+e.render.height/2,100),t.data.vrHero.battleSkillComponents.restoreBlood(5),ke.instance.layerEffect.sceneGame.createAddSt([t.render.x+t.render.width/2,t.render.y+t.render.height/2]),Et.instance.showMoreTips(1,[5],t.render.x+t.render.width/2,t.render.y+t.render.height/2,100)):(e.data.vrEnemy.battleSkillComponents.restoreBlood(5),ke.instance.layerEffect.sceneGame.createAddSt([e.render.x+e.render.width/2,e.render.y+e.render.height/2]),Et.instance.showMoreTips(1,[5],e.render.x+e.render.width/2,e.render.y+e.render.height/2,100),t.data.vrHero.battleSkillComponents.costHp(5),ke.instance.layerEffect.sceneGame.createAttack1([t.render.x+t.render.width/2,t.render.y+t.render.height/2]),Et.instance.showMoreTips(1,[5],t.render.x+t.render.width/2,t.render.y+t.render.height/2,100)),t.flushRender(),t.data.vrHero.currentHp<=0&&this.playerDeath(),e.flushRender(),this.checkEnemyDead(!0,t,e)}}class Xt extends ot.Scenes.ExploreSceneUI{constructor(){super(),this.layerIndex={LayerTree:0},this.width=Laya.stage.width,this.height=Laya.stage.height,this.initGame()}static get instance(){return Xt._instance||(Xt._instance=new Xt),Xt._instance}initGame(){Ht.instance.initGame(this.detailTemp),Ot.instance.initGame(this.treasureTemp)}onShow(t){t?(this.visible=!0,this.addEvent(),this.initRepeat()):(this.visible=!1,this.removeEvent())}initRepeat(){}addEvent(){a.log("ExploreScene: true"),this.on(Laya.Event.MOUSE_UP,this,this.OnMouseUp)}removeEvent(){this.off(Laya.Event.MOUSE_UP,this,this.OnMouseUp)}OnMouseUp(t){a.log("OnMouseUp"),Wt.instance.OnFreed()}setAttrTxt(t){let e="",a="";switch(t){case S.Jin:e="金",a="#FFD700";break;case S.Mu:e="木",a="#00FF00";break;case S.Shui:e="水",a="#00FFFF";break;case S.Huo:e="火",a="#B22222";break;case S.Tu:e="土",a="#6D000E";break;case S.Yin:e="阴",a="#800080";break;case S.Yang:e="阳",a="#FFFF00";break;case S.Wu:e="无",a="#ffffff"}return[e,a]}}class Rt extends ot.Items.AddDetailsWithRightUI{constructor(){super(),this.isShow=!1,this.maxTime=300,this.width=Laya.stage.width,this.height=Laya.stage.height}static get instance(){return Rt._instance||(Rt._instance=new Rt),Rt._instance}initGame(t){t.addChild(this),this.visible=!1,this.isShow=!1,this.pos(0,0),this.zOrder=Laya.stage.height}onShow(t){t?(this.visible=!0,this.zOrder=1,this.initRepeat(),this.isShow=!0):(this.zOrder=0,this.clear(),this.isShow=!1)}initRepeat(){if(this.isShow||this.box.pos(0,Laya.stage.height-120),Laya.Tween.clearAll(this.box),this.box.x!=this.box.width*this.box.scaleX){let t=(this.box.x-this.box.width*this.box.scaleX)*this.maxTime/-this.box.width*this.box.scaleX;a.log("time:",t),Laya.Tween.to(this.box,{x:this.box.width*this.box.scaleX},t,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()}))}}clear(){this.removeEvent(),this.isShow&&Laya.Tween.to(this.box,{x:0},this.maxTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,D.event(r.CallEndMonthEvent)}))}addEvent(){this.btn_ok.on(Laya.Event.CLICK,this,this.OnEatFood)}removeEvent(){this.btn_ok.off(Laya.Event.CLICK,this,this.OnEatFood)}OnEatFood(){this.onShow(!1)}}class Ft{static instance(t){return this._instance||(this._instance=new t),this._instance}}class Yt extends Ft{constructor(){super(),this.logicName=""}}var Nt,Ut={1:function(t){return t[0]},2:function(t,e){return t[0]+(t[1]-t[0])*e},3:function(t,e){var a=1-e;return(t[0]*a+t[1]*e)*a+(t[1]*a+t[2]*e)*e},4:function(t,e){var a=1-e,i=t[1]*a+t[2]*e;return((t[0]*a+t[1]*e)*a+i*e)*a+(i*a+(t[2]*a+t[3]*e)*e)*e}},zt={neat:function(t,e){return prepare(t.length)(t,e)},prepare:prepare};function prepare(t){if(!(t=0|+t))throw new Error("Cannot create a interpolator with no elements");if(Ut[t])return Ut[t];for(var e=["var ut = 1 - t",""],a=t;a--;){for(var i=0;i<a;i+=1)a+1===t?e.push("var p"+i+" = arr["+i+"] * ut + arr["+(i+1)+"] * t"):a>1?e.push("p"+i+" = p"+i+" * ut + p"+(i+1)+" * t"):e.push("return p"+i+" * ut + p"+(i+1)+" * t");a>1&&e.push("")}var r=["return function bezier"+t+"(arr, t) {",e.map(function(t){return"  "+t}).join("\n"),"}"].join("\n");return Function(r)()}class _t{constructor(t){this.xArr=[],this.yArr=[],this.refresh(t)}get length(){let t,e=0;for(let a=0;a<10;a++){let i=this.getPoint(a/9);t&&(e+=i.distanceTo(t)),t=i}return e}refresh(t){this.xArr.length=0,this.yArr.length=0;for(let e=0;e<t.length;e++){let a=t[e];a instanceof Laya.Point?(this.xArr.push(a.x),this.yArr.push(a.y)):(this.xArr.push(a[0]),this.yArr.push(a[1]))}}getPoint(t,e){let a=e||new Laya.Point,i=zt.neat(this.xArr,t),r=zt.neat(this.yArr,t);return a.set(i,r),a}}class Vt extends Laya.Script{init(t){this.mIdx=t}onChange(t){return new Promise(e=>{let a=Laya.TimeLine.to(this.owner,{alpha:0,scaleX:0,scaleY:0},t);a.play(),a.on(Laya.Event.COMPLETE,this,()=>{this.owner.removeSelf(),this.owner.destroy(),e()})})}}class Kt{constructor(t,e,i,r,s){this.idx=0,this.t=0,this.trailComps=[],this.idx=t,this.bezier=e,this.curPos=new Laya.Point,this.caller=s,this.speed=i,this.t=0,a.log("dur:",this.speed,this.length);let o=200*t;Laya.timer.once(o,this,()=>{Laya.timer.frameLoop(1,this,this.loop,[r])})}get length(){let t,e=0;for(let a=0;a<10;a++){let i=this.bezier.getPoint(a/9);t&&(e+=i.distanceTo(t)),t=i}return e}loop(t){this.t+=this.speed,this.bezier.getPoint(this.t/this.length,this.curPos);var e=new Laya.Image,a=this.trailComps.length;this.trailComps.push({id:a,sprite:e}),e.skin="Number/"+this.getStrUrl(t),e.size(20,20),e.anchorX=.5,e.anchorY=.5,e.pos(this.curPos.x,this.curPos.y),this.trailComps.length>1&&(e.rotation=z.getAngle2(this.trailComps[a-1].sprite.x,this.trailComps[a-1].sprite.y,e.x,e.y)),e.scale(1,1),e.alpha=1,Laya.stage.addChild(e),e.zOrder=999;let i=e.addComponent(Vt);i.init(a),i.onChange(500).then(()=>{this.trailComps.splice(i.mIdx,1)}),this.t>=this.length&&(Laya.timer.clear(this,this.loop),this.caller(this.idx))}kill(){Laya.timer.clear(this,this.loop)}getStrUrl(t){let e="";switch(t){case"0":e="numb_04.png";break;case"1":e="numb_05.png";break;case"2":e="numb_06.png";break;case"3":e="numb_07.png";break;case"4":e="numb_08.png";break;case"5":e="numb_09.png";break;case"6":e="numb_10.png";break;case"7":e="numb_11.png";break;case"8":e="numb_12.png";break;case"9":e="numb_13.png";break;default:e="numb_04.png"}return e}}class qt{constructor(t,e,i,r){this.t=0,this.bezier=t,this.curPos=new Laya.Point,this.caller=r,this.speed=e,this.t=0,this.target=new Laya.Image,this.target.skin="Number/"+this.getStrUrl(i),this.target.size(25,25),this.target.anchorX=.5,this.target.anchorY=.5,this.target.scale(.8,.8),Laya.stage.addChild(this.target),this.target.zOrder=999,a.log("dur:",this.speed,this.length),Laya.timer.frameLoop(1,this,this.loop)}get length(){let t,e=0;for(let a=0;a<10;a++){let i=this.bezier.getPoint(a/9);t&&(e+=i.distanceTo(t)),t=i}return e}loop(){this.t+=this.speed,this.bezier.getPoint(this.t/this.length,this.curPos),this.target.pos(this.curPos.x,this.curPos.y),this.t>=this.length&&(Laya.timer.clear(this,this.loop),this.caller(),this.target.removeSelf(),this.target.destroy())}kill(){Laya.timer.clear(this,this.loop)}getStrUrl(t){let e="";switch(t){case"+":e="numb_01.png";break;case"-":e="numb_02.png"}return e}}!function(t){t[t.Money=0]="Money",t[t.Rubbish=1]="Rubbish"}(Nt||(Nt={}));class jt{static get instance(){return this._instance||(this._instance=new this),this._instance}initBezierMoveTrail(){this.bezierMoveTrailAmout=0,this.bezierMoveTrailAdd=0}addTrail(t,...e){let[r,s,o,n]=e,h=[];return new Promise(e=>{let l=[z.randInt(-400,400)],c=[z.randInt(-400,400)];h=[[r,s],[r+l[z.randInt(0,l.length-1)],i.Half(s,n,!1)+c[z.randInt(0,c.length-1)]],[o,n]];let d=new _t(h);this.bezierMoveTrailAmout++,new Kt(this.bezierMoveTrailAdd,d,10,t,()=>{this.bezierMoveTrailAmout--,a.log("this.bezierMoveTrail:",this.bezierMoveTrailAmout),0==this.bezierMoveTrailAmout&&e()}),this.bezierMoveTrailAdd++})}fansTrail(t,e,...i){let[r,s,o,n]=i,h=[],l=t>=12?12:t,c="+"==e;for(let i=0;i<l;i++){h=[[r,s],[r+(c?700*Math.random()-400:500*Math.random()-400),s+(c?700*Math.random()-400:500*Math.random()-400)],[o,n]];let d=new _t(h);new qt(d,c?8:5,e,()=>{i==l-1&&(a.log("fansTrail"),Et.instance.showTips(c?"+"+t:"-"+t,c?o:r,c?n:s,"#ffffff",40),ke.instance.layerUI.sceneMap.refreshFansUI())})}}}class Qt extends Yt{constructor(){super(),this.logicName="ChangeFans"}addFans(t,e){let a=ke.instance.layerUI.sceneMap.res_fans.localToGlobal(new Laya.Point(0,0)),i=[a.x+50,a.y],s=z.randInt(e[0],e[1]),o=Ae.instance.currentFans;Ae.instance.currentFans+=s;let n=Ae.instance.currentFans;jt.instance.fansTrail(s,"+",t[0],t[1],i[0],i[1]),D.event(r.CallRandEventWithFans,[o,n]),T.instance.set("CurrentFans",Ae.instance.currentFans,I.GameItems),T.instance.save()}fallFans(t){let e=ke.instance.layerUI.sceneMap.res_fans.localToGlobal(new Laya.Point(0,0)),a=[e.x+50,e.y],i=[Laya.stage.width,e.y+150],r=.01*z.randFloat(t[0],t[1]),s=0;if((s=Math.floor(Ae.instance.currentFans*r))>=Ae.instance.currentFans)s=Ae.instance.currentFans;else if(0==s)return;Ae.instance.currentFans-=s,jt.instance.fansTrail(s,"-",a[0],a[1],i[0],i[1]),T.instance.set("CurrentFans",Ae.instance.currentFans,I.GameItems),T.instance.save()}}class Jt extends ot.Items.AddDetailsWithRight2UI{constructor(){super(),this.isShow=!1,this.maxTime=300,this.width=Laya.stage.width,this.height=Laya.stage.height}static get instance(){return Jt._instance||(Jt._instance=new Jt),Jt._instance}initGame(t){t.addChild(this),this.visible=!1,this.isShow=!1,this.pos(0,0),this.zOrder=Laya.stage.height}onShow(t){t?(this.visible=!0,this.zOrder=1,this.initRepeat(),this.isShow=!0):(this.zOrder=0,this.clear(),this.isShow=!1)}initRepeat(){if(this.isShow||this.box.pos(0,Laya.stage.height-120),Laya.Tween.clearAll(this.box),this.box.x!=this.box.width*this.box.scaleX){let t=(this.box.x-this.box.width*this.box.scaleX)*this.maxTime/-this.box.width*this.box.scaleX;a.log("time:",t),Laya.Tween.to(this.box,{x:this.box.width*this.box.scaleX},t,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()}))}}clear(){this.removeEvent(),this.isShow&&Laya.Tween.to(this.box,{x:0},this.maxTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,D.event(r.CallNextMonthEvent)}))}addEvent(){this.btn_ok.on(Laya.Event.CLICK,this,this.OnEatFood)}removeEvent(){this.btn_ok.off(Laya.Event.CLICK,this,this.OnEatFood)}OnEatFood(){this.onShow(!1)}}class $t extends Yt{constructor(){super(),this.logicName="EatFood"}distributeFood(){let t=Ae.instance.costFood,e=[],i={},s=0,o=[],n=!1;if(jt.instance.initBezierMoveTrail(),a.log("ItemManager.instance.heroItems:",j.instance.heroItems),!j.instance.heroItems||j.instance.heroItems&&j.instance.heroItems=={})return;for(let t in j.instance.heroItems){let i=T.instance.get(t,I.MapNormalCard);i&&(e.push({key:t,satiety:i.cardSatiety}),a.log("costFoodPerson:",t,i.cardSatiety))}if(a.log("distributeFood",t,Ae.instance.currentFood,e.length),Ae.instance.currentFood<=0)return e.forEach(t=>{for(let e=0;e<Ae.instance.normalCardGroupArray.length;e++){let a=Ae.instance.normalCardGroupArray[e];a.data.cardList.filter(e=>e.data.key==t.key).length>0&&0!=t.satiety&&(t.group=a,t.ignoreIdx=e,s++)}}),a.log("执行下一步2"),void this.playDeathAnim(e,0,s);for(let t=0;t<Ae.instance.normalCardGroupArray.length;t++){const e=Ae.instance.normalCardGroupArray[t];e.data.cardList.filter(t=>t.data.curStat.cardType==d[d.Food]).length>0&&(e.data.cardList.filter(t=>1==t.data.curStat.IsProduction).length>0?o.push({hasMix:1,group:e}):e.data.cardList.filter(t=>0==t.data.curStat.IsProduction).length>0&&o.push({hasMix:0,group:e}))}a.log("foodGroupArr0:",o),o.sort((t,e)=>e.hasMix-t.hasMix);let h=o.length-1;for(;h>=0;){let r=o[h].group,s=r.data.cardList.filter(t=>t.data.curStat.cardType==d[d.Food]&&0!=t.data.curStat.cardSatiety);if(s.length>0){s.sort((t,e)=>t.data.curStat.IsProduction!==e.data.curStat.IsProduction?e.data.curStat.IsProduction?1:0-t.data.curStat.IsProduction?1:0:t.data.curStat.cardSatiety-e.data.curStat.cardSatiety);for(let o=s.length-1;o>=0;o--){a.log("xxxxxxxxxxxxxx1:",o);let h=s[o],l=h.data.curStat.cardSatiety;for(let o=0;o<e.length;o++){const n=e[o];if(0!=n.satiety){if(!(l>=n.satiety)){a.log("distributeFood2:",s.length-1,l,n.satiety),n.satiety-=l,t-=l,i[e[o].key]?(i[e[o].key].amout+=1,i[e[o].key].values.push(l),i[e[o].key].startXs.push(r.render.x+h.render.x+h.render.entity.width/2),i[e[o].key].startYs.push(r.render.y+h.render.y+h.render.entity.height/2)):i[e[o].key]={amout:1,values:[l],startXs:[r.render.x+h.render.x+h.render.entity.width/2],startYs:[r.render.y+h.render.y+h.render.entity.height/2]},l=0;break}if(a.log("distributeFood1:",s.length-1,l,n.satiety),l-=n.satiety,t-=n.satiety,i[e[o].key]?(i[e[o].key].amout+=1,i[e[o].key].values.push(n.satiety),i[e[o].key].startXs.push(r.render.x+h.render.x+h.render.entity.width/2),i[e[o].key].startYs.push(r.render.y+h.render.y+h.render.entity.height/2)):i[e[o].key]={amout:1,values:[n.satiety],startXs:[r.render.x+h.render.x+h.render.entity.width/2],startYs:[r.render.y+h.render.y+h.render.entity.height/2]},n.satiety=0,0==l)break}}if(h.data.curStat.cardSatiety=l,0==l&&(h.data.curStat.IsProduction&&(n=!0),r.data.cardList.remove(h),h.dispose(!1,!0),s.splice(s.length-1,1)),0==t){a.log("xxxxxxxxxxxxxx2:",o);break}}if(r.data.cardList.length>0?r.flushRender():Ae.instance.clearGroupCard(r),0==t)break}h--}n&&(a.log("food-isProduction"),Ae.instance.checkMixAndCutBook()),e.forEach(t=>{for(let o=0;o<Ae.instance.normalCardGroupArray.length;o++){let n=Ae.instance.normalCardGroupArray[o],h=n.data.cardList.filter(e=>e.data.key==t.key);if(h.length>0&&(0!=t.satiety&&(t.group=n,t.ignoreIdx=o,s++),i[t.key])){a.log("animF2P:",i[t.key]);for(let o=0;o<i[t.key].amout;o++)ke.instance.layerEffect.sceneGame.createBoomAni([i[t.key].startXs[o],i[t.key].startYs[o]]),jt.instance.addTrail(i[t.key].values[o].toString(),i[t.key].startXs[o],i[t.key].startYs[o],n.render.x+h[0].render.x+h[0].render.entity.width/2,n.render.y+h[0].render.y+h[0].render.entity.height/2).then(()=>{a.log("执行下一步"),Laya.timer.once(200,this,()=>{Ae.instance.currentFood>=Ae.instance.costFood?D.event(r.CallRefreshCardEvent,[!1,d.Food,Ae.instance.costFood,!0]):D.event(r.CallRefreshCardEvent,[!1,d.Food,Ae.instance.currentFood,!0]),this.playDeathAnim(e,0,s)})})}}})}playDeathAnim(t,e,i){if(e>t.length-1)return a.log("playDeathAnim2",e,t.length-1,i),void this.deathAnimComplete(t,i);let r=t[e];a.log("playDeathAnim",r,e,t.length-1,i),0!=r.satiety?(Ae.instance.personToTombstone(!0,r.group,r.key,r.ignoreIdx),Laya.timer.once(300,this,()=>{this.playDeathAnim(t,e+=1,i)})):this.playDeathAnim(t,e+=1,i)}deathAnimComplete(t,e){e>0&&(Ae.instance.checkMixAndCutBook(),0==Ae.instance.currentPopulation)?Ae.instance.gameOver():Jt.instance.onShow(!0)}}class Zt extends Yt{constructor(){super(),this.logicName="SendGift"}checkMakeGift(){if(Ae.instance.currentFans>=1e4){let t=1,e=Ae.instance.currentFans-1e4;t+=Math.floor(e/5e3),Ae.instance.makingGifts=t}}submitGift(){let t=Ae.instance.makingGifts;if(t<=0)return this.followUpEffect();let e=[],i=!1;if(Ae.instance.currentGifts<=0)return this.followUpEffect();for(let t=0;t<Ae.instance.normalCardGroupArray.length;t++){const a=Ae.instance.normalCardGroupArray[t];a.data.cardList.filter(t=>t.data.curStat.cardType==d[d.Gift]||t.data.curStat.IsSave==d[d.Gift]).length>0&&(a.data.cardList.filter(t=>1==t.data.curStat.IsProduction).length>0?e.push({hasMix:1,group:a,save:a.data.cardList[0].data.curStat.IsSave==d[d.Gift]?1:0}):a.data.cardList.filter(t=>0==t.data.curStat.IsProduction).length>0&&e.push({hasMix:0,group:a,save:a.data.cardList[0].data.curStat.IsSave==d[d.Gift]?1:0}))}a.log("foodGroupArr0:",e.length),e.sort((t,e)=>t.hasMix!==e.hasMix?e.hasMix-t.hasMix:e.save-t.save),a.log("giftGroupArr:",e);let r=e.length-1;for(;r>=0;){let s=e[r].group,o=s.data.cardList.filter(t=>t.data.curStat.cardType==d[d.Gift]||t.data.curStat.IsSave==d[d.Gift]);if(o.length>0){for(let e=o.length-1;e>=0;e--){let r=o[e],n=r.data.curStat.cardType;if(a.log("makingGift:",t),ke.instance.layerEffect.sceneGame.createBoomAni([s.render.x+r.render.x+r.render.entity.width/2,s.render.y+r.render.y+r.render.entity.height/2]),n==d[d.Gift])r.data.curStat.IsProduction&&(i=!0),s.data.cardList.remove(r),r.dispose(!1,!1),o.splice(o.length-1,1),t--,a.log("makingGift1:",t);else{let e=r.data.curStat.cardLength,i=e>=t?e-t:0;r.data.curStat.saveCardsArr.splice(i),r.refreshSaveBox(),a.log("makingGift2:",t,e,i),t-=e-i,a.log("makingGift3:",t,e,i)}if(0==t)break}if(s.data.cardList.length>0?s.flushRender():Ae.instance.clearGroupCard(s),0==t)break}r--}return i&&(a.log("gift-isProduction"),Ae.instance.checkMixAndCutBook()),this.followUpEffect()}followUpEffect(){return!(Ae.instance.makingGifts>0)||(D.event(r.CallRandEventWithGift),!1)}}class te extends ot.Views.MapViewUI{constructor(){super(),this.initGame()}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height,this.setUI()}setUI(){Rt.instance.initGame(this),Jt.instance.initGame(this),Be.instance.initGame(this)}onShow(t){t?(this.visible=!0,this.addEvent(),this.initRepeat()):(this.visible=!1,this.removeEvent())}addEvent(){a.log("addEvent"),this.btn_time.on(Laya.Event.CLICK,this,this.OnControlTime),this.btn_setting.on(Laya.Event.CLICK,this,this.OnSetting),D.on(r.CallGameTimeEvent,this,this.OnCallGameTimeEvent),D.on(r.CallGameMonthEvent,this,this.OnCallGameMonthEvent),D.on(r.CallEndMonthEvent,this,this.OnCallEndMonthEvent),D.on(r.CallNextMonthEvent,this,this.OnCallNextMonthEvent),D.on(r.CallRefreshCardEvent,this,this.OnCallRefreshCardEvent)}removeEvent(){this.btn_time.off(Laya.Event.CLICK,this,this.OnControlTime),this.btn_setting.off(Laya.Event.CLICK,this,this.OnSetting),D.off(r.CallGameTimeEvent,this,this.OnCallGameTimeEvent),D.off(r.CallGameMonthEvent,this,this.OnCallGameMonthEvent),D.off(r.CallEndMonthEvent,this,this.OnCallEndMonthEvent),D.off(r.CallNextMonthEvent,this,this.OnCallNextMonthEvent),D.off(r.CallRefreshCardEvent,this,this.OnCallRefreshCardEvent)}initRepeat(){let t=T.instance.get("CurrentFans",I.GameItems),e=T.instance.get("CurrentGifts",I.GameItems),i=T.instance.get("MakingGifts",I.GameItems),r=T.instance.get("CurrentFood",I.GameItems),s=T.instance.get("CostFood",I.GameItems),o=T.instance.get("CurrentCoin",I.GameItems),n=T.instance.get("CurrentCard",I.GameItems),h=T.instance.get("CurrentPopulation",I.GameItems),l=T.instance.get("CurrentTimeBar",I.GameItems),c=(T.instance.get("CurrentWordlessBook",I.GameItems),T.instance.get("GameMonth",I.GameItems)||1),d=T.instance.get("GameYear",I.GameItems)||1,f=T.instance.get("GameSeason",I.GameItems)||p.Spring;this.btn_time.text=this.switchClock(F.instance.GameClockType),ke.instance.layerMap.time_bar.width=l||0,ke.instance.layerMap.time_record.text="第"+d+"年"+c+"月 "+this.switchSeason(f),null==s||null==r?(a.log(">>>1",s,r,this.res_food.text),this.res_food.text="0/0"):(a.log(">>>2",s,r,this.res_food.text),this.res_food.text=s+"/"+r),this.res_coin.text=o||"0",this.res_card.text=n||"0",this.res_population.text=h||"0",this.res_fans.text=t||"0",this.res_gift.text=i&&e?i+"/"+e:"0/0"}OnCallGameTimeEvent(t,e,a,i){ke.instance.layerMap.time_bar.width+=ke.instance.layerMap.time_base.width/(F.hourHold*F.dayHold),ke.instance.layerMap.time_bar.width>=ke.instance.layerMap.time_base.width&&(ke.instance.layerMap.time_bar.width=ke.instance.layerMap.time_base.width),ke.instance.layerMap.time_record.text="第"+a+"年"+e+"月 "+this.switchSeason(i),T.instance.set("CurrentTimeBar",ke.instance.layerMap.time_bar.width,I.GameItems)}OnCallGameMonthEvent(){F.instance.runTime(!1),Rt.instance.onShow(!0),Ae.instance.OnFreed(),T.instance.set("EatFoodTime",1,I.GameItems),ke.instance.layerMap.time_bar.width=0,T.instance.set("CurrentTimeBar",ke.instance.layerMap.time_bar.width,I.GameItems),T.instance.save()}OnCallEndMonthEvent(){$t.instance($t).distributeFood(),Zt.instance(Zt).submitGift()?Qt.instance(Qt).fallFans(A.costFansInterval):Qt.instance(Qt).fallFans(A.punishFansInterval),T.instance.set("EatFoodTime",2,I.GameItems),T.instance.save()}OnCallNextMonthEvent(){F.instance.runTime(!0),ke.instance.layerMap.time_bar.width=0,Zt.instance(Zt).checkMakeGift(),T.instance.set("EatFoodTime",0,I.GameItems),T.instance.save()}refreshFansUI(){this.res_fans.text=""+Ae.instance.currentFans,a.log("refreshFansUI:",Ae.instance.currentFans)}OnCallRefreshCardEvent(t,e,i,r=!1){switch(a.log("OnCallRefreshCardEvent:",t,e,i,Ae.instance.currentFood),r||(t?Ae.instance.currentCard+=1:Ae.instance.currentCard-=1),e){case d.Coin:t?Ae.instance.currentCoin+=i:Ae.instance.currentCoin-=i,this.res_coin.text=""+Ae.instance.currentCoin;break;case d.Gift:t?Ae.instance.currentGifts+=i:Ae.instance.currentGifts-=i,this.res_gift.text=Ae.instance.makingGifts+"/"+Ae.instance.currentGifts;break;case d.Container:t?Ae.instance.maxCard+=i:Ae.instance.maxCard-=i;break;case d.Food:t?Ae.instance.currentFood+=i:Ae.instance.currentFood-=i,this.res_food.text=Ae.instance.costFood+"/"+Ae.instance.currentFood;break;case d.Home:t?Ae.instance.maxPopulation+=i:Ae.instance.maxPopulation-=i,this.res_population.text=Ae.instance.currentPopulation+"";break;case d.People:t?Ae.instance.currentPopulation+=1:Ae.instance.currentPopulation-=1,t?Ae.instance.costFood+=i:Ae.instance.costFood-=i,this.res_population.text=Ae.instance.currentPopulation+"",this.res_food.text=Ae.instance.costFood+"/"+Ae.instance.currentFood;break;case d.WordlessBook:t?Ae.instance.currentWordlessBook+=1:Ae.instance.currentWordlessBook-=1}this.res_card.text=Ae.instance.currentCard+"",Ae.instance.currentCard>0&&0==Ae.instance.gameStep&&(F.instance.runTime(!0),Ae.instance.gameStep=1),T.instance.set("CurrentFood",Ae.instance.currentFood,I.GameItems),T.instance.set("CostFood",Ae.instance.costFood,I.GameItems),T.instance.set("CurrentCoin",Ae.instance.currentCoin,I.GameItems),T.instance.set("CurrentCard",Ae.instance.currentCard,I.GameItems),T.instance.set("CurrentPopulation",Ae.instance.currentPopulation,I.GameItems),T.instance.set("CurrentGifts",Ae.instance.currentGifts,I.GameItems),T.instance.set("CurrentWordlessBook",Ae.instance.currentWordlessBook,I.GameItems),T.instance.save()}OnControlTime(){F.instance.GameClockType+=1,F.instance.GameClockType>f.Pause&&(F.instance.GameClockType=f.Normal),this.btn_time.text=this.switchClock(F.instance.GameClockType)}OnSetting(){ke.instance.layerDialog.onDialogSetting()}switchSeason(t){let e="";switch(t){case p.Spring:e="春";break;case p.Summer:e="夏";break;case p.Fall:e="秋";break;case p.Winter:e="冬"}return e}switchClock(t){let e="";switch(t){case f.Normal:e="正常";break;case f.Accelerate:e="加速";break;case f.Pause:e="暂停"}return e}}class ee extends ot.Items.SignStarUI{static create(t,e){let a=new ee(e);return a.pos(t,0),a}constructor(t){super(),this.frfs=[this.f1,this.f2,this.f3],this.txts=[this.txt1,this.txt2,this.txt3];for(let t=0;t<this.frfs.length;t++)this.frfs[t].visible=!1,this.txts[t].visible=!1;this.selectOrder(t)}selectOrder(t){for(let e=0;e<t.length;e++){if(e>2)return;let a=t[e];switch(this.frfs[e].visible=!0,this.txts[e].visible=!0,a){case b.Boss:this.txts[e].text="敌",this.txts[e].color="#17171b";break;case b.EliteEnemy:this.txts[e].text="敌",this.txts[e].color="#d4e868";break;case b.Store:this.txts[e].text="商",this.txts[e].color="#ffffff";break;case b.Box:this.txts[e].text="宝",this.txts[e].color="#ffffff"}}}}class ae extends ot.Views.ExploreViewUI{constructor(){super(),this.initGame()}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height,this.setUI()}setUI(){this.list_weapon.renderHandler=new Laya.Handler(this,this.updateWeaponList),this.list_weapon.hScrollBarSkin="",this.list_weapon.scrollBar.elasticBackTime=50,this.list_weapon.scrollBar.elasticDistance=20,this.list_weapon.scrollBar.hide=!0}onShow(t){t?(this.visible=!0,this.addEvent(),this.initRepeat()):(this.visible=!1,this.removeEvent())}addEvent(){this.btn_setting.on(Laya.Event.CLICK,this,this.OnSettingBtn),this.btn_mix.on(Laya.Event.CLICK,this,this.OnOpenMixBtn),D.on(r.RefreshSilver,this,this.OnRefreshSilver),D.on(r.RefreshBatter,this,this.OnRefreshBatter),D.on(r.RefreshFightback,this,this.OnRefreshFightback),D.on(r.MixWeapon,this,this.OnMixWeaponEvent),D.on(r.RefreshWeapon,this,this.OnRefreshWeaponEvent),D.on(r.RefreshBattleTitle,this,this.OnRefreshBattleTitle),D.on(r.RefreshBattleBar,this,this.OnRefreshBattleBar),D.on(r.RefreshBattleBarSign,this,this.setBarContainer)}removeEvent(){this.btn_setting.off(Laya.Event.CLICK,this,this.OnSettingBtn),this.btn_mix.off(Laya.Event.CLICK,this,this.OnOpenMixBtn),D.off(r.RefreshSilver,this,this.OnRefreshSilver),D.off(r.RefreshBatter,this,this.OnRefreshBatter),D.off(r.RefreshFightback,this,this.OnRefreshFightback),D.off(r.MixWeapon,this,this.OnMixWeaponEvent),D.off(r.RefreshWeapon,this,this.OnRefreshWeaponEvent),D.off(r.RefreshBattleTitle,this,this.OnRefreshBattleTitle),D.off(r.RefreshBattleBar,this,this.OnRefreshBattleBar),D.off(r.RefreshBattleBarSign,this,this.setBarContainer)}initRepeat(){this.lb_silver.text="小星星\n",this.lb_batter.text="连击点\n",this.lb_fightback.text="反击点\n",this.lb_title.text="",this.box_bar.visible=!1}setBarContainer(t,e,i){if(t)for(;this.container_bar.numChildren>0;){let t=this.container_bar.getChildAt(0);t.removeSelf(),t.destroy()}if(i){a.log("floorSign:",i);for(let t in i)if(i[t]){let a=(e-Number(t))*(this.box_bar1.width-4)/e,r=ee.create(a,i[t].arr);this.container_bar.addChild(r)}}}OnSettingBtn(){ke.instance.layerDialog.onDialogQuitBattle()}OnRefreshSilver(t){this.lb_silver.text="小星星\n"+t+"c"}OnRefreshBatter(t,e){this.lb_batter.text="连击点\n"+t+"/"+e}OnRefreshFightback(t,e){this.lb_fightback.text="反击点\n"+t+"/"+e}OnRefreshBattleBar(t,e,a){this.box_bar.visible=!0,t?(this.box_bar.width=50*a,this.box_bar1.width=50*a):(this.box_bar.width=250,this.box_bar1.width=250),this.box_bar2.width=e*(this.box_bar1.width-4)/a}OnOpenMixBtn(){ke.instance.layerDialog.onDialogMixWeapon()}OnEquip(t){let e=Wt.instance.playerGroupData.cardList[0].data.vrHero.setExistingWeapon(t,!1);Wt.instance.playerGroupData.cardList[0].render.refreshWeaponUI(!0),e?this.refreshWeaponList():this.list_weapon.refresh()}OnMixWeaponEvent(){this.refreshWeaponList()}OnRefreshWeaponEvent(t){t?this.refreshWeaponList():this.list_weapon.refresh()}OnRefreshBattleTitle(t){this.lb_title.text=t+""}refreshWeaponList(){let t=[];for(let e=0;e<Wt.instance.playerGroupData.cardList[0].data.vrHero.atkWeaponWithBattle.length;e++){let a=Wt.instance.playerGroupData.cardList[0].data.vrHero.atkWeaponWithBattle[e];0!=a.special||a.InMix||t.push(a)}this.list_weapon.array=t}updateWeaponList(t,e){let a=t.dataSource,i=t.getChildByName("box"),r=i.getChildByName("name"),s=i.getChildByName("attr"),o=i.getChildByName("dur"),n=ke.instance.layerExplore.setAttrTxt(a.attributes);r.text=""+a.name,s.text=n[0],s.color=n[1],o.text=""+(-1==a.durability?"∞":a.durability),a.InMix||(a.key==Wt.instance.playerGroupData.cardList[0].data.vrHero.getAtkWeapon().key?i.skin="UI/Btn/Circle3.png":i.skin="UI/Btn/Circle2.png");let h=a.key;i.on(Laya.Event.CLICK,this,this.OnEquip,[h])}}class ie{constructor(){this.exitType=0}static get instance(){return ie._instance||(ie._instance=new ie),ie._instance}mainToMapScene(t){t||(T.instance.has(null,I.MapNormalCardGroup)&&(T.instance.data.MapNormalCardGroup={}),T.instance.has(null,I.MapNormalCard)&&(T.instance.data.MapNormalCard={}),T.instance.has(null,I.MapHolderCard)&&(T.instance.data.MapHolderCard={}),T.instance.has(null,I.GameItems)&&(T.instance.data.GameItems={}),T.instance.has(null,I.HeroData)&&(T.instance.data.HeroData={}),T.instance.has(null,I.AnimalData)&&(T.instance.data.AnimalData={}),T.instance.has(null,I.EnemyData)&&(T.instance.data.EnemyData={}),T.instance.has(null,I.WeaponData)&&(T.instance.data.WeaponData={}),T.instance.has(null,I.SpecialWeaponData)&&(T.instance.data.SpecialWeaponData={}),T.instance.set("readSaveData",1,I.Common),N.instance.removeExpectAutoSave(),T.instance.save()),a.log("mainToMapScene:",t),F.instance.init(),N.instance.restartAll(),Wt.instance.initRepeat(),ke.instance.layerUI.onSceneMap(),ke.instance.layerMap.onShow(!0),ke.instance.layerExplore.onShow(!1),Be.instance.onShow(!1,null),t&&1==this.exitType?(t=!1,this.exitType=0,Ae.instance.backRepeat()):(j.instance.init(),t||1!=this.exitType||(Ae.instance.dispose(),this.exitType=0),Ae.instance.initRepeat(t),t||ke.instance.layerDialog.onDialogInput());let e=T.instance.get("EatFoodTime",I.GameItems);e&&1==e?(F.instance.runTime(!1),Rt.instance.onShow(!0)):e&&2==e?(F.instance.runTime(!1),Jt.instance.onShow(!0)):0==Ae.instance.gameStep?F.instance.runTime(!1):F.instance.runTime(!0)}mapToBattleScene(){Ht.instance.onShow(!1,null),Ot.instance.initRepeat(),ke.instance.layerUI.onSceneExplore(),ke.instance.layerMap.onShow(!1),ke.instance.layerExplore.onShow(!0),a.log("mapToBattleScene"),Wt.instance.designCard()}battleToMapScene1(){ke.instance.layerUI.onSceneMap(),ke.instance.layerMap.onShow(!0),ke.instance.layerExplore.onShow(!1),Ae.instance.backRepeat(),Wt.instance.clearBattle(),F.instance.runTime(!0)}battleToMapScene2(t){ke.instance.layerUI.onSceneMap(),ke.instance.layerMap.onShow(!0),ke.instance.layerExplore.onShow(!1),Ae.instance.backRepeat(),Wt.instance.endBattle(t),F.instance.runTime(!0)}mapToMainScene1(){N.instance.pauseAll(),Ae.instance.dispose(),ke.instance.layerUI.onSceneMain(),ke.instance.layerMap.onShow(!1),ke.instance.layerExplore.onShow(!1)}mapToMainScene2(){this.exitType=1,T.instance.save(),N.instance.pauseAll(),ke.instance.layerUI.onSceneMain(),ke.instance.layerMap.onShow(!1),ke.instance.layerExplore.onShow(!1)}}class re extends ot.Views.MainViewUI{constructor(){super(),this.initGame()}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height,this.setUI()}setUI(){}onShow(t){t?(this.visible=!0,this.addEvent(),this.initRepeat()):(this.visible=!1,this.removeEvent())}addEvent(){this.startBtn.on(Laya.Event.CLICK,this,this.OnStartBtn),this.continueBtn.on(Laya.Event.CLICK,this,this.OnContinueBtn),this.descBtn.on(Laya.Event.CLICK,this,this.OnDesc)}removeEvent(){this.startBtn.off(Laya.Event.CLICK,this,this.OnStartBtn),this.continueBtn.off(Laya.Event.CLICK,this,this.OnContinueBtn),this.descBtn.off(Laya.Event.CLICK,this,this.OnDesc)}initRepeat(){let t=T.instance.get("readSaveData",I.Common);a.log("stat:",t),this.continueBtn.visible=!(!t||1!=t)}OnStartBtn(){ie.instance.mainToMapScene(!1)}OnContinueBtn(){ie.instance.mainToMapScene(!0)}OnDesc(){ke.instance.layerDialog.onDialogSettingDeatil1(2)}}class se extends ot.Scenes.UISceneUI{constructor(){super(),this.layerIndex={LayerMap:0,LayerExplore:1,LayerMain:2},this.scenes=[],this.width=Laya.stage.width,this.height=Laya.stage.height}static get instance(){return se._instance||(se._instance=new se),se._instance}onSceneHide(){this.scenes.forEach(t=>{t&&t.onShow(!1)})}onSceneMap(){this.onSceneHide(),this.sceneMap||(this.sceneMap=new te,this.addChild(this.sceneMap),this.sceneMap.zOrder=this.layerIndex.LayerMap,this.scenes.push(this.sceneMap)),this.sceneMap.onShow(!0)}onSceneExplore(){this.onSceneHide(),this.sceneExplore||(this.sceneExplore=new ae,this.addChild(this.sceneExplore),this.sceneExplore.zOrder=this.layerIndex.LayerExplore,this.scenes.push(this.sceneExplore)),this.sceneExplore.onShow(!0)}onSceneMain(){this.onSceneHide(),this.sceneMain||(this.sceneMain=new re,this.addChild(this.sceneMain),this.sceneMain.zOrder=this.layerIndex.LayerMain,this.scenes.push(this.sceneMain)),this.sceneMain.onShow(!0)}}class oe extends ot.Views.EffectFrontViewUI{constructor(){super(),this.width=Laya.stage.width,this.height=Laya.stage.height,this.initGame()}initGame(){}onShow(t){t?(this.visible=!0,this.addEvent(),this.initRepeat()):(this.visible=!1,this.removeEvent())}addEvent(){}removeEvent(){}initRepeat(){}}class ne extends ot.Views.EffectGameViewUI{constructor(){super(),this.width=Laya.stage.width,this.height=Laya.stage.height,this.initGame()}initGame(){}onShow(t){t?(this.visible=!0,this.addEvent(),this.initRepeat()):(this.visible=!1,this.removeEvent())}addEvent(){}removeEvent(){}initRepeat(){}createBoomAni(t,e=.75){let a=Laya.Pool.getItemByClass("CreateBoom",Laya.Animation);a.loadAnimation("Ani/CreateBoom.ani"),this.addChild(a),a.pos(t[0]+8,t[1]+24),a.scale(e,e),a.interval=20,a.on(Laya.Event.COMPLETE,this,t=>{t.removeSelf(),Laya.Pool.recover("CreateBoom",t)},[a]),a.play(0,!1)}createAttack1(t,e=1){let a=Laya.Pool.getItemByClass("CreateAttack1",Laya.Animation);a.loadAnimation("Ani/Attack.ani"),this.addChild(a),a.scale(e,e),a.pos(t[0],t[1]),a.interval=20,a.on(Laya.Event.COMPLETE,this,t=>{t.removeSelf(),Laya.Pool.recover("CreateAttack1",t)},[a]),a.play(0,!1)}createAttack2(t,e=.75){let a=Laya.Pool.getItemByClass("CreateAttack2",Laya.Animation);a.loadAnimation("Ani/BeAttack.ani"),this.addChild(a),a.scale(e,e),a.pos(t[0],t[1]),a.interval=20,a.on(Laya.Event.COMPLETE,this,t=>{t.removeSelf(),Laya.Pool.recover("CreateAttack2",t)},[a]),a.play(0,!1)}createShowWeak(t,e=.5){let a=Ct.createAni("CreateShowWeak","res/atlas/Ani/ShowWeak.atlas","Ani/ShowWeak/",3,50);this.addChild(a),a.scale(e,e),a.pivot(220,180),a.pos(t[0],t[1]),a.on(Laya.Event.COMPLETE,this,t=>{t.removeSelf(),Laya.Pool.recover("CreateShowWeak",t)},[a]),a.play(0,!1)}createBallBoom(t,e=.75){let a=Laya.Pool.getItemByClass("CreateBallBoom",Laya.Animation);a.loadAnimation("Ani/BallBoom.ani"),this.addChild(a),a.scale(e,e),a.pos(t[0],t[1]),a.interval=20,a.on(Laya.Event.COMPLETE,this,t=>{t.removeSelf(),Laya.Pool.recover("CreateBallBoom",t)},[a]),a.play(0,!1)}createAddSt(t,e=.75){let a=Laya.Pool.getItemByClass("CreateAddSt",Laya.Animation);a.loadAnimation("Ani/AddHp.ani"),this.addChild(a),a.scale(e,e),a.pos(t[0],t[1]),a.interval=20,a.on(Laya.Event.COMPLETE,this,t=>{t.removeSelf(),Laya.Pool.recover("CreateAddSt",t)},[a]),a.play(0,!1)}}class he extends ot.Scenes.EffectSceneUI{static get instance(){return he._instance||(he._instance=new he),he._instance}constructor(){super(),this.width=Laya.stage.width,this.height=Laya.stage.height}onSceneFront(){this.sceneFront||(this.sceneFront=new oe,this.addChild(this.sceneFront)),this.sceneFront.onShow(!0)}onSceneGame(){this.sceneGame||(this.sceneGame=new ne,this.addChild(this.sceneGame)),this.sceneGame.onShow(!0)}}class le extends ot.Dialogs.BattleConfirminquiryDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()}))}addEvent(){this.yesBtn.on(Laya.Event.CLICK,this,this.OnYesBtn),this.noBtn.on(Laya.Event.CLICK,this,this.OnNoBtn)}removeEvent(){this.yesBtn.off(Laya.Event.CLICK,this,this.OnYesBtn),this.noBtn.off(Laya.Event.CLICK,this,this.OnNoBtn)}OnYesBtn(){this.clear().then(()=>{ie.instance.mapToBattleScene()})}OnNoBtn(){this.clear().then(()=>{Wt.instance.clearBattle()})}}class ce extends ot.Dialogs.WeaponShowDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.addBatter=0,this.initGame()}onShow(t,e){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.card=e,this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()})),this.addBatter=0;let t,e=!1;this.card.data.cardType==g[g.Hero]?(t=this.card.data.vrHero.atkWeaponWithBattle[this.card.data.vrHero.weaponSelect],e=!0):this.card.data.cardType!=g[g.Enemy]&&this.card.data.cardType!=g[g.Animal]||(t=this.card.data.vrEnemy.atkWeaponWithBattle[this.card.data.vrEnemy.weaponSelect],e=!1),this.detailName.text=""+t.name,this.detailAtk.text=""+t.atk,this.detailDurability.text=""+(-1==t.durability?"∞":t.durability),this.detailAttr.text=""+ke.instance.layerExplore.setAttrTxt(t.attributes)[0],this.detailLink.text=t.link+"阶",this.detailSpecial.text=t.rare+"",this.detailShield.text=t.shieleAmout+"",this.detailAdd.visible=!1,this.detailUseBtn.visible=!1,this.detailUp1Btn.visible=!1,this.detailUp2Btn.visible=!1,this.detailUp3Btn.visible=!1;let a=t.desc+"\n";""!=t.effectDebutInfo&&(a+="登场:"+t.effectDebutInfo+"\n"),""!=t.effectPassiveInfo&&(a+="永久:"+t.effectPassiveInfo+"\n"),""!=t.effectInitiativeInfo&&(a+="主动:"+t.effectInitiativeInfo),this.detailInfo.text=a,e?(""!=t.effectInitiativeInfo&&(this.detailUseBtn.visible=!0,bt.instance.CheckBatterByArr(t.battleSkill)&&(Wt.instance.batter>=1&&(this.detailUp1Btn.visible=!0,this.detailUp1Btn.centerX=0),Wt.instance.batter>=2&&(this.detailUp2Btn.visible=!0,this.detailUp1Btn.centerX=-150,this.detailUp2Btn.centerX=150),Wt.instance.batter>=3&&(this.detailUp3Btn.visible=!0,this.detailUp1Btn.centerX=-250,this.detailUp2Btn.centerX=0,this.detailUp3Btn.centerX=250))),this.detailUseBtn.visible?this.detailCloseBtn.centerX=150:this.detailCloseBtn.centerX=0):this.detailCloseBtn.centerX=0}addEvent(){this.detailUseBtn.on(Laya.Event.CLICK,this,this.OnUseSkill),this.detailUp1Btn.on(Laya.Event.CLICK,this,this.OnUp1Skill),this.detailUp2Btn.on(Laya.Event.CLICK,this,this.OnUp2Skill),this.detailUp3Btn.on(Laya.Event.CLICK,this,this.OnUp3Skill),this.detailCloseBtn.on(Laya.Event.CLICK,this,this.OnClose)}removeEvent(){this.detailUseBtn.off(Laya.Event.CLICK,this,this.OnUseSkill),this.detailUp1Btn.off(Laya.Event.CLICK,this,this.OnUp1Skill),this.detailUp2Btn.off(Laya.Event.CLICK,this,this.OnUp2Skill),this.detailUp3Btn.off(Laya.Event.CLICK,this,this.OnUp3Skill),this.detailCloseBtn.off(Laya.Event.CLICK,this,this.OnClose)}OnUseSkill(){let t=this.card.data.vrHero.battleSkillComponents.selectSkill(ht.Initiative);t&&(t.cost<=this.card.data.vrHero.atkWeaponWithBattle[this.card.data.vrHero.weaponSelect].durability||-1==t.cost?this.clear().then(()=>{Wt.instance.castSkill(t,this.addBatter)}):Pt.instance.showTips("武器耐久度不足"))}OnUp1Skill(){this.detailUp1Btn.visible=this.detailUp2Btn.visible=this.detailUp3Btn.visible=!1,this.addBatter=1,this.detailAdd.visible=!0,this.detailAdd.text="已使用"+this.addBatter+"点连击值"}OnUp2Skill(){this.detailUp1Btn.visible=this.detailUp2Btn.visible=this.detailUp3Btn.visible=!1,this.addBatter=2,this.detailAdd.visible=!0,this.detailAdd.text="已使用"+this.addBatter+"点连击值"}OnUp3Skill(){this.detailUp1Btn.visible=this.detailUp2Btn.visible=this.detailUp3Btn.visible=!1,this.addBatter=3,this.detailAdd.visible=!0,this.detailAdd.text="已使用"+this.addBatter+"点连击值"}OnClose(){this.clear()}}class de extends ot.Dialogs.MixWeaponSelectDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t,e){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.completeID=e,this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height,this.weaponList.renderHandler=new Laya.Handler(this,this.updateWeaponList),this.weaponList.vScrollBarSkin="",this.weaponList.scrollBar.elasticBackTime=50,this.weaponList.scrollBar.elasticDistance=20,this.weaponList.scrollBar.hide=!0}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()}));let t=E.instance.select(L.MixWeapon).asDict[this.completeID];this.completeLink=t.Link,this.completeLinkDifferent=t.LinkDifferent,this.selectArr=[],this.title.text=(1==this.completeLinkDifferent?"请选择{0}把不同的武器":"请选择{0}把任意武器").format(this.completeLink),this.player=Wt.instance.playerGroupData.cardList[0].data.vrHero;let e=[];for(let t=0;t<this.player.atkWeaponWithBattle.length;t++){let a=this.player.atkWeaponWithBattle[t];a.InMix||1==a.special&&a.link>=this.completeLink||e.push({isGray:0,isSelect:0,data:a})}this.weaponList.array=e}addEvent(){this.selectBtn.on(Laya.Event.CLICK,this,this.OnMix),this.closeBtn.on(Laya.Event.CLICK,this,this.OnClose)}removeEvent(){this.selectBtn.off(Laya.Event.CLICK,this,this.OnMix),this.closeBtn.off(Laya.Event.CLICK,this,this.OnClose)}OnMix(){let t=0;if(this.selectArr.forEach(e=>{t+=this.weaponList.array[e].data.link}),t!=this.completeLink)return;let e=Wt.instance.currentSpecialWeaponData[this.completeID];e.amout-=1;let a=this.player.setNewWeapon(e.data.Product),i=[];this.selectArr.forEach(t=>{if(0==this.weaponList.array[t].data.special)this.weaponList.array[t].data.InMix=!0,i.push(this.weaponList.array[t].data.key);else if(Wt.instance.saveSpWeaponDataSO[this.weaponList.array[t].data.key]){let e=Wt.instance.saveSpWeaponDataSO[this.weaponList.array[t].data.key].keyArr;i=i.concat(e),delete Wt.instance.saveSpWeaponDataSO[this.weaponList.array[t].data.key]}}),this.player.setExistingWeapon(a,!1),Wt.instance.saveSpWeaponDataSO[this.player.atkWeaponWithBattle[this.player.weaponSelect].key]={keyArr:i},D.event(r.MixWeapon),this.clear().then(()=>{Wt.instance.playerGroupData.cardList[0].render.refreshWeaponUI(!0)})}OnClose(){this.clear()}getItemData(t){return this.weaponList.array[t]}getItemIndex(t){return this.weaponList.cells[t]}updateWeaponList(t,e){let a=t.dataSource.data,i=t.dataSource.isSelect,r=t.dataSource.isGray,s=t.getChildByName("icon"),o=t.getChildByName("name"),n=t.getChildByName("durability"),h=t.getChildByName("special"),l=t.getChildByName("attr"),c=t.getChildByName("link"),d=t.getChildByName("select"),p=d.getChildByName("select_lb");o.text=""+a.name,n.text="耐久 "+(-1==a.durability?"∞":a.durability),l.text=""+ke.instance.layerExplore.setAttrTxt(a.attributes)[0],h.text=a.rare+"",c.text=a.link+"阶",0==r?(p.text=0==i?"可选择":"已选择",s.gray=!1,o.gray=!1,n.gray=!1,l.gray=!1,h.gray=!1,c.gray=!1,p.gray=!1,d.mouseEnabled=!0):(p.text="不可选",s.gray=!0,o.gray=!0,n.gray=!0,l.gray=!0,h.gray=!0,c.gray=!0,p.gray=!0,d.mouseEnabled=!1),d.on(Laya.Event.CLICK,this,this.OnSelectWeapon,[e])}OnSelectWeapon(t){if(1==this.getItemData(t).isGray)return;let e=[];0==this.getItemData(t).isSelect?(this.getItemData(t).isSelect=1,this.selectArr.push(t),e.push(this.getItemData(t).data.homeID)):(this.getItemData(t).isSelect=0,this.selectArr.remove(t),e.remove(this.getItemData(t).data.homeID)),this.weaponList.array.forEach((t,a)=>{this.selectArr.length>0&&this.selectArr.length<this.completeLink?this.selectArr.contains(a)||(1==this.completeLinkDifferent&&e.contains(t.data.homeID)?t.isGray=1:t.isGray=0):0==this.selectArr.length?t.isGray=0:this.selectArr.contains(a)?t.isGray=0:t.isGray=1}),a.log("this.weaponList.array:",this.weaponList.array,e),this.weaponList.refresh()}}class pe extends ot.Dialogs.ExploreEndDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.isSuccess=!1,this.initGame()}onShow(t,e){t?(this.visible=!0,this.isSuccess=e,this.zOrder=1,this.box.scale(0,0),this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()})),this.isSuccess?(this.title.text="战斗胜利",this.videoBtn.visible=!1,this.mainTxt.visible=!0):(this.title.text="尽力了",this.videoBtn.visible=!1,this.mainTxt.visible=!1)}addEvent(){this.videoBtn.on(Laya.Event.CLICK,this,this.onVideo),this.backBtn.on(Laya.Event.CLICK,this,this.onBack)}removeEvent(){this.videoBtn.off(Laya.Event.CLICK,this,this.onVideo),this.backBtn.off(Laya.Event.CLICK,this,this.onBack)}onVideo(){}onBack(){this.clear().then(()=>{ie.instance.battleToMapScene2(this.isSuccess)})}}class fe extends ot.Dialogs.MixWeaponDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height,this.mixList.renderHandler=new Laya.Handler(this,this.updateMixList),this.mixList.vScrollBarSkin="",this.mixList.scrollBar.elasticBackTime=50,this.mixList.scrollBar.elasticDistance=20,this.mixList.scrollBar.hide=!0}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()}));let t=Wt.instance.currentSpecialWeaponData;a.log("currentSpecialWeaponData:",t),this.weaponArr=[],this.player=Wt.instance.playerGroupData.cardList[0].data.vrHero;for(let t=0;t<this.player.atkWeaponWithBattle.length;t++){let e=this.player.atkWeaponWithBattle[t];e.InMix||this.weaponArr.push(e)}let e=[];for(let a in t)e.push(t[a]);this.mixList.array=e}addEvent(){this.closeBtn.on(Laya.Event.CLICK,this,this.OnClose),D.on(r.MixWeapon,this,this.OnMixWeaponEvent)}removeEvent(){this.closeBtn.off(Laya.Event.CLICK,this,this.OnClose),D.off(r.MixWeapon,this,this.OnMixWeaponEvent)}OnMixWeaponEvent(){this.clear()}OnClose(){this.clear()}updateMixList(t,e){let a=t.dataSource,i=(t.getChildByName("icon"),t.getChildByName("name")),r=t.getChildByName("attr"),s=t.getChildByName("link"),o=t.getChildByName("info"),n=t.getChildByName("amout"),h=t.getChildByName("special"),l=t.getChildByName("durability"),c=t.getChildByName("mix");c.getChildByName("mix_lb");i.text=""+a.data.Name,l.text="耐久 "+(-1==a.data.Durability?"∞":a.data.Durability),r.text=""+ke.instance.layerExplore.setAttrTxt(a.data.Attributes)[0],s.text=a.data.Link+"阶",o.text="素材:"+a.data.Desc,n.text="x"+a.amout,h.text=a.data.Rare+"";let d=this.checkMix(e);a.amout<=0&&(d=!1),c.visible=d,t.on(Laya.Event.CLICK,this,this.OnShowSWpData,[a.data.Product]),c.on(Laya.Event.CLICK,this,this.OnMix,[a.data.ID])}OnShowSWpData(t,e){e.stopPropagation(),ke.instance.layerDialog.onDialogDetailShowBySWp(!0,t,"")}OnMix(t,e){e.stopPropagation(),ke.instance.layerDialog.onDialogMixWeaponSelect(t)}checkMix(t){let e=this.mixList.array[t].data.Link,i=(this.mixList.array[t].data.LinkDifferent,this.weaponArr.length,0),r=this.weaponArr.filter(t=>1==t.special&&t.link<e||0==t.special);a.log("numsMap:",e,r);for(let t=0;t<r.length;t++)if((i+=r[t].link)>=e)return!0;return!1}}class me extends ot.Dialogs.DetailShowDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t,e){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.card=e,this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height,this.treasureList.renderHandler=new Laya.Handler(this,this.updateTreasureList),this.treasureList.vScrollBarSkin="",this.treasureList.scrollBar.elasticBackTime=50,this.treasureList.scrollBar.elasticDistance=20,this.treasureList.scrollBar.hide=!0}initRepeat(){switch(Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()})),this.card.data.cardType){case g[g.Hero]:this.weaponBtn.visible=!0,this.infoBox.visible=!1,this.attrBox.visible=!0,this.weaponBox.visible=!1,this.treasureList.visible=!0,this.weaponBtn.centerX=-150,this.closeBtn.centerX=150,this.detailName.y=90,this.detailName.text=this.card.data.vrHero.name+"",this.hpLb.text=this.card.data.vrHero.currentHp+"/"+this.card.data.vrHero.FinalCompleteHp,this.atkLb.text=this.card.data.vrHero.FinalAtk+"",this.hitLb.text=this.card.data.vrHero.FinalHit+"",this.dodgeLb.text=this.card.data.vrHero.FinalDodge+"",this.critLb.text=this.card.data.vrHero.FinalCrit+"",this.critDamageLb.text=this.card.data.vrHero.FinalCritDamage+"";let t=[],e=[];for(let a=0;a<this.card.data.vrHero.treasuresWithBattle.length;a++){let i=this.card.data.vrHero.treasuresWithBattle[a],r=E.instance.select(L.BattleTreasure).asDict[i];e.contains(i)?t.select(t=>t.id).amout+=1:(e.push(i),t.push({id:i,data:r,amout:1}))}this.treasureList.array=t;break;case g[g.Enemy]:case g[g.Animal]:this.weaponBtn.visible=!0,this.infoBox.visible=!1,this.attrBox.visible=!0,this.weaponBox.visible=!1,this.treasureList.visible=!1,this.weaponBtn.centerX=-150,this.closeBtn.centerX=150,this.detailName.y=90,this.detailName.text=this.card.data.vrEnemy.name+"",this.hpLb.text=this.card.data.vrEnemy.currentHp+"/"+this.card.data.vrEnemy.FinalCompleteHp,this.atkLb.text=this.card.data.vrEnemy.FinalAtk+"",this.hitLb.text=this.card.data.vrEnemy.FinalHit+"",this.dodgeLb.text=this.card.data.vrEnemy.FinalDodge+"",this.critLb.text=this.card.data.vrEnemy.FinalCrit+"",this.critDamageLb.text=this.card.data.vrEnemy.FinalCritDamage+"";break;case g[g.Weapon]:this.weaponBtn.visible=!1,this.infoBox.visible=!1,this.attrBox.visible=!1,this.weaponBox.visible=!0,this.closeBtn.centerX=0,this.detailName.y=-60,this.detailName.text=""+this.card.data.vrWeapon.name,this.wpAttr.text=""+ke.instance.layerExplore.setAttrTxt(this.card.data.vrWeapon.attributes)[0],this.wpAtk.text=""+this.card.data.vrWeapon.atk,this.wpDurability.text=""+(-1==this.card.data.vrWeapon.durability?"∞":this.card.data.vrWeapon.durability),this.wpSpecial.text=this.card.data.vrWeapon.rare+"",this.wpShield.text=this.card.data.vrWeapon.shieleAmout+"",this.wpLink.text=this.card.data.vrWeapon.link+"阶";let a=this.card.data.vrWeapon.desc+"\n";""!=this.card.data.vrWeapon.effectDebutInfo&&(a+="登场:"+this.card.data.vrWeapon.effectDebutInfo+"\n"),""!=this.card.data.vrWeapon.effectPassiveInfo&&(a+="永久:"+this.card.data.vrWeapon.effectPassiveInfo+"\n"),""!=this.card.data.vrWeapon.effectInitiativeInfo&&(a+="主动:"+this.card.data.vrWeapon.effectInitiativeInfo),this.wpInfo.text=this.card.data.vrWeapon.desc+"";break;default:this.weaponBtn.visible=!1,this.infoBox.visible=!0,this.attrBox.visible=!1,this.weaponBox.visible=!1,this.closeBtn.centerX=0,this.detailName.y=90,this.detailName.text=""+this.card.data.cardName,this.allInfo.text=""+this.card.data.cardDesc}}addEvent(){this.weaponBtn.on(Laya.Event.CLICK,this,this.OnShowWeapon),this.closeBtn.on(Laya.Event.CLICK,this,this.OnClose)}removeEvent(){this.weaponBtn.off(Laya.Event.CLICK,this,this.OnShowWeapon),this.closeBtn.off(Laya.Event.CLICK,this,this.OnClose)}OnClose(){this.clear()}OnShowWeapon(){ke.instance.layerDialog.onDialogWeaponShow(this.card)}updateTreasureList(t,e){let a=t.dataSource.data,i=t.dataSource.amout,r=t.getChildByName("name"),s=t.getChildByName("amout");r.text=""+a.Name,s.text=""+i,t.on(Laya.Event.CLICK,this,this.OnClickTr,[a])}OnClickTr(t){ke.instance.layerDialog.onDialogDetailShowByData(t)}}class ye extends ot.Dialogs.DetailShow2DialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t,e){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.data=e,this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()})),this.closeBtn.centerX=0,this.detailName.y=90,this.closeBtn.y=600,this.detailName.text=""+this.data.Name,this.allInfo.text=""+this.data.Desc}addEvent(){this.closeBtn.on(Laya.Event.CLICK,this,this.OnClose)}removeEvent(){this.closeBtn.off(Laya.Event.CLICK,this,this.OnClose)}OnClose(){this.clear()}}class ue extends ot.Dialogs.QuitDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()}))}addEvent(){this.yesBtn.on(Laya.Event.CLICK,this,this.OnQuit),this.noBtn.on(Laya.Event.CLICK,this,this.OnClose)}removeEvent(){this.yesBtn.off(Laya.Event.CLICK,this,this.OnQuit),this.noBtn.off(Laya.Event.CLICK,this,this.OnClose)}OnClose(){this.clear()}OnQuit(){this.clear().then(()=>{ie.instance.battleToMapScene1()})}}class ge extends ot.Dialogs.DetailShow3DialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t,e,a,i){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.initRepeat(e,a,i)):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(t,e,a){let i,r,s,o,n,h,l,c,d,p,f;Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()})),this.closeBtn.centerX=0,this.detailName.y=-60,-1!=e?(this.data=E.instance.select(L.BattleWeapon).asDict[e],i=this.data.Name,s=this.data.Attributes,r=this.data.Atk,o=this.data.Durability,n=this.data.Rare,h=this.data.ShieleAmout,l=this.data.Link,c=this.data.Desc,d=this.data.EffectDebutInfo||"",p=this.data.EffectPassiveInfo||"",f=this.data.EffectInitiativeInfo||""):(this.data=j.instance.weaponItems[a],i=this.data.curStat.name,s=this.data.curStat.attributes,r=this.data.curStat.atk,o=this.data.curStat.durability,n=this.data.curStat.rare,h=this.data.curStat.shieleAmout,l=this.data.curStat.link,c=this.data.curStat.desc,d=this.data.curStat.effectDebutInfo,p=this.data.curStat.effectPassiveInfo,f=this.data.curStat.effectInitiativeInfo),this.detailName.text=""+i,this.wpAttr.text=""+ke.instance.layerExplore.setAttrTxt(s)[0],this.wpAtk.text=""+r,this.wpDurability.text=""+(-1==o?"∞":o),this.wpSpecial.text=n+"",this.wpShield.text=h+"",this.wpLink.text=l+"阶";let m=c+"\n";""!=d&&(m+="登场:"+d+"\n"),""!=p&&(m+="永久:"+p+"\n"),""!=f&&(m+="主动:"+f),this.wpInfo.text=m+""}addEvent(){this.closeBtn.on(Laya.Event.CLICK,this,this.OnClose)}removeEvent(){this.closeBtn.off(Laya.Event.CLICK,this,this.OnClose)}OnClose(){this.clear()}}class be extends ot.Dialogs.MapEndDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()})),this.title.text="尽力了",this.mainTxt.text="已团灭...",T.instance.has(null,I.MapNormalCardGroup)&&(T.instance.data.MapNormalCardGroup={}),T.instance.has(null,I.MapNormalCard)&&(T.instance.data.MapNormalCard={}),T.instance.has(null,I.MapHolderCard)&&(T.instance.data.MapHolderCard={}),T.instance.has(null,I.GameItems)&&(T.instance.data.GameItems={}),T.instance.has(null,I.HeroData)&&(T.instance.data.HeroData={}),T.instance.has(null,I.AnimalData)&&(T.instance.data.AnimalData={}),T.instance.has(null,I.EnemyData)&&(T.instance.data.EnemyData={}),T.instance.has(null,I.WeaponData)&&(T.instance.data.WeaponData={}),T.instance.has(null,I.SpecialWeaponData)&&(T.instance.data.SpecialWeaponData={}),T.instance.set("readSaveData",0,I.Common),T.instance.save()}addEvent(){this.backBtn.on(Laya.Event.CLICK,this,this.onBack)}removeEvent(){this.backBtn.off(Laya.Event.CLICK,this,this.onBack)}onBack(){this.clear().then(()=>{ie.instance.mapToMainScene1()})}}class Se extends ot.Dialogs.MessageShowDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t,e){t?(this.visible=!0,this.zOrder=1,this.dataKey=e,this.box.scale(0,0),this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()}));let t=T.instance.get(this.dataKey,I.MapNormalCard);if(t)switch(this.type=t.cardType,this.type){case d[d.People]:this.playerBox.visible=!0,this.skillPoint.visible=!0,this.weaponBtn.visible=!0,this.weaponBox.visible=!1,this.closeBtn.centerX=150,this.hero=j.instance.heroItems[this.dataKey],this.playerHpAttr=this.hero.curStat.completeHp,this.playerAtkAttr=this.hero.curStat.atk,this.playerHitAttr=this.hero.curStat.hit,this.playerDodgeAttr=this.hero.curStat.dodge,this.playerCritAttr=this.hero.curStat.crit,this.playerCritDamageAttr=this.hero.curStat.critDamage,this.playerSkillAmout=this.hero.curStat.skillAmout,this.playerUseSkillAmout=this.playerSkillAmout,this.playerUseSkillArr=[0,0,0,0,0,0],this.detailName.text=this.hero.curStat.name+"",this.hpAttr.text=this.hero.curStat.currentHp+"/"+this.playerHpAttr,this.atkAttr.text=this.playerAtkAttr+"",this.hitAttr.text=this.playerHitAttr+"",this.dodgeAttr.text=this.playerDodgeAttr+"",this.critAttr.text=this.playerCritAttr+"",this.critDamageAttr.text=this.playerCritDamageAttr+"",this.descBox.text=this.hero.curStat.desc,this.skillPoint.text="可用属性点:"+this.playerUseSkillAmout,this.playerSkillAmout>0?(this.skillUseBtn.visible=!0,this.skillPoint.centerX=-100,this.setAttrBtn(!0,!0),this.setAttrBtn(!1,!1)):(this.skillUseBtn.visible=!1,this.skillPoint.centerX=0,this.setAttrBtn(!0,!1),this.setAttrBtn(!1,!1));break;case d[d.Enemy]:this.playerBox.visible=!0,this.skillPoint.visible=!1,this.weaponBtn.visible=!0,this.weaponBox.visible=!1,this.closeBtn.centerX=150,this.enemy=j.instance.enemyItems[this.dataKey],this.detailName.text=this.enemy.curStat.name+"",this.hpAttr.text=this.enemy.curStat.currentHp+"/"+this.enemy.curStat.completeHp,this.atkAttr.text=this.enemy.curStat.atk+"",this.hitAttr.text=this.enemy.curStat.hit+"",this.dodgeAttr.text=this.enemy.curStat.dodge+"",this.critAttr.text=this.enemy.curStat.crit+"",this.critDamageAttr.text=this.enemy.curStat.critDamage+"",this.descBox.text=this.enemy.curStat.desc,this.setAttrBtn(!0,!1),this.setAttrBtn(!1,!1);break;case d[d.Animal]:this.playerBox.visible=!0,this.skillPoint.visible=!1,this.weaponBtn.visible=!0,this.weaponBox.visible=!1,this.closeBtn.centerX=150,this.animal=j.instance.animalItems[this.dataKey],this.detailName.text=this.animal.curStat.name+"",this.hpAttr.text=this.animal.curStat.currentHp+"/"+this.animal.curStat.completeHp,this.atkAttr.text=this.animal.curStat.atk+"",this.hitAttr.text=this.animal.curStat.hit+"",this.dodgeAttr.text=this.animal.curStat.dodge+"",this.critAttr.text=this.animal.curStat.crit+"",this.critDamageAttr.text=this.animal.curStat.critDamage+"",this.descBox.text=this.animal.curStat.desc,this.setAttrBtn(!0,!1),this.setAttrBtn(!1,!1);break;case d[d.Weapon]:this.playerBox.visible=!1,this.weaponBtn.visible=!1,this.weaponBox.visible=!0,this.closeBtn.centerX=0,this.weapon=j.instance.weaponItems[this.dataKey],this.detailName.text=""+this.weapon.curStat.name,this.wpAttr.text=""+ke.instance.layerExplore.setAttrTxt(this.weapon.curStat.attributes)[0],this.wpAtk.text=""+this.weapon.curStat.atk,this.wpDurability.text=""+(-1==this.weapon.curStat.durability?"∞":this.weapon.curStat.durability),this.wpSpecial.text=this.weapon.curStat.rare+"",this.wpShield.text=this.weapon.curStat.shieleAmout+"",this.wpLink.text=this.weapon.curStat.link+"阶";let e=this.weapon.curStat.desc+"\n";""!=this.weapon.curStat.effectDebutInfo&&(e+="登场:"+this.weapon.curStat.effectDebutInfo+"\n"),""!=this.weapon.curStat.effectPassiveInfo&&(e+="永久:"+this.weapon.curStat.effectPassiveInfo+"\n"),""!=this.weapon.curStat.effectInitiativeInfo&&(e+="主动:"+this.weapon.curStat.effectInitiativeInfo),this.wpInfo.text=e}}addEvent(){this.hpBtn1.on(Laya.Event.CLICK,this,this.OnAddAbility,["hp"]),this.atkBtn1.on(Laya.Event.CLICK,this,this.OnAddAbility,["atk"]),this.hitBtn1.on(Laya.Event.CLICK,this,this.OnAddAbility,["hit"]),this.dodgeBtn1.on(Laya.Event.CLICK,this,this.OnAddAbility,["dodge"]),this.critBtn1.on(Laya.Event.CLICK,this,this.OnAddAbility,["crit"]),this.critDamageBtn1.on(Laya.Event.CLICK,this,this.OnAddAbility,["critDamage"]),this.hpBtn2.on(Laya.Event.CLICK,this,this.OnReduceAbility,["hp"]),this.atkBtn2.on(Laya.Event.CLICK,this,this.OnReduceAbility,["atk"]),this.hitBtn2.on(Laya.Event.CLICK,this,this.OnReduceAbility,["hit"]),this.dodgeBtn2.on(Laya.Event.CLICK,this,this.OnReduceAbility,["dodge"]),this.critBtn2.on(Laya.Event.CLICK,this,this.OnReduceAbility,["crit"]),this.critDamageBtn2.on(Laya.Event.CLICK,this,this.OnReduceAbility,["critDamage"]),this.skillUseBtn.on(Laya.Event.CLICK,this,this.OnSetAbility),this.weaponBtn.on(Laya.Event.CLICK,this,this.OnShowWeapon),this.closeBtn.on(Laya.Event.CLICK,this,this.OnClose)}removeEvent(){this.hpBtn1.off(Laya.Event.CLICK,this,this.OnAddAbility),this.atkBtn1.off(Laya.Event.CLICK,this,this.OnAddAbility),this.hitBtn1.off(Laya.Event.CLICK,this,this.OnAddAbility),this.dodgeBtn1.off(Laya.Event.CLICK,this,this.OnAddAbility),this.critBtn1.off(Laya.Event.CLICK,this,this.OnAddAbility),this.critDamageBtn1.off(Laya.Event.CLICK,this,this.OnAddAbility),this.hpBtn2.off(Laya.Event.CLICK,this,this.OnReduceAbility),this.atkBtn2.off(Laya.Event.CLICK,this,this.OnReduceAbility),this.hitBtn2.off(Laya.Event.CLICK,this,this.OnReduceAbility),this.dodgeBtn2.off(Laya.Event.CLICK,this,this.OnReduceAbility),this.critBtn2.off(Laya.Event.CLICK,this,this.OnReduceAbility),this.critDamageBtn2.off(Laya.Event.CLICK,this,this.OnReduceAbility),this.skillUseBtn.off(Laya.Event.CLICK,this,this.OnSetAbility),this.weaponBtn.off(Laya.Event.CLICK,this,this.OnShowWeapon),this.closeBtn.off(Laya.Event.CLICK,this,this.OnClose)}OnClose(){this.clear()}setAttrBtn(t,e,a=-1){t?(this.hpBtn1.visible=e,this.atkBtn1.visible=e,this.hitBtn1.visible=e,this.dodgeBtn1.visible=e,this.critBtn1.visible=e,this.critDamageBtn1.visible=e):-1!=a?(0==a&&(this.hpBtn2.visible=e),1==a&&(this.atkBtn2.visible=e),2==a&&(this.hitBtn2.visible=e),3==a&&(this.dodgeBtn2.visible=e),4==a&&(this.critBtn2.visible=e),5==a&&(this.critDamageBtn2.visible=e)):(this.hpBtn2.visible=e,this.atkBtn2.visible=e,this.hitBtn2.visible=e,this.dodgeBtn2.visible=e,this.critBtn2.visible=e,this.critDamageBtn2.visible=e)}OnAddAbility(t){switch(t){case"hp":this.playerHpAttr+=A.attrAddBase[0],this.playerUseSkillArr[0]++,this.setAttrBtn(!1,!0,0),this.hpAttr.text=this.hero.curStat.currentHp+"/"+this.playerHpAttr;break;case"atk":this.playerAtkAttr+=A.attrAddBase[1],this.playerUseSkillArr[1]++,this.setAttrBtn(!1,!0,1),this.atkAttr.text=this.playerAtkAttr+"";break;case"hit":this.playerHitAttr+=A.attrAddBase[2],this.playerUseSkillArr[2]++,this.setAttrBtn(!1,!0,2),this.hitAttr.text=this.playerHitAttr+"";break;case"dodge":this.playerDodgeAttr+=A.attrAddBase[3],this.playerUseSkillArr[3]++,this.setAttrBtn(!1,!0,3),this.dodgeAttr.text=this.playerDodgeAttr+"";break;case"crit":this.playerCritAttr+=A.attrAddBase[4],this.playerUseSkillArr[4]++,this.setAttrBtn(!1,!0,4),this.critAttr.text=this.playerCritAttr+"";break;case"critDamage":this.playerCritDamageAttr+=A.attrAddBase[5],this.playerUseSkillArr[5]++,this.setAttrBtn(!1,!0,5),this.critDamageAttr.text=this.playerCritDamageAttr+""}this.playerUseSkillAmout--,this.skillPoint.text="可用技能点:"+this.playerUseSkillAmout,this.playerUseSkillAmout<=0&&this.setAttrBtn(!0,!1)}OnReduceAbility(t){switch(t){case"hp":if(this.playerUseSkillArr[0]<=0)return;this.playerHpAttr-=A.attrAddBase[0],this.playerUseSkillArr[0]--,this.hpAttr.text=this.hero.curStat.currentHp+"/"+this.playerHpAttr,this.playerUseSkillArr[0]<=0&&this.setAttrBtn(!1,!1,0);break;case"atk":if(this.playerUseSkillArr[1]<=0)return;this.playerAtkAttr-=A.attrAddBase[1],this.playerUseSkillArr[1]--,this.atkAttr.text=this.playerAtkAttr+"",this.playerUseSkillArr[1]<=0&&this.setAttrBtn(!1,!1,1);break;case"hit":if(this.playerUseSkillArr[2]<=0)return;this.playerHitAttr-=A.attrAddBase[2],this.playerUseSkillArr[2]--,this.hitAttr.text=this.playerHitAttr+"",this.playerUseSkillArr[2]<=0&&this.setAttrBtn(!1,!1,2);break;case"dodge":if(this.playerUseSkillArr[3]<=0)return;this.playerDodgeAttr-=A.attrAddBase[3],this.playerUseSkillArr[3]--,this.dodgeAttr.text=this.playerDodgeAttr+"",this.playerUseSkillArr[3]<=0&&this.setAttrBtn(!1,!1,3);break;case"crit":if(this.playerUseSkillArr[4]<=0)return;this.playerCritAttr-=A.attrAddBase[4],this.playerUseSkillArr[4]--,this.critAttr.text=this.playerCritAttr+"",this.playerUseSkillArr[4]<=0&&this.setAttrBtn(!1,!1,4);break;case"critDamage":if(this.playerUseSkillArr[5]<=0)return;this.playerCritDamageAttr-=A.attrAddBase[5],this.playerUseSkillArr[5]--,this.critDamageAttr.text=this.playerCritDamageAttr+"",this.playerUseSkillArr[5]<=0&&this.setAttrBtn(!1,!1,5)}this.playerUseSkillAmout++,this.skillPoint.text="可用技能点:"+this.playerUseSkillAmout,this.setAttrBtn(!0,!0),this.playerUseSkillAmout>=this.playerSkillAmout&&this.setAttrBtn(!1,!1)}OnSetAbility(){this.hero.curStat.completeHp=this.playerHpAttr,this.hero.curStat.currentHp=this.hero.curStat.completeHp,this.hpAttr.text=this.hero.curStat.currentHp+"/"+this.playerHpAttr,this.hero.curStat.atk=this.playerAtkAttr,this.hero.curStat.hit=this.playerHitAttr,this.hero.curStat.dodge=this.playerDodgeAttr,this.hero.curStat.crit=this.playerCritAttr,this.hero.curStat.critDamage=this.playerCritDamageAttr,this.hero.curStat.skillAmout=this.playerUseSkillAmout,this.playerSkillAmout=this.hero.curStat.skillAmout,this.playerUseSkillAmout=this.playerSkillAmout,this.playerUseSkillArr=[0,0,0,0,0,0],this.playerSkillAmout>0?(this.skillUseBtn.visible=!0,this.skillPoint.centerX=-100,this.setAttrBtn(!0,!0),this.setAttrBtn(!1,!1)):(this.skillUseBtn.visible=!1,this.skillPoint.centerX=0,this.setAttrBtn(!0,!1),this.setAttrBtn(!1,!1)),T.instance.save()}OnShowWeapon(t){switch(t.stopPropagation(),this.type){case d[d.People]:this.hero.checkAtkWeapon()?ke.instance.layerDialog.onDialogDetailShowBySWp(!1,-1,this.hero.curStat.atkWeaponKey):ke.instance.layerDialog.onDialogDetailShowBySWp(!1,this.hero.curStat.weaponID,"");break;case d[d.Enemy]:ke.instance.layerDialog.onDialogDetailShowBySWp(!1,this.enemy.curStat.weaponID,"");break;case d[d.Animal]:ke.instance.layerDialog.onDialogDetailShowBySWp(!1,this.animal.curStat.weaponID,"")}}}class xe extends ot.Dialogs.SettingDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()}))}addEvent(){this.backBtn.on(Laya.Event.CLICK,this,this.OnQuit),this.closeBtn.on(Laya.Event.CLICK,this,this.OnClose),this.mixBookBtn.on(Laya.Event.CLICK,this,this.OnMix),this.youlikaBtn.on(Laya.Event.CLICK,this,this.OnYoulika),this.specialWeaponBtn.on(Laya.Event.CLICK,this,this.OnSpecialWeapon)}removeEvent(){this.backBtn.off(Laya.Event.CLICK,this,this.OnQuit),this.closeBtn.off(Laya.Event.CLICK,this,this.OnClose),this.mixBookBtn.off(Laya.Event.CLICK,this,this.OnMix),this.youlikaBtn.off(Laya.Event.CLICK,this,this.OnYoulika),this.specialWeaponBtn.off(Laya.Event.CLICK,this,this.OnSpecialWeapon)}OnClose(){this.clear()}OnQuit(){this.clear().then(()=>{ie.instance.mapToMainScene2()})}OnMix(){ke.instance.layerDialog.onDialogSettingDeatil1(1)}OnSpecialWeapon(){ke.instance.layerDialog.onDialogSettingDeatil1(0)}OnYoulika(){Pt.instance.showTips("未完成")}}class we extends ot.Items.RandNumSkillUIUI{constructor(){super(),this.tweenCount=0,this.dis1=15,this.dis2=-30,this.dis3=45,this.oneTxt=0,this.twoTxt=0,this.maxTxt=0,this.tweenSpeedTime=100,this.tweenEqualTime=0,this.ignoreCount=0}startAnim(t,e,a=0){null!=this.oneTween&&(this.oneTween.clear(),this.oneTween=null),null!=this.twoTween&&(this.twoTween.clear(),this.twoTween=null),this.oneTween=new Laya.Tween,this.twoTween=new Laya.Tween,this.maxTxt=e,this.tweenEqualTime=t,this.tweenCount=0,this.ignoreCount=a,this.oneTxt=0,this.twoTxt=1,this.one.y==this.dis1?(this.one.y=this.dis1,this.two.y=this.dis3,this.onOneTween(),this.onTwoTween()):this.two.y==this.dis1&&(this.two.y=this.dis1,this.one.y=this.dis3,this.onTwoTween2(),this.onOneTween2())}overAnim(){ke.instance.layerDialog.dialogRandNumber.OnClose()}onOneTween(){this.one.value=this.oneTxt+"",this.oneTween.to(this.one,{y:this.dis2},this.tweenSpeedTime,Laya.Ease.linearIn,new Laya.Handler(this,()=>{this.one.y=this.dis3;let t=this.oneTxt+2;t>(this.maxTxt%2==0?this.maxTxt-1:this.maxTxt)&&(t=0),this.oneTxt=t,this.one.value=this.oneTxt+"",this.oneTween.to(this.one,{y:this.dis1},this.tweenSpeedTime,Laya.Ease.linearIn,new Laya.Handler(this,()=>{if(a.log("tweenEqualTime0:",this.oneTxt,this.twoTxt,this.tweenEqualTime),this.oneTxt==this.tweenEqualTime){if(this.ignoreCount<=0){this.oneTween.clear(),this.twoTween.clear(),this.one.y=this.dis1,this.two.y=this.dis3;let t=this.twoTxt+2;return t>this.maxTxt&&(t=1),this.twoTxt=t,this.two.value=this.twoTxt+"",void this.overAnim()}this.ignoreCount-=1}this.onOneTween()}))}))}onTwoTween(){this.two.value=this.twoTxt+"",this.twoTween.to(this.two,{y:this.dis1},this.tweenSpeedTime,Laya.Ease.linearIn,new Laya.Handler(this,()=>{if(this.twoTxt==this.tweenEqualTime){if(this.ignoreCount<=0)return this.oneTween.clear(),this.twoTween.clear(),this.one.y=this.dis3,this.two.y=this.dis1,void this.overAnim();this.ignoreCount-=1}this.twoTween.to(this.two,{y:this.dis2},this.tweenSpeedTime,Laya.Ease.linearIn,new Laya.Handler(this,()=>{this.two.y=this.dis3;let t=this.twoTxt+2;t>this.maxTxt&&(t=1),this.twoTxt=t,this.two.value=this.twoTxt+"",a.log("tweenEqualTime1:",this.oneTxt,this.twoTxt,this.tweenEqualTime),this.onTwoTween()}))}))}onOneTween2(){this.one.value=this.oneTxt+"",this.oneTween.to(this.one,{y:this.dis1},this.tweenSpeedTime,Laya.Ease.linearIn,new Laya.Handler(this,()=>{if(this.oneTxt==this.tweenEqualTime){if(this.ignoreCount<=0)return this.oneTween.clear(),this.twoTween.clear(),this.two.y=this.dis3,this.one.y=this.dis1,void this.overAnim();this.ignoreCount-=1}this.oneTween.to(this.one,{y:this.dis2},this.tweenSpeedTime,Laya.Ease.linearIn,new Laya.Handler(this,()=>{this.one.y=this.dis3;let t=this.oneTxt+2;t>(this.maxTxt%2==0?this.maxTxt-1:this.maxTxt)&&(t=0),this.oneTxt=t,this.one.value=this.oneTxt+"",a.log("tweenEqualTime2:",this.oneTxt,this.twoTxt,this.tweenEqualTime),this.onOneTween2()}))}))}onTwoTween2(){this.two.value=this.twoTxt+"",a.log("tweenEqualTime3-1:",this.two.value,this.two.y),this.twoTween.to(this.two,{y:this.dis2},this.tweenSpeedTime,Laya.Ease.linearIn,new Laya.Handler(this,()=>{a.log("tweenEqualTime3-2:",this.two.y),this.two.y=this.dis3;let t=this.twoTxt+2;t>this.maxTxt&&(t=1),this.twoTxt=t,this.two.value=this.twoTxt+"",this.twoTween.to(this.two,{y:this.dis1},this.tweenSpeedTime,Laya.Ease.linearIn,new Laya.Handler(this,()=>{if(a.log("tweenEqualTime3:",this.oneTxt,this.twoTxt,this.tweenEqualTime),this.twoTxt==this.tweenEqualTime){if(this.ignoreCount<=0){this.oneTween.clear(),this.twoTween.clear(),this.two.y=this.dis1,this.one.y=this.dis3;let t=this.oneTxt+2;return t>(this.maxTxt%2==0?this.maxTxt-1:this.maxTxt)&&(t=0),this.oneTxt=t,this.one.value=this.oneTxt+"",void this.overAnim()}this.ignoreCount-=1}this.onTwoTween2()}))}))}}class ve extends ot.Dialogs.RandNumberDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t,e){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.data=e,this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()})),this.rd||(this.rd=new we,this.rd.pos(this.box.width/2,this.box.height/2),this.box.addChild(this.rd)),this.rand=z.randInt(0,1),this.rd.startAnim(this.rand,2,2)}addEvent(){}removeEvent(){}OnClose(){this.clear().then(()=>{this.rd.removeSelf(),this.rd.destroy(),Wt.instance.skillRandNumber(this.data.player,this.data.item,this.rand)})}}class Ie extends ot.Dialogs.SettingDeatil1DialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.specailWeaponRes=null,this.mixBookRes=null,this.initGame()}onShow(t,e){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.type=e,this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height,this.specailWeaponRes=E.instance.select(L.MixWeapon).asDict,this.mixBookRes=E.instance.select(L.MixBook).asDict,this.specialWeaponList.renderHandler=new Laya.Handler(this,this.updateSpecialWeaponList),this.specialWeaponList.vScrollBarSkin="",this.specialWeaponList.scrollBar.elasticBackTime=50,this.specialWeaponList.scrollBar.elasticDistance=20,this.specialWeaponList.scrollBar.hide=!0,this.mixList.renderHandler=new Laya.Handler(this,this.updateMixList),this.mixList.vScrollBarSkin="",this.mixList.scrollBar.elasticBackTime=50,this.mixList.scrollBar.elasticDistance=20,this.mixList.scrollBar.hide=!0}initRepeat(){if(Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()})),0==this.type){this.specialWeaponBox.visible=!0,this.mixBox.visible=!1,this.descBox.visible=!1;let t=[],e=T.instance.get(null,I.SpecialWeaponData);for(let a in e)if(e[a]){let i=this.specailWeaponRes[e[a].id];t.push({data:i,amout:e[a].amout})}this.specialWeaponList.array=t}else if(1==this.type){this.specialWeaponBox.visible=!1,this.mixBox.visible=!0,this.descBox.visible=!1;let t=[];for(let e in this.mixBookRes)if(this.mixBookRes[e]){let a=this.mixBookRes[e];1==a.IsShow&&t.push(a.Name)}this.mixList.array=t}else 2==this.type&&(this.specialWeaponBox.visible=!1,this.mixBox.visible=!1,this.descBox.visible=!0,this.version.text="demo_1.0.4")}addEvent(){this.closeBtn.on(Laya.Event.CLICK,this,this.OnClose)}removeEvent(){this.closeBtn.off(Laya.Event.CLICK,this,this.OnClose)}OnClose(){this.clear()}updateSpecialWeaponList(t,e){let a=t.dataSource,i=(t.getChildByName("icon"),t.getChildByName("name")),r=t.getChildByName("attr"),s=t.getChildByName("link"),o=t.getChildByName("info"),n=t.getChildByName("amout"),h=t.getChildByName("special"),l=t.getChildByName("durability");i.text=""+a.data.Name,l.text="耐久 "+(-1==a.data.Durability?"∞":a.data.Durability),r.text=""+ke.instance.layerExplore.setAttrTxt(a.data.Attributes)[0],s.text=a.data.Link+"阶",o.text="素材:"+a.data.Desc,n.text="x"+a.amout,h.text=a.data.Rare+"",t.on(Laya.Event.CLICK,this,this.OnShowSWpData,[a.data.Product])}updateMixList(t,e){let a=t.dataSource;t.getChildByName("mix_lb").text=""+a}OnShowSWpData(t,e){e.stopPropagation(),ke.instance.layerDialog.onDialogDetailShowBySWp(!0,t,"")}}class Le extends ot.Dialogs.InputDialogUI{constructor(){super(),this.scaleNum=.5,this.scaleTime=400,this.initGame()}onShow(t){t?(this.visible=!0,this.zOrder=1,this.box.scale(0,0),this.initRepeat()):this.zOrder=0}clear(){return new Promise(t=>{this.removeEvent(),Laya.Tween.to(this.box,{scaleX:0,scaleY:0},this.scaleTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1,t()}))})}initGame(){this.width=Laya.stage.width,this.height=Laya.stage.height}initRepeat(){Laya.Tween.to(this.box,{scaleX:this.scaleNum,scaleY:this.scaleNum},this.scaleTime,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()})),this.inputName.text="",this.inputName.maxChars=4}addEvent(){this.yesBtn.on(Laya.Event.CLICK,this,this.OnSave)}removeEvent(){this.yesBtn.off(Laya.Event.CLICK,this,this.OnSave)}OnClose(){this.clear()}OnSave(){this.inputName.text.length<=0?Pt.instance.showTips("不得为空"):this.clear().then(()=>{T.instance.set("InputName",this.inputName.text,I.GameItems),T.instance.save()})}}class Ce extends ot.Scenes.DialogSceneUI{constructor(){super(),this.scenes=[],this.width=Laya.stage.width,this.height=Laya.stage.height}static get instance(){return Ce._instance||(Ce._instance=new Ce),Ce._instance}onSetzOrder(){this.scenes.forEach(t=>{t&&t.onShow(!1)})}onDialogBattleConfirminquiry(){this.onSetzOrder(),this.dialogBattleConfirminquiry||(this.dialogBattleConfirminquiry=new le,this.scenes.push(this.dialogBattleConfirminquiry),this.addChild(this.dialogBattleConfirminquiry)),this.dialogBattleConfirminquiry.onShow(!0)}onDialogWeaponShow(t){this.onSetzOrder(),this.dialogWeaponShow||(this.dialogWeaponShow=new ce,this.scenes.push(this.dialogWeaponShow),this.addChild(this.dialogWeaponShow)),this.dialogWeaponShow.onShow(!0,t)}onDialogMixWeapon(){this.onSetzOrder(),this.dialogMixWeapon||(this.dialogMixWeapon=new fe,this.scenes.push(this.dialogMixWeapon),this.addChild(this.dialogMixWeapon)),this.dialogMixWeapon.onShow(!0)}onDialogMixWeaponSelect(t){this.onSetzOrder(),this.dialogMixWeaponSelect||(this.dialogMixWeaponSelect=new de,this.scenes.push(this.dialogMixWeaponSelect),this.addChild(this.dialogMixWeaponSelect)),this.dialogMixWeaponSelect.onShow(!0,t)}onDialogExploreEnd(t){this.onSetzOrder(),this.dialogExploreEnd||(this.dialogExploreEnd=new pe,this.scenes.push(this.dialogExploreEnd),this.addChild(this.dialogExploreEnd)),this.dialogExploreEnd.onShow(!0,t)}onDialogDetailShow(t){this.onSetzOrder(),this.dialogDetailShow||(this.dialogDetailShow=new me,this.scenes.push(this.dialogDetailShow),this.addChild(this.dialogDetailShow)),this.dialogDetailShow.onShow(!0,t)}onDialogDetailShowByData(t){this.onSetzOrder(),this.dialogDetailByDataShow||(this.dialogDetailByDataShow=new ye,this.scenes.push(this.dialogDetailByDataShow),this.addChild(this.dialogDetailByDataShow)),this.dialogDetailByDataShow.onShow(!0,t)}onDialogDetailShowBySWp(t,e,a){this.onSetzOrder(),this.dialogDetailBySWpShow||(this.dialogDetailBySWpShow=new ge,this.scenes.push(this.dialogDetailBySWpShow),this.addChild(this.dialogDetailBySWpShow)),this.dialogDetailBySWpShow.onShow(!0,t,e,a)}onDialogQuitBattle(){this.onSetzOrder(),this.dialogQuit||(this.dialogQuit=new ue,this.scenes.push(this.dialogQuit),this.addChild(this.dialogQuit)),this.dialogQuit.onShow(!0)}onDialogMapEnd(){this.onSetzOrder(),this.dialogMapEnd||(this.dialogMapEnd=new be,this.scenes.push(this.dialogMapEnd),this.addChild(this.dialogMapEnd)),this.dialogMapEnd.onShow(!0)}onDialogMessageShow(t){this.onSetzOrder(),this.dialogMessageShow||(this.dialogMessageShow=new Se,this.scenes.push(this.dialogMessageShow),this.addChild(this.dialogMessageShow)),this.dialogMessageShow.onShow(!0,t)}onDialogSetting(){this.onSetzOrder(),this.dialogSetting||(this.dialogSetting=new xe,this.scenes.push(this.dialogSetting),this.addChild(this.dialogSetting)),this.dialogSetting.onShow(!0)}onDialogRandNumber(t){this.onSetzOrder(),this.dialogRandNumber||(this.dialogRandNumber=new ve,this.scenes.push(this.dialogRandNumber),this.addChild(this.dialogRandNumber)),this.dialogRandNumber.onShow(!0,t)}onDialogSettingDeatil1(t){this.onSetzOrder(),this.dialogSettingDeatil1||(this.dialogSettingDeatil1=new Ie,this.scenes.push(this.dialogSettingDeatil1),this.addChild(this.dialogSettingDeatil1)),this.dialogSettingDeatil1.onShow(!0,t)}onDialogInput(){this.onSetzOrder(),this.dialogInput||(this.dialogInput=new Le,this.scenes.push(this.dialogInput),this.addChild(this.dialogInput)),this.dialogInput.onShow(!0)}}class ke extends Laya.Script{constructor(){super(...arguments),this.dis=0,this.layerIndex={LayerMap:1,LayerExplore:1,LayerUI:2,LayerDialog:3,LayerEffect:4,LayerGuide:5},this.preloadAtlas=["effect/images.atlas","res/atlas/Ani/AddHp.atlas","res/atlas/Ani/Attack.atlas","res/atlas/Ani/BallBoom.atlas","res/atlas/Ani/BeAttack.atlas","res/atlas/Ani/CardTrail.atlas","res/atlas/Ani/CreateBoom.atlas","res/atlas/Ani/ShowWeak.atlas"],this.preloadBG=[],this.preloadJson=["Ani/CreateBoom.ani","Ani/AddHp.ani","Ani/BallBoom.ani","Ani/Attack.ani","Ani/BeAttack.ani"],this.preloadSk=[]}static get instance(){return ke._instance||(ke._instance=new ke),ke._instance}init(){this.genLayers()}genLayers(){this.layerMap=ut.instance,this.layerMap.onShow(!1),Laya.stage.addChild(this.layerMap),this.layerMap.zOrder=this.layerIndex.LayerMap,this.layerMap.name="LayerMap",this.layerExplore=Xt.instance,this.layerExplore.onShow(!1),Laya.stage.addChild(this.layerExplore),this.layerExplore.zOrder=this.layerIndex.LayerExplore,this.layerExplore.name="LayerExplore",this.layerUI=se.instance,Laya.stage.addChild(this.layerUI),this.layerUI.zOrder=this.layerIndex.LayerUI,this.layerUI.name="LayerUI",this.layerEffect=he.instance,Laya.stage.addChild(this.layerEffect),this.layerEffect.zOrder=this.layerIndex.LayerEffect,this.layerEffect.name="LayerEffect",this.layerDialog=Ce.instance,Laya.stage.addChild(this.layerDialog),this.layerDialog.zOrder=this.layerIndex.LayerDialog,this.layerDialog.name="LayerDialog"}clear(){this.layerMap&&(this.layerMap.destroy(),this.layerExplore.destroy(),this.layerUI.destroy(),this.layerDialog.destroy(),this.layerEffect.destroy(),this.layerGuide.destroy()),Laya.Resource.destroyUnusedResources()}load(){return new Promise(t=>{Laya.loader.load(this.preloadJson,Laya.Handler.create(this,()=>{Laya.loader.load(this.preloadAtlas,Laya.Handler.create(this,()=>{t()}),null,Laya.Loader.ATLAS)}),null,Laya.Loader.JSON)})}}class Be extends ot.Items.AddDetailsWithTopUI{constructor(){super(),this.isShow=!1,this.maxTime=300,this.width=Laya.stage.width,this.height=Laya.stage.height}static get instance(){return Be._instance||(Be._instance=new Be),Be._instance}initGame(t){t.addChild(this),this.visible=!1,this.isShow=!1,this.pos(0,0),this.zOrder=Laya.stage.height}onShow(t,e){t?(this.visible=!0,this.zOrder=1,this.dataKey=e,this.initRepeat(),this.isShow=!0):(this.zOrder=0,this.clear(),this.isShow=!1)}refreshUI(){this.isShow&&this.initRepeat()}initRepeat(){if(this.isShow||this.box.pos(0,Laya.stage.height+this.box.height*this.box.scaleY),Laya.Tween.clearAll(this.box),this.box.y!=Laya.stage.height-this.box.height*this.box.scaleY){let t=Math.abs((Laya.stage.height-this.box.height*this.box.scaleY-this.box.y)*this.maxTime/(Laya.stage.height-this.box.height*this.box.scaleY-(Laya.stage.height+100)));a.log("time:",t),Laya.Tween.to(this.box,{y:Laya.stage.height-this.box.height*this.box.scaleY},t,Laya.Ease.backOut,new Laya.Handler(this,()=>{this.addEvent()}))}this.clickOpenType=0;let t=T.instance.get(this.dataKey,I.MapNormalCard);if(this.title.text=""+t.cardName,t)switch(t.cardType){case d[d.People]:this.playerBox.visible=!0,this.otherBox.visible=!1,this.more.visible=!0,this.clickOpenType=1;let e=j.instance.heroItems[this.dataKey];this.skillPoint.text="可用属性点:"+e.curStat.skillAmout,this.talkAttr.text=e.curStat.talkAbility+"/"+e.curStat.talkMaxAbility,this.gameAttr.text=e.curStat.gameAbility+"/"+e.curStat.gameMaxAbility,this.talentAttr.text=e.curStat.talentAbility+"/"+e.curStat.talentMaxAbility,this.cuteAttr.text=e.curStat.cuteAbility+"/"+e.curStat.cuteMaxAbility,this.talkAttrPg2.width=e.curStat.talkProficiency*(this.talkAttrPg1.width-4)/e.curStat.talkMaxProficiency,this.gameAttrPg2.width=e.curStat.gameProficiency*(this.gameAttrPg1.width-4)/e.curStat.gameMaxProficiency,this.talentAttrPg2.width=e.curStat.talentProficiency*(this.talentAttrPg1.width-4)/e.curStat.talentMaxProficiency,this.cuteAttrPg2.width=e.curStat.cuteProficiency*(this.cuteAttrPg1.width-4)/e.curStat.cuteMaxProficiency;let a=T.instance.get(this.dataKey,I.MapNormalCard);a&&(this.cureLb.visible=a.IsWeak>0,a.IsWeak==y.Minor?this.cureLb.text="轻伤/治愈中...":a.IsWeak==y.Seriously?this.cureLb.text="重伤/治愈中...":a.IsWeak==y.Dying&&(this.cureLb.text="濒死/治愈中...")),this.more.text="点击查看详情";break;case d[d.Animal]:case d[d.Enemy]:this.playerBox.visible=!1,this.otherBox.visible=!0,this.level.visible=!0,this.more.visible=!0,this.clickOpenType=1,this.desc.text=""+t.cardDesc,this.level.text=(t.cardType==d[d.Animal]?"动物等级:":"敌方等级:")+t.cardLevel,this.more.text="点击查看详情";break;case d[d.Weapon]:this.playerBox.visible=!1,this.otherBox.visible=!0,this.level.visible=!0,this.more.visible=!0,this.clickOpenType=1,this.desc.text=""+t.cardDesc,this.level.text="武器等级:"+t.cardLevel,this.more.text="点击查看详情";break;case d[d.Place]:this.playerBox.visible=!1,this.otherBox.visible=!0,this.level.visible=!0,this.more.visible=!1,this.desc.text=""+t.cardDesc,this.level.text="秘境等级:"+t.cardLevel;break;case d[d.MechantEvent]:this.playerBox.visible=!1,this.otherBox.visible=!0,this.level.visible=!1,this.more.visible=!1,this.clickOpenType=2,this.desc.text=""+t.cardDesc;break;default:this.playerBox.visible=!1,this.otherBox.visible=!0,this.level.visible=!1,this.more.visible=!1,this.desc.text=""+t.cardDesc}}clear(){this.removeEvent(),this.isShow&&Laya.Tween.to(this.box,{y:Laya.stage.height+this.box.height*this.box.scaleY},this.maxTime,Laya.Ease.backIn,new Laya.Handler(this,()=>{this.visible=!1}))}addEvent(){D.on(r.CloseTopItemDetails,this,this.OnCloseItemDetails),this.more.on(Laya.Event.CLICK,this,this.OnOpenDetails)}removeEvent(){D.off(r.CloseTopItemDetails,this,this.OnCloseItemDetails),this.more.off(Laya.Event.CLICK,this,this.OnOpenDetails)}OnOpenDetails(t){this.more.visible&&(t.stopPropagation(),1==this.clickOpenType?ke.instance.layerDialog.onDialogMessageShow(this.dataKey):this.clickOpenType)}OnCloseItemDetails(t){a.log("OnCloseItemDetails:",this.dataKey,t),this.dataKey==t&&this.onShow(!1,null)}}class De extends Laya.Script{get ID(){return this.data.ID}get entity(){return this.owner}get RigidBody(){return this.owner.getComponent(Laya.RigidBody)}get BoxCollider(){return this.owner.getComponent(Laya.BoxCollider)}get x(){return this.entity.x}set x(t){this.entity.x=t}get y(){return this.entity.y}set y(t){this.entity.y=t}static create(t,e,a){return new Promise(i=>{Laya.loader.load("prefab/CardHolder.json",Laya.Handler.create(this,r=>{let s=new Laya.Prefab;s.json=r;let o=Laya.Pool.getItemByCreateFun("CardHolder",s.create,s),n=o.addComponent(De);n.init(e,a),n.setXY(t[0],t[1]),Ae.instance.cardParent.addChild(o),i(n)}))})}init(t,e){a.log("init"),this.data=t,e?(this.curStat=e,this.key=e.key):(this.key=z.generateUUID(),T.instance.set(this.key,{key:this.key,id:this.data.ID},I.MapHolderCard,!1),this.curStat=T.instance.get(this.key,I.MapHolderCard),T.instance.save()),this.setUI(),this.showRig(!1),this.dragMovingStartPos=new Laya.Point,this.mouseStartPos=new Laya.Point,this.isStartDraging=!1,this.isStartDragMoved=!1,this.entity.alpha=0}setXY(...t){let e=t[0],a=t[1];this.entity.pos(e,a)}saveXY(){this.curStat&&(this.curStat.posX=this.x,this.curStat.posY=this.y,a.log("saveXY:",this.key,this.x,this.y),T.instance.save())}setUI(){this.cardShadow=this.entity.getChildByName("card_shadow"),this.cardFront=this.entity.getChildByName("card_front");let t=this.cardFront.getChildByName("card_box");this.cardCount=this.cardFront.getChildByName("card_count");let e=t.getChildByName("card_name"),a=t.getChildByName("card_icon");e.text=this.data.Name,a.skin=""!==this.data.Icon&&this.data.Icon?this.data.Icon:"Icon/init_icon2.png",this.curStat.remainCount||(this.curStat.remainCount=this.data.Amout),this.cardCount.text=this.curStat.remainCount+"",t.offAll(),t.on(Laya.Event.MOUSE_DOWN,this,this.OnMouseDown),t.on(Laya.Event.MOUSE_MOVE,this,this.OnMouseMove),t.on(Laya.Event.MOUSE_UP,this,this.OnMouseUp)}OnMouseDown(t){t.stopPropagation(),this.isStartDraging=!0,this.isStartDragMoved=!1,this.mouseStartPos.x=t.stageX,this.mouseStartPos.y=t.stageY,this.showShadow(!0),this.showRig(!1)}OnMouseMove(t){if(t.stopPropagation(),!this.isStartDraging)return;let e=t.stageX,a=t.stageY;var i=e-this.mouseStartPos.x,r=a-this.mouseStartPos.y;this.isStartDragMoved||new Laya.Point(i,r).distance(0,0)>1&&(this.dragMovingStartPos.set(this.mouseStartPos.x-this.x,this.mouseStartPos.y-this.y),this.isStartDragMoved=!0,Laya.timer.frameLoop(1,this,this.OnMove))}OnMouseUp(t){t.stopPropagation(),this.isStartDraging&&(this.isStartDragMoved?a.log("移动完毕holder"):(a.log("点击完毕holder"),this.clickToNewCard()),this.OnFreed())}OnMove(){if(!this.isStartDraging)return;if(!this.isStartDragMoved)return;let t=[Laya.stage.mouseX-this.dragMovingStartPos.x,Laya.stage.mouseY-this.dragMovingStartPos.y];Ae.instance.checkBoundary(t)||this.setXY(t[0],t[1])}OnFreed(){a.log("释放holder"),Laya.timer.clear(this,this.OnMove),this.showShadow(!1),this.isStartDraging=!1,this.isStartDragMoved=!1}syncOrder(){this.entity.zOrder=this.y+this.entity.height}showShadow(t){t?(this.entity.zOrder=9999,Laya.Tween.to(this.cardShadow,{x:this.cardShadow.width/2+1.5,y:this.cardShadow.height/2+1.5},50,Laya.Ease.sineOut),Laya.Tween.to(this.cardFront,{x:this.cardFront.width/2-1.5,y:this.cardFront.height/2-1.5},50,Laya.Ease.sineOut)):(this.syncOrder(),Laya.Tween.to(this.cardShadow,{x:this.cardShadow.width/2,y:this.cardShadow.height/2},50,Laya.Ease.sineOut),Laya.Tween.to(this.cardFront,{x:this.cardFront.width/2,y:this.cardFront.height/2},50,Laya.Ease.sineOut))}showRig(t){this.RigidBody.enabled=!1,this.BoxCollider.enabled=!1,t&&this.saveXY()}clickToNewCard(){let t=this.data.IncludeCard,e=this.data.IncludeProbability[this.data.Amout-this.curStat.remainCount],i=0,r=t[i=z.randomOneByTradition(e)],s=[this.x+12,this.y+13],o=[],n=[this.x+this.entity.width/2+9,this.y+this.entity.height/2-16],h=z.PolarToCartesian(360*this.curStat.remainCount/this.data.Amout-90,A.radiusGenerge2);o=[s[0]+h.x,s[1]+h.y],a.log("dududu:",s,o),Ae.instance.generateGroup(!1,r,A.radiusGenerge2,s,n,o,-1),this.curStat.remainCount-=1,this.cardCount.text=""+this.curStat.remainCount,this.curStat.remainCount<=0?(Ae.instance.holderCardArray.remove(this),this.dispose()):T.instance.save()}dispose(){T.instance.delete(this.key,I.MapHolderCard),T.instance.save(),Laya.timer.clear(this,this.OnMove),this.showRig(!1),this.entity.removeSelf(),Laya.Pool.recover("CardHolder",this.entity)}}class Ae{constructor(){this.gameStep=0,this.mixBookRes=null,this.saveMixDataSO=null,this.saveCardDataSO=null,this.saveEquipDataSO=null,this.funCardRes=null,this.funCardArray=[],this.normalCardRes=null,this.normalCardGroupArray=[],this.holderCardRes=null,this.holderCardArray=[],this.specailWeaponRes=null,this.gainBattleRes=null,this.mechantFunCardRes=null,this.isDealingBreakQueue=!1,this.breakQueue=[],this.isStartupTemp=!1,this.readyAddCoin=0,this.readyBuyHolder=-1,this.hasMechantEvent=!1,this.maxPopulation=0,this.maxCard=0,this.currentCard=0,this.currentFood=0,this.currentCoin=0,this.currentPopulation=0,this.costFood=0,this.currentFans=0,this.currentGifts=0,this.makingGifts=0,this.currentWordlessBook=0,this.mainPlayer=null}static get instance(){return Ae._instance||(Ae._instance=new Ae),Ae._instance}init(){this.dragMovingStartPos=new Laya.Point,this.mouseStartPos=new Laya.Point,this.isStartDraging=!1,this.isStartDragMoved=!1,this.funCardRes=E.instance.select(L.FunCard).asDict,this.normalCardRes=E.instance.select(L.NormalCard).asDict,this.mixBookRes=E.instance.select(L.MixBook).asDict,this.holderCardRes=E.instance.select(L.CardHolder).asDict,this.specailWeaponRes=E.instance.select(L.MixWeapon).asDict,this.gainBattleRes=E.instance.select(L.BattleGain).asDict,this.mechantFunCardRes=E.instance.select(L.MechantFunCard).asDict}initRepeat(t){this.cardParent=ke.instance.layerMap,this.tempDragGroup=new st(!0),this.tempDragGroup.createRender([-1e3,-200]).then(()=>{this.tempDragGroup.render.entity.visible=!1,this.tempDragGroup.render.showRig(!1),this.tempDragGroup.render.showShadowEnabled(!0),this.tempDragGroup.render.entity.zOrder=0}),this.isStartupTemp=!1,this.saveMixDataSO=T.instance.get("SaveMixDataSO",I.GameItems)||{},this.funCardArray=[],this.normalCardGroupArray=[],this.holderCardArray=[],this.isStartDraging=!1,this.isStartDragMoved=!1,this.mouseStartPos.set(0,0),this.dragMovingStartPos.set(0,0),this.selectDragGroup=null,this.saveCardDataSO=T.instance.get("SaveCardDataSO",I.GameItems)||{},this.saveEquipDataSO=T.instance.get("SaveEquipDataSO",I.GameItems)||{},this.isDealingBreakQueue=!1,this.breakQueue=[],this.readyAddCoin=0,this.readyBuyHolder=-1,this.hasMechantEvent=!1,this.maxPopulation=A.initPopulation,this.maxCard=A.initCards,this.currentCard=0,this.currentFood=0,this.currentCoin=0,this.currentPopulation=0,this.costFood=0,this.currentFans=0,this.currentGifts=0,this.makingGifts=0,this.currentWordlessBook=0,this.mainPlayer=T.instance.get("MainPlayer",I.GameItems)||{type:0,key:""},this.initFunCard([this.cardParent.sell,this.cardParent.seat1,this.cardParent.seat2,this.cardParent.seat3,this.cardParent.seat4]),t?(this.gameStep=1,this.readGameSave()):(this.gameStep=0,this.setSpecialWeapon(),this.firstCardHolder())}dispose(){if(a.log("gamedispose:"),this.gameStep=2,this.tempDragGroup&&this.tempDragGroup.dispose(),this.tempDragGroup=null,this.isStartupTemp=!1,this.saveMixDataSO={},this.funCardArray.length>0)for(;this.funCardArray.length>0;){this.funCardArray.pop().dispose()}if(this.funCardArray=[],this.normalCardGroupArray.length>0)for(;this.normalCardGroupArray.length>0;){this.normalCardGroupArray.pop().dispose()}if(this.normalCardGroupArray=[],this.holderCardArray.length>0)for(;this.holderCardArray.length>0;){this.holderCardArray.pop().dispose()}this.holderCardArray=[],this.isStartDraging=!1,this.isStartDragMoved=!1,this.mouseStartPos.set(0,0),this.dragMovingStartPos.set(0,0),this.selectDragGroup&&this.selectDragGroup.dispose(),this.selectDragGroup=null,this.saveCardDataSO={},this.saveEquipDataSO={},this.maxPopulation=0,this.maxCard=0,this.currentCard=0,this.currentFood=0,this.currentCoin=0,this.currentPopulation=0,this.costFood=0,this.currentFans=0,this.currentGifts=0,this.makingGifts=0,this.currentWordlessBook=0,this.mainPlayer={},this.readyAddCoin=0,this.readyBuyHolder=-1,this.hasMechantEvent=!1,this.isDealingBreakQueue=!1,this.breakQueue=[]}gameOver(){F.instance.runTime(!1),Laya.timer.once(300,this,()=>{ke.instance.layerDialog.onDialogMapEnd()})}backRepeat(){this.gameStep=1,a.log("backRepeat:",this.costFood)}enabledTempDragGroup(t){t?this.tempDragGroup.render.entity.on(Laya.Event.MOUSE_DOWN,this,this.OnTempMounseDown):this.tempDragGroup.render.entity.off(Laya.Event.MOUSE_DOWN,this,this.OnTempMounseDown),t?this.tempDragGroup.render.entity.on(Laya.Event.MOUSE_MOVE,this,this.OnTempMounseMove):this.tempDragGroup.render.entity.off(Laya.Event.MOUSE_MOVE,this,this.OnTempMounseMove),t?this.tempDragGroup.render.entity.on(Laya.Event.MOUSE_UP,this,this.OnTempMounseUp):this.tempDragGroup.render.entity.off(Laya.Event.MOUSE_UP,this,this.OnTempMounseUp)}initFunCard(t){for(const e in this.funCardRes)if(Object.prototype.hasOwnProperty.call(this.funCardRes,e)){let a=this.funCardRes[e];if(a){let e=t.select(t=>t.name===a.Component);e&&K.create(e,a).then(t=>{this.funCardArray.push(t)})}}}changeFunCard(t,e){if(t){this.hasMechantEvent=!0;let t=T.instance.get(e,I.MapNormalCard);if(t)for(const e in this.mechantFunCardRes)if(Object.prototype.hasOwnProperty.call(this.mechantFunCardRes,e)){let a=this.mechantFunCardRes[e];if(a&&t.cardID==a.MechantEventID){let t=a.Amout,e=[];if(a.IncludeCard<=t)e=a.IncludeCard;else{let i=z.randomSomeByOriginalSort(a.IncludeFunProbability,t);for(let t=0;t<i.length;t++){const r=i[t];e.push(a.IncludeFunCard[r.originIdx])}}let i=[this.cardParent.seat5,this.cardParent.seat6,this.cardParent.seat7];i.length=i.length>t?t:i.length;for(let t=0;t<e.length;t++){const a=e[t];let r=this.funCardRes[a];if(r){let t=i.select(t=>t.name===r.Component);t&&K.create(t,r).then(t=>{this.funCardArray.push(t)})}}break}}}else for(this.hasMechantEvent=!1;this.funCardArray.length>5;){this.funCardArray.pop().dispose()}}firstCardHolder(){let t=this.holderCardRes[10001];De.create([Laya.stage.width/2-60,Laya.stage.height/2-75],t).then(e=>{a.log("firstCardHolder",t,e.x,e.y,e),e.entity.alpha=1,e.showRig(!0),this.holderCardArray.push(e)})}createHolderCard(t,e,a){let i=this.holderCardRes[a];De.create(t,i).then(t=>{Laya.Tween.to(t.entity,{x:e[0],y:e[1],alpha:1},250,Laya.Ease.sineOut,new Laya.Handler(this,()=>{t.showRig(!0)})),this.holderCardArray.push(t)})}createGroupCard(t,e,i,r,s,o=null,n=[]){let h=this.normalCardRes[s];a.log("stat:",e);let l=new at(h,!0,o,n);l.createRender(e,t).then(()=>{let t=new st;t.data.addGroup(l),this.createGroupCardSimple(e,i,r,t)})}createGroupCardSimple(t,e,a,i){i.createRender(t).then(()=>{ke.instance.layerEffect.sceneGame.createBoomAni(a),this.skeletonCreateGroup(!0,e,i)})}skeletonCreateGroup(t,e,a,i=250){a.render.entity.zOrder=1e4,t?(a.render.entity.alpha=.5,Laya.Tween.to(a.render.entity,{alpha:1,x:e[0],y:e[1]},i,Laya.Ease.sineOut,new Laya.Handler(this,()=>{a.render.showRig(!0),a.render.showShadowEnabled(!0),a.render.syncOrder()}))):(a.render.showRig(!0),a.render.showShadowEnabled(!0),a.render.syncOrder()),a.flushRender(),this.addNormalGroupCardArr(a)}addGroupCard(t,e,a,i,r,s,o=null,n=[]){let h=this.normalCardRes[r],l=new at(h,!0,o,n),c=this.normalCardGroupArray[s];l.createRender(e,t).then(()=>{ke.instance.layerEffect.sceneGame.createBoomAni(i),l.render.entity.zOrder=1e4+e[1],l.render.entity.alpha=.5,Laya.Tween.to(l.render.entity,{alpha:1,x:a[0],y:a[1]},250,Laya.Ease.sineOut,new Laya.Handler(this,()=>{c.data.addGroup(l),c.flushRender(),this.checkMixAndCutBook()}))})}clearGroupCard(t){this.normalCardGroupArray.remove(t),this.flushGroupClick(),t.dispose(),a.log("clearGroupCard:",this.normalCardGroupArray)}addNormalGroupCardArr(t){this.normalCardGroupArray.push(t),this.flushGroupClick()}flushGroupClick(){for(let t=0;t<this.normalCardGroupArray.length;t++){let e=this.normalCardGroupArray[t].render.entity;e.offAll(),e.on(Laya.Event.MOUSE_DOWN,this,this.OnMounseDown,[t]),e.on(Laya.Event.MOUSE_MOVE,this,this.OnMounseMove,[t]),e.on(Laya.Event.MOUSE_UP,this,this.OnMounseUp,[t])}}OnMounseDown(t,e){e.stopPropagation();let a=this.normalCardGroupArray[t],i=a.data.cardList.length,r=Math.floor((e.stageY-a.render.y)/rt.lineHeightSpacing)>=i-1?i-1:Math.floor((e.stageY-a.render.y)/rt.lineHeightSpacing);if(!(a.render.bounceEnabled||a.data.checkTwoTypeCard(d.Building,d.Animal)&&0!=r&&i-r>1))if(this.theSameDown(e),this.selectDragGroup=a,0!=r){this.isStartupTemp=!0;let e=[a.render.x,a.render.y+r*rt.lineHeightSpacing],s=a.data.spliteGroupFromFront(i-r);this.tempDragGroup.data.concat(s),this.tempDragGroup.render.setXY(e[0],e[1]),this.tempDragGroup.render.entity.visible=!0,this.tempDragGroup.flushRender(),this.tempDragGroup.render.showRig(!1),this.tempDragGroup.render.showShadow(!0),this.checkTargetWithGroup(this.tempDragGroup,t),this.selectDragGroup.flushRender(),this.selectDragGroup.render.refreshColl(),this.selectDragGroup.render.entity.offAll(),this.enabledTempDragGroup(!0)}else this.selectDragGroup.render.showShadow(!0),this.selectDragGroup.render.showRig(!1),this.checkTargetWithGroup(this.selectDragGroup,t)}OnMounseMove(t,e){let a,i;if(e.stopPropagation(),this.isStartupTemp){if(!this.tempDragGroup)return;a=this.mouseStartPos.x-this.tempDragGroup.render.x,i=this.mouseStartPos.y-this.tempDragGroup.render.y}else{if(!this.selectDragGroup)return;a=this.mouseStartPos.x-this.selectDragGroup.render.x,i=this.mouseStartPos.y-this.selectDragGroup.render.y}this.theSameMove(e,a,i)}OnMounseUp(t,e){e.stopPropagation(),this.isStartDraging&&(this.isStartDragMoved?this.checkBottomCardWithGroup(this.selectDragGroup,[e.stageX,e.stageY]):(this.checkSpitoutSave(t),Be.instance.onShow(!0,this.selectDragGroup.data.cardList[this.selectDragGroup.data.cardList.length-1].data.key)),this.OnFreed())}OnMounseOver(t,e){a.log("OnMouseOver"),Be.instance.onShow(!0,this.normalCardGroupArray[this.normalCardGroupArray.length-1].data.cardList[this.normalCardGroupArray[this.normalCardGroupArray.length-1].data.cardList.length-1].data.key)}OnMounseOut(t,e){a.log("OnMouseOut"),Be.instance.onShow(!1,null)}OnTempMounseDown(t){t.stopPropagation(),this.theSameDown(t)}OnTempMounseMove(t){t.stopPropagation(),this.theSameMove(t,this.mouseStartPos.x-this.tempDragGroup.render.x,this.mouseStartPos.y-this.tempDragGroup.render.y)}OnTempMounseUp(t){t.stopPropagation(),this.isStartDraging&&(this.isStartDragMoved?this.checkBottomCardWithGroup(this.tempDragGroup,[t.stageX,t.stageY]):Be.instance.onShow(!0,this.tempDragGroup.data.cardList[this.tempDragGroup.data.cardList.length-1].data.key),this.OnFreed())}theSameDown(t){this.isStartDraging=!0,this.isStartDragMoved=!1,this.mouseStartPos.x=t.stageX,this.mouseStartPos.y=t.stageY,this.normalCardGroupArray.forEach(t=>{t.render.refreshColl()})}theSameMove(t,e,a){if(!this.isStartDraging)return;let i=t.stageX,r=t.stageY;var s=i-this.mouseStartPos.x,o=r-this.mouseStartPos.y;this.isStartDragMoved||new Laya.Point(s,o).distance(0,0)>0&&(this.dragMovingStartPos.set(e,a),this.isStartDragMoved=!0,Laya.timer.frameLoop(1,this,this.OnMove))}OnMove(){if(this.isStartDraging&&this.isStartDragMoved&&this.selectDragGroup){let t=[Laya.stage.mouseX-this.dragMovingStartPos.x,Laya.stage.mouseY-this.dragMovingStartPos.y];this.checkStageBoundary(t)||(this.isStartupTemp?(this.tempDragGroup.render.setXY(t[0],t[1]),t[1]>=Laya.stage.height-100&&!this.tempDragGroup.render.shrinkEnabled?this.tempDragGroup.render.showShrink(!0,Laya.stage.mouseY):t[1]<Laya.stage.height-100&&this.tempDragGroup.render.shrinkEnabled&&this.tempDragGroup.render.showShrink(!1,Laya.stage.mouseY)):(this.selectDragGroup.render.setXY(t[0],t[1]),t[1]>=Laya.stage.height-100&&!this.selectDragGroup.render.shrinkEnabled?this.selectDragGroup.render.showShrink(!0,Laya.stage.mouseY):t[1]<Laya.stage.height-100&&this.selectDragGroup.render.shrinkEnabled&&this.selectDragGroup.render.showShrink(!1,Laya.stage.mouseY)))}}OnFreed(){if(a.log("释放"),Laya.timer.clear(this,this.OnMove),this.selectDragGroup){if(this.isStartupTemp){let t=!0;if(this.tempDragGroup.data.cardList.length>0){this.tempDragGroup.render.y>=Laya.stage.height-100&&(this.tempDragGroup.render.setXY(this.tempDragGroup.render.x,Laya.stage.height-100-this.tempDragGroup.render.initHeight-(this.tempDragGroup.render.cardFront.numChildren-1)*rt.lineHeightSpacing),this.selectDragGroup.flushRender());let e=this.checkCollisionGroupWithGroup(Ae.ManualControl,this.tempDragGroup);e!=m.Coll&&e!=m.Save&&e!=m.Equip||(t=!1)}else t=!1;this.groupToNewGroup(t,this.tempDragGroup),this.isStartupTemp=!1}else if(this.selectDragGroup.data.cardList.length>0){this.selectDragGroup.render.y>=Laya.stage.height-100&&(this.selectDragGroup.render.setXY(this.selectDragGroup.render.x,Laya.stage.height-100-this.selectDragGroup.render.initHeight-(this.selectDragGroup.render.cardFront.numChildren-1)*rt.lineHeightSpacing),this.selectDragGroup.flushRender()),this.selectDragGroup.render.showShadow(!1),this.selectDragGroup.render.showRig(!0);let t=this.checkCollisionGroupWithGroup(Ae.ManualControl,this.selectDragGroup);t!=m.Coll&&t!=m.Save&&t!=m.Equip||this.checkMixAndCutBook()}else this.normalCardGroupArray.remove(this.selectDragGroup),this.selectDragGroup.dispose();a.log("OnFreed:",this.normalCardGroupArray)}this.normalCardGroupArray.forEach(t=>{t.render.showSeleteLine(!1)}),this.clearSelectGroup(),this.holderCardArray.length>0&&this.holderCardArray.forEach(t=>{t.OnFreed()}),this.readyAddCoin>0&&(this.addCoinGroup(),this.readyAddCoin=0),this.readyBuyHolder>-1&&(this.funCardArray[this.readyBuyHolder].gashapon(),this.readyBuyHolder=-1)}clearSelectGroup(){this.selectDragGroup=null,this.isStartDraging=!1,this.isStartDragMoved=!1,this.flushGroupClick()}groupToNewGroup(t,e){let a=[e.render.entity.x,e.render.entity.y];if(t){e.data.cardList.forEach(t=>{t.recoverState()});let t=new st;t.data.concat(e.data),t.createRender(a).then(()=>{this.skeletonCreateGroup(!1,[],t),this.checkMixAndCutBook()})}else this.checkMixAndCutBook();e.render.showShadow(!1),e.render.setXY(-1e3,-200),e.render.entity.visible=!1,e.render.showRig(!1),this.enabledTempDragGroup(!1)}checkOverlay(t,e,a,i,r){let s=t.data.cardList[t.data.cardList.length-1].data;if(10027==t.data.cardList[0].data.curStat.cardID)return!1;if(s.curStat.cardType==e&&1==s.curStat.IsOverlay&&1==a&&1==s.curStat.SameOverlay&&1==i){if(e==d[d.Coin]||e==d[d.Food])return!0;if(s.curStat.cardID==r)return!0}return!1}checkCollisionGroupWithGroup(t,e){for(let a=0;a<this.normalCardGroupArray.length;a++){let r=this.normalCardGroupArray[a];if(e!=this.normalCardGroupArray[a]&&t!=Ae.OpenBag&&e.render.collBoxTwo.intersectsBox(r.render.collBoxTwo)&&i.Abs(e.render.x-r.render.x)<=2*r.render.entity.width/3){let t=!1;if(""!=r.data.cardList[r.data.cardList.length-1].data.curStat.IsSave){let t=d[r.data.cardList[r.data.cardList.length-1].data.curStat.IsSave];if(e.data.checkOneTypeCard(t)){let a=e.data.spliteGroupFromType(t);if(a.cardList.length>0){for(let t=0;t<a.cardList.length;t++){let e=a.cardList[t];this.saveCardDataSO[e.data.key]={key:e.data.key,id:e.data.curStat.cardID},r.data.cardList[r.data.cardList.length-1].setSaveBox(e.data.key)}return T.instance.set("SaveCardDataSO",this.saveCardDataSO,I.GameItems,!1),T.instance.save(),a.dispose(!0),this.isStartupTemp||(this.normalCardGroupArray.remove(e),this.flushGroupClick(),e.dispose()),m.Save}}}if(!t&&10026==r.data.cardList[0].data.curStat.cardID&&r.data.cardList.length<=A.animalTameAmout&&e.data.checkOneTypeCard(d.Animal))for(let a=0;a<e.data.cardList.length;a++){e.data.cardList[a].setTame(1),t=!0;break}if(t||(r.data.cardList[r.data.cardList.length-1].data.curStat.cardType!=d[d.Animal]||0!=r.data.cardList[r.data.cardList.length-1].data.curStat.IsTame)&&r.data.cardList[r.data.cardList.length-1].data.curStat.cardType!=d[d.Enemy]||!e.data.checkOneTypeCard(d.People)||e.data.checkIsWeakCard()||(t=!0,Wt.instance.setBattle(r.data.cardList[r.data.cardList.length-1].data.curStat.cardType,e.data.cardList[0].data.key,r.data.cardList[r.data.cardList.length-1].data.key)),t||!e.data.checkOneTypeCard(d.People)||r.data.cardList[r.data.cardList.length-1].data.curStat.cardType!=d[d.Place]||e.data.checkIsWeakCard()||(t=!0,Wt.instance.setBattle(r.data.cardList[r.data.cardList.length-1].data.curStat.cardType,e.data.cardList[0].data.key,r.data.cardList[r.data.cardList.length-1].data.key)),!t&&1==e.data.cardList.length&&e.data.checkOneTypeCard(d.Weapon)&&r.data.cardList[r.data.cardList.length-1].data.curStat.cardType==d[d.People]){t=!0;let a=e.data.spliteGroupFromFront(1);if(a.cardList.length>0){if(r.data.cardList[r.data.cardList.length-1].data.curStat.saveEquipArr.length>0){let t=r.data.cardList[r.data.cardList.length-1].data.curStat.saveEquipArr.splice(0,1)[0];this.addWeaponGroup(t,[r.render.x,r.render.y],[r.render.x+r.render.entity.width/2,r.render.y+r.render.entity.height/2],this.normalCardGroupArray.indexOf(e)),delete this.saveEquipDataSO[t]}return this.saveEquipDataSO[a.cardList[0].data.key]={key:a.cardList[0].data.key,id:a.cardList[0].data.curStat.cardID,level:a.cardList[0].data.curStat.cardLevel},r.data.cardList[r.data.cardList.length-1].setSaveEquip(a.cardList[0].data.key),T.instance.set("SaveEquipDataSO",this.saveEquipDataSO,I.GameItems,!1),T.instance.save(),a.dispose(!0),this.isStartupTemp||(this.normalCardGroupArray.remove(e),this.flushGroupClick(),e.dispose()),m.Equip}}if(e.data.checkIsWeakCard()||r.data.checkIsWeakCard())return m.NoColl;if(t||(t=this.checkOverlay(r,e.data.cardList[0].data.curStat.cardType,e.data.cardList[0].data.curStat.IsOverlay,e.data.cardList[0].data.curStat.SameOverlay,e.data.cardList[0].data.curStat.cardID)),!t)for(const a in this.mixBookRes)if(Object.prototype.hasOwnProperty.call(this.mixBookRes,a)){let i=this.mixBookRes[a];if(i&&1==i.IsShow){let a=i.Material.filter(t=>0!=t),s=-1,o=-1;for(let t=0;t<a.length;t++){let i=a[t];(i==e.data.cardList[0].data.curStat.cardID||i<0&&1==e.data.cardList.length&&1==e.data.cardList[0].data.curStat.IsSell&&""==e.data.cardList[0].data.curStat.IsSave&&1==r.data.cardList.length)&&-1==s?s=t:i==r.data.cardList[r.data.cardList.length-1].data.curStat.cardID&&-1==o&&(o=t)}if(-1!=s&&-1!=o){t=!0;break}}}if(t){let t=[r.render.x,r.render.y];this.isStartupTemp?(r.data.concat(e.data),r.render.setXY(t[0],t[1]),r.flushRender()):(this.normalCardGroupArray.remove(e),this.flushGroupClick(),r.data.concat(e.data),r.render.setXY(t[0],t[1]),r.flushRender(),e.dispose())}return t?m.Coll:m.NoColl}}return m.NoColl}checkDistanceWithGroup(t,e,a,r){let s=this.normalCardRes[t],o=i.Infinity,n=i.Infinity,h=-1,l=-1,c=0;for(let i=0;i<this.normalCardGroupArray.length;i++){if(i==r)continue;let d=!1,p=this.normalCardGroupArray[i];if(10027==p.data.cardList[0].data.curStat.cardID)continue;let f=new Laya.Point(p.render.x,p.render.y),m=new Laya.Point(p.render.x+p.render.entity.width,p.render.y+p.render.entity.height);if(new k(f,m).intersectsCircle(new Laya.Point(a[0],a[1]),e)&&(""!=p.data.cardList[p.data.cardList.length-1].data.curStat.IsSave?p.data.cardList[p.data.cardList.length-1].data.curStat.IsSave===s.Type&&(d=!0,c=1):d=this.checkOverlay(p,s.Type,s.IsOverlay,s.SameOverlay,t),d)){let t=f.distance(a[0],a[1]),e=m.distance(a[0],a[1]),r=t>=e?e:t;c?n>r&&(n=r,l=i):o>r&&(o=r,h=i)}}return[c,c?l:h]}checkTargetWithGroup(t,e){for(let a=0;a<this.normalCardGroupArray.length;a++){if(e==a)continue;let i=this.normalCardGroupArray[a];if(t!=this.normalCardGroupArray[a]){let e=!1;if(!e&&""!=i.data.cardList[i.data.cardList.length-1].data.curStat.IsSave){let a=d[i.data.cardList[i.data.cardList.length-1].data.curStat.IsSave];t.data.checkOneTypeCard(a)&&(e=!0)}if(!e&&10026==i.data.cardList[0].data.curStat.cardID&&i.data.cardList.length<=A.animalTameAmout&&t.data.checkOneTypeCard(d.Animal)&&(e=!0),!e&&(i.data.cardList[i.data.cardList.length-1].data.curStat.cardType==d[d.Animal]&&0==i.data.cardList[i.data.cardList.length-1].data.curStat.IsTame||i.data.cardList[i.data.cardList.length-1].data.curStat.cardType==d[d.Enemy])&&t.data.checkOneTypeCard(d.People)&&(e=!0),!e&&t.data.checkOneTypeCard(d.People)&&i.data.cardList[i.data.cardList.length-1].data.curStat.cardType==d[d.Place]&&(e=!0),!e&&1==t.data.cardList.length&&t.data.checkOneTypeCard(d.Weapon)&&i.data.cardList[i.data.cardList.length-1].data.curStat.cardType==d[d.People]&&(e=!0),e||(e=this.checkOverlay(i,t.data.cardList[0].data.curStat.cardType,t.data.cardList[0].data.curStat.IsOverlay,t.data.cardList[0].data.curStat.SameOverlay,t.data.cardList[0].data.curStat.cardID)),!e)for(const a in this.mixBookRes)if(Object.prototype.hasOwnProperty.call(this.mixBookRes,a)){let r=this.mixBookRes[a];if(r&&1==r.IsShow){let a=r.Material.filter(t=>0!=t),s=-1,o=-1;for(let e=0;e<a.length;e++){let r=a[e];(r==t.data.cardList[0].data.curStat.cardID||r<0&&1==t.data.cardList.length&&1==t.data.cardList[0].data.curStat.IsSell&&""==t.data.cardList[0].data.curStat.IsSave&&1==i.data.cardList.length)&&-1==s?s=e:r==i.data.cardList[i.data.cardList.length-1].data.curStat.cardID&&-1==o&&(o=e)}if(-1!=s&&-1!=o){e=!0;break}}}e&&(t.data.checkIsWeakCard()||i.data.checkIsWeakCard()||i.render.showSeleteLine(!0))}}}checkStageBoundary(t){let e=Laya.stage.height,a=Laya.stage.width-48;return t[0]<0||t[0]>a||t[1]>e||t[1]<0}checkBoundary(t){let e=Laya.stage.height-60,a=Laya.stage.width-48;return t[0]<0||t[0]>a||t[1]>e||t[1]<0}checkMixAndCutBook(){if(this.saveMixDataSO&&this.saveMixDataSO!={})for(let t in this.saveMixDataSO)if(Object.prototype.hasOwnProperty.call(this.saveMixDataSO,t)&&this.saveMixDataSO[t]){let e=!1,a=this.saveMixDataSO[t].materialKey;for(let t=0;t<this.normalCardGroupArray.length;t++){let i=this.normalCardGroupArray[t],r=[];if(i.data.cardList.forEach(t=>{r.push(t.data.key)}),r.intersect(a).equals(a)){e=!0;break}}e||(D.event(r.CallInterruptProduce,[a]),delete this.saveMixDataSO[t],T.instance.set("SaveMixDataSO",this.saveMixDataSO,I.GameItems,!1),T.instance.save())}for(let t=0;t<this.normalCardGroupArray.length;t++){let e=this.normalCardGroupArray[t];this.checkMixBookItem(e)}}checkMixBookItem(t){let e=!1;for(const i in this.mixBookRes)if(Object.prototype.hasOwnProperty.call(this.mixBookRes,i)){let s=this.mixBookRes[i];if(s&&1==s.IsShow){let i=s.Material.filter(t=>0!=t),o=[],n=[];if(1==s.IsHomology&&i.length!=t.data.cardList.length)continue;for(let a=0;a<t.data.cardList.length;a++){let r=[];for(let s=0;s<i.length;s++){let o=i[s];for(let i=a;i<t.data.cardList.length;i++){if(r.contains(i))continue;let a=t.data.cardList[i];if(a.data.curStat.IsProduction&&(e=!0),a.data.curStat.cardID==o||o<0){r.push(i);break}}}r.sort((t,e)=>t-e),r.length==i.length&&o.push(r)}for(let t=0;t<o.length;t++){let e=o[t],a=!0,i=e[0];for(let t=0;t<e.length;t++){if(e[t]!=i){a=!1;break}i++}if(a){n=e;break}}if(n.length>0){let i=z.generateUUID(),o=[];n.forEach(e=>{o.push(t.data.cardList[e].data.key)});let h=!1;if(this.saveMixDataSO&&this.saveMixDataSO!={})for(let t in this.saveMixDataSO)Object.prototype.hasOwnProperty.call(this.saveMixDataSO,t)&&this.saveMixDataSO[t]&&(h=o.equals(this.saveMixDataSO[t].materialKey));a.log("saveMixDataSO6:",h,e),h||e||(a.log("saveMixDataSO1:",i,o,s.ID),D.event(r.CallStartProduce,[i,o,s.ID]),this.saveMixDataSO[i]={key:i,materialKey:o,bookID:s.ID},T.instance.set("SaveMixDataSO",this.saveMixDataSO,I.GameItems,!1),T.instance.save())}}}}endProduce(t,e,i,s,o){if(this.saveMixDataSO[t]){let n=this.saveMixDataSO[t].bookID,h=this.mixBookRes[n].Products,l=this.mixBookRes[n].ProductsProbability,c=this.mixBookRes[n].Material,d=0,p=0,f=0,m=0,y=0;c.contains(10080)?p=1:c.contains(10081)?p=2:c.contains(10082)?p=3:c.contains(10083)?p=4:c.contains(10078)?f=10078:c.contains(10141)?f=10141:c.contains(10142)?f=10142:c.contains(10143)?f=10143:c.contains(10144)?f=10144:c.contains(10008)?y=1:c.contains(10027)&&(m=1);let u=h[d=z.randomOneByTradition(l)],g=this.getEndPos(e,s),b=0;for(b=0;b<this.normalCardGroupArray.length;b++){if(this.normalCardGroupArray[b].data.cardList.filter(t=>t.data.key==o).length>0)break}if(0!=p){ke.instance.layerEffect.sceneGame.createAddSt(i,.5);let r=null;for(let e=0;e<this.saveMixDataSO[t].materialKey.length;e++){let i=this.saveMixDataSO[t].materialKey[e];j.instance.heroItems[i]&&(r=j.instance.heroItems[i],a.log("isLive:",r))}let o=[],n=[10,10,10,10];r.curStat.talkAbility>=r.curStat.talkMaxAbility&&(n[0]=0),r.curStat.gameAbility>=r.curStat.gameMaxAbility&&(n[1]=0),r.curStat.talentAbility>=r.curStat.talentMaxAbility&&(n[2]=0),r.curStat.cuteAbility>=r.curStat.cuteMaxAbility&&(n[3]=0);let h=r.curStat.talkAbility+r.curStat.gameAbility+r.curStat.talentAbility+r.curStat.cuteAbility,l=[A.addFansInterval[0]*h,A.addFansInterval[1]*h];if(a.log("aaddfan-bilityAmout:",h,A.addFansInterval,l),Qt.instance(Qt).addFans(i,l),n.findIndex(t=>0!=t)>=0){let t=z.randomOneByTradition(n);o=r.setLiveProductRate(h),0==t?r.setTalkProficiency():1==t?r.setGameProficiency():2==t?r.setTalentProficiency():3==t&&r.setCuteProficiency()}let c=0;if(o.forEach(t=>{z.randInt(1,100)<=t&&(c+=1)}),c>0)if(c>1){let t=new st;for(let a=0;a<c;a++)this.generateGroupOther(!1,u,s,a,c,e,i,g,b,t)}else this.generateGroup(!1,u,s,e,i,g,b);else ke.instance.layerEffect.sceneGame.createBoomAni(i);let d=[r.curStat.talkAbility,r.curStat.gameAbility,r.curStat.talentAbility,r.curStat.cuteAbility,60],p=z.randomOneByTradition(d),f=0;switch(a.log("rewardId:",p),p){case 0:f=10113;break;case 1:f=10114;break;case 2:f=10115;break;case 3:f=10116}if(0!=f){let t=[e[0]-g[0]+e[0],e[1]-g[1]+e[1]];this.generateGroup(!1,f,s,e,i,t,b)}Be.instance.refreshUI()}else if(0!=f)this.generateGroup(!1,u,s,e,i,g,b,null,[f]);else if(0!=m){let r=0;for(let e=1;e<c.length;e++){let i=c[e];if(a.log("item:",i,e,c),i<0){let e=this.saveMixDataSO[t].materialKey[1],a=T.instance.get(e,I.MapNormalCard);if(a){-1==i&&(r=Math.floor(1.5*a.cardPrice));break}}}if(r>1){let t=new st;for(let a=0;a<r;a++)this.generateGroupOther(!1,u,s,a,r,e,i,g,b,t)}}else if(0!=y){this.generateGroup(!1,u,s,e,i,g,b);for(let a=0;a<this.saveMixDataSO[t].materialKey.length;a++){let r=this.saveMixDataSO[t].materialKey[a],o=T.instance.get(r,I.MapNormalCard);if(o&&10008==o.id&&1==o.productionNumber){let t=[e[0]-g[0]+e[0],e[1]-g[1]+e[1]];this.generateGroup(!1,10104,s,e,i,t,b);break}}}else this.generateGroup(!1,u,s,e,i,g,b);let S=this.saveMixDataSO[t].materialKey.clone();delete this.saveMixDataSO[t],D.event(r.CallEndProduce,[S]),T.instance.set("SaveMixDataSO",this.saveMixDataSO,I.GameItems,!1),T.instance.save()}}getEndPos(t,e){let a=[0,30,60,90,120,150,180,210,240,270,300,330],i=[],r=0;do{if(++r>10)return i=[Laya.stage.width/2,Laya.stage.height/2];let s=z.PolarToCartesian(a[z.randInt(0,a.length-1)],e);i=[t[0]+s.x,t[1]+s.y]}while(Ae.instance.checkBoundary(i));return i}generateGroup(t,e,a,i,r,s,o,n=null,h=[]){this.skeletonGenerateGroup(t,0,e,a,i,r,s,o,n,h)&&this.createGroupCard(t,i,s,r,e,n,h)}generateGroupOther(t,e,a,i,r,s,o,n,h,l,c=null,d=[]){if(this.skeletonGenerateGroup(t,i,e,a,s,o,n,h,c,d)){let a=new at(this.normalCardRes[e],!0,c,d);a.createRender([s[0],s[1]+i*rt.lineHeightSpacing],t).then(()=>{i==r-1&&(l.data.cardList.length>0?this.createGroupCardSimple(s,n,o,l):l.dispose())}),l.data.addGroup(a)}}skeletonGenerateGroup(t,e,i,r,s,o,n,h,l=null,c=[]){let d=this.checkDistanceWithGroup(i,r,o,h),p=d[0],f=d[1];if(-1!=f){if(a.log("skeletonGenerateGroup:",p,f,this.normalCardGroupArray,h),1==p){let t=this.normalCardRes[i],e=new at(t,!0,l,c);this.saveCardDataSO[e.data.key]={key:e.data.key,id:e.data.curStat.cardID},this.normalCardGroupArray[f].data.cardList[this.normalCardGroupArray[f].data.cardList.length-1].setSaveBox(e.data.key),e.refreshEvent(!0),e.dispose(!0),T.instance.set("SaveCardDataSO",this.saveCardDataSO,I.GameItems,!1),T.instance.save()}else n=[this.normalCardGroupArray[f].render.x,this.normalCardGroupArray[f].render.y+(this.normalCardGroupArray[f].data.cardList.length+e)*rt.lineHeightSpacing],this.addGroupCard(t,[s[0],s[1]+e*rt.lineHeightSpacing],n,o,i,f,l);return!1}return!0}checkSpitoutSave(t){if(""!=this.normalCardGroupArray[t].data.cardList[0].data.curStat.IsSave){let e=this.normalCardGroupArray[t].data.cardList[0].data.curStat.saveCardsArr;if(e.length>0){let a=A.radiusGenerge,i=[this.normalCardGroupArray[t].render.x,this.normalCardGroupArray[t].render.y],r=[this.normalCardGroupArray[t].render.x+this.normalCardGroupArray[t].render.entity.width/2,this.normalCardGroupArray[t].render.y+this.normalCardGroupArray[t].render.entity.height/2],s=this.getEndPos(i,a),o=new st,n=0,h=e.length<5?e.length:5;for(let l=0;l<e.length&&!(n>=h);l++){let c=e[l],d=this.saveCardDataSO[c];d&&(this.generateGroupOther(!0,d.id,a,n,h,i,r,s,t,o),delete this.saveCardDataSO[c],this.normalCardGroupArray[t].data.cardList[0].data.curStat.saveCardsArr.splice(l--,1)),n++}this.normalCardGroupArray[t].data.cardList[0].refreshSaveBox(),T.instance.set("SaveCardDataSO",this.saveCardDataSO,I.GameItems,!1),T.instance.save()}}}checkBottomCardWithGroup(t,e){if(e[1]<this.cardParent.timeBar.y)return"null";a.log("checkBottomCardWithGroup0");for(let i=0;i<this.funCardArray.length;i++){let r=this.funCardArray[i];if(a.log("checkBottomCardWithGroup1",i,r.collBoxTwo.max,r.collBoxTwo.min,e[0],e[1]),r){let s=new Laya.Point(e[0],e[1]);if(r.collBoxTwo.containsPoint(s)){a.log("checkBottomCardWithGroup2",i);let e=[],s=!1,o=!0,n=!1,h=0,l=0;for(let a=0;a<t.data.cardList.length;a++){let i=t.data.cardList[a];"sell"==r.Component&&1==i.data.curStat.IsSell&&(e.push(i),""!=i.data.curStat.IsSave?l+=i.data.curStat.cardLength:l+=i.data.curStat.cardPrice),i.data.curStat.IsProduction&&(s=!0),i.data.curStat.cardType==d[d.Coin]?"sell"==r.Component?(e.push(i),h+=1):e.length<r.Cost&&e.push(i):o=!1,"sell"!=r.Component&&i.data.curStat.IsSave==d[d.Coin]&&i.data.curStat.cardLength>=r.Cost&&(n=!0)}if("sell"==r.Component&&(s||o)?e=[]:"sell"!=r.Component&&(s||!o||e.length<r.Cost)&&(e=[]),e.length>0)return t.data.cardList=t.data.cardList.minus(e),t.flushRender(),e.forEach(t=>{t.dispose(!1)}),"sell"==r.Component?((l>0||h>0)&&(this.readyAddCoin=l+h),!0):(this.readyBuyHolder=i,!0);if(n&&"sell"!=r.Component){for(let e=0;e<r.Cost;e++){let e=t.data.cardList[0].data.curStat.saveCardsArr[t.data.cardList[0].data.curStat.saveCardsArr.length-1];delete this.saveCardDataSO[e],t.data.cardList[0].data.curStat.saveCardsArr.splice(t.data.cardList[0].data.curStat.saveCardsArr.length-1,1)}return t.data.cardList[0].refreshSaveBox(),this.readyBuyHolder=i,T.instance.set("SaveCardDataSO",this.saveCardDataSO,I.GameItems,!1),T.instance.save(),!0}}}}return!1}addCoinGroup(){let t=A.radiusGenerge,e=this.cardParent.sell.localToGlobal(new Laya.Point(0,0)),a=[e.x,e.y],i=[e.x+this.cardParent.sell.width/2,e.y+this.cardParent.sell.height/2],r=[e.x,Laya.stage.height-100-75-(this.readyAddCoin-1)*rt.lineHeightSpacing],s=new st;for(let e=0;e<this.readyAddCoin;e++)this.generateGroupOther(!1,10001,t,e,this.readyAddCoin,a,i,r,-1,s)}addWeaponGroup(t,e,i,r){let s=this.saveEquipDataSO[t];if(a.log("addWeaponGroup:",s,e),s){let t=s.id,a=A.radiusGenerge,o=this.getEndPos(e,a),n={cardLevel:s.level};this.generateGroup(!1,t,a,e,i,o,r,n)}}bounceCard(t){for(let e=0;e<this.normalCardGroupArray.length;e++){let i=this.normalCardGroupArray[e];i.data.cardList.filter(e=>e.data.key==t).length>0&&(!this.isStartDraging||this.isStartDraging&&this.selectDragGroup!=i)&&(a.log("跳",t),i.render.showBounce())}}bornCard(t,e,i){for(let r=0;r<this.normalCardGroupArray.length;r++){let s=this.normalCardGroupArray[r];if(s.data.cardList.filter(e=>e.data.key==t).length>0){a.log("出生",t);let o=A.radiusGenerge,n=[s.render.x,s.render.y],h=[s.render.x+s.render.entity.width/2,s.render.y+s.render.entity.height/2],l=this.getEndPos(n,o),c=0,d=e[c=z.randomOneByTradition(i)];this.generateGroup(!1,d,o,n,h,l,r)}}}endBreaking(t,e,i,r,s){a.log("endBreaking0:",t,e),this.breakQueue.push({target:t,level:e,id:i,startPos:r,effectPos:s}),this.isDealingBreakQueue||this._dealBreakQueue()}_dealBreakQueue(){this.isDealingBreakQueue=!0;let t=this.breakQueue.shift(),e=t.target,i=t.level,r=(t.id,t.startPos),s=t.effectPos;if(e.startsWith(u[u.SummonEnemy])){let t=Number(e.split(u[u.SummonEnemy])[1]);a.log("enemyID:",t);let i=A.radiusGenerge,o=this.getEndPos(r,i);this.generateGroup(!1,t,i,r,s,o,-1)}else{let t=[];for(let a=0;a<this.normalCardGroupArray.length;a++){let i=this.normalCardGroupArray[a],r=[];e.startsWith(u[u.DamageCoin])?r=r.concat(i.data.cardList.filter(t=>t.data.curStat.cardType==d[d.Coin])):e.startsWith(u[u.DamageFood])?r=r.concat(i.data.cardList.filter(t=>t.data.curStat.cardType==d[d.Food])):e.startsWith(u[u.DamageProduct])?r=r.concat(i.data.cardList.filter(t=>t.data.curStat.cardType==d[d.Product])):e.startsWith(u[u.DamageResource])?r=r.concat(i.data.cardList.filter(t=>t.data.curStat.cardType==d[d.Resource])):e.startsWith(u[u.DeductBlood])&&(r=r.concat(i.data.cardList.filter(t=>t.data.curStat.cardType==d[d.People]))),r=r.map((t,e,i)=>({idx:a,chain:t})),t=t.concat(r)}if(a.log("endBreaking1:",e,t),t.length>0){let a=z.randInt(0,t.length-1),r=t[a].chain,s=t[a].idx,o=this.normalCardGroupArray[s],n=!!r.data.curStat.IsProduction;if(ke.instance.layerEffect.sceneGame.createAttack2([o.render.x+r.render.x+r.render.entity.width/2,o.render.y+r.render.y+r.render.entity.height/2],1),e.startsWith(u[u.DeductBlood])){j.instance.heroItems[r.data.key].curStat.currentHp-i<=0?this.personToTombstone(!1,o,r.data.key,s):r.setWeak(!1,i)}else o.data.cardList.remove(r),r.dispose(!1),o.data.cardList.length>0?o.flushRender():this.clearGroupCard(o);n&&this.checkMixAndCutBook()}}this.breakQueue.length>0?this._dealBreakQueue():this.isDealingBreakQueue=!1}endBlanking(t,e,i){a.log("endBlanking:",e,i);for(let r=0;r<this.normalCardGroupArray.length;r++){let s=this.normalCardGroupArray[r],o=s.data.cardList.filter(e=>e.data.key==t);if(o.length>0){let n=o[0];if(e.findIndex(t=>0!=t)>=0){a.log("出现新卡",t);let o=!0;if(10129==n.data.curStat.cardID&&(o=this.currentWordlessBook>0),o){let t=A.radiusGenerge,a=[s.render.x,s.render.y],o=[s.render.x+s.render.entity.width/2,s.render.y+s.render.entity.height/2],n=this.getEndPos(a,t),h=0,l=i.map((t,e,a)=>0==e?t-10*this.currentWordlessBook<=0?0:t-10*this.currentWordlessBook:t+10*this.currentWordlessBook),c=e[h=z.randomOneByTradition(l)];0!=c&&this.generateGroup(!1,c,t,a,o,n,r)}}s.data.cardList.remove(n),n.dispose(!1),s.data.cardList.length>0?s.flushRender():this.clearGroupCard(s);break}}}readGameSave(){let t=T.instance.get(null,I.MapNormalCardGroup);if(t)for(const e in t){let a=t[e];if(a&&a.posX&&a.posX>0&&a.posY&&a.posY>0&&a.cardKeyList&&a.cardKeyList.length>0){let t=[a.posX,a.posY],e=a.cardKeyList,i=new st(!1,a);for(let a=0;a<e.length;a++){let r=e[a];if(r){let s=T.instance.get(r,I.MapNormalCard);if(s){let r=this.normalCardRes[s.id],o=new at(r,!1,s),n=[t[0],t[1]+a*rt.lineHeightSpacing];o.createRender(n,!1).then(()=>{a==e.length-1&&i.createRender(t).then(()=>{this.skeletonCreateGroup(!1,[],i)})}),i.data.addGroup(o)}}}}}let e=T.instance.get(null,I.MapHolderCard);if(e)for(const t in e){let a=e[t];if(a&&a.posX&&a.posX>0&&a.posY&&a.posY>0&&a.remainCount&&a.remainCount>0){let t=this.holderCardRes[a.id];De.create([a.posX,a.posY],t,a).then(t=>{t.entity.alpha=1,t.showRig(!0),this.holderCardArray.push(t)})}}let i=T.instance.get("SaveBattleDataSO",I.GameItems);i&&Wt.instance.backBattle(i),a.log("hBattle:",i,t,e,j.instance.heroItems,j.instance.weaponItems,j.instance.animalItems,j.instance.enemyItems)}outOfBattle(t,e,a){for(let i=0;i<this.normalCardGroupArray.length;i++){let r=this.normalCardGroupArray[i],s=r.data.cardList.filter(e=>e.data.key==t);if(s.length>0){if(-1!=a){let t=s[0];e&&t.abandonEquip(),t.setWeak(!0,a)}r.data.cardList.forEach(t=>{t.recoverState()});let t=[r.render.x,r.render.y],i=[r.render.x+r.render.entity.width/2,r.render.y+r.render.entity.height/2],o=this.getEndPos(t,A.radiusGenerge),n=r.data.spliteGroupFromType(d.People),h=new st;h.data.concat(n),h.createRender(t).then(()=>{ke.instance.layerEffect.sceneGame.createBoomAni(i),this.skeletonCreateGroup(!0,o,h),r.flushRender()});break}}}endBattle(t,e,i,r){for(let s=0;s<this.normalCardGroupArray.length;s++){let o=this.normalCardGroupArray[s],n=o.data.cardList.filter(t=>t.data.key==e.heroKey);if(n.length>0){if(o.data.cardList.forEach(t=>{t.recoverState()}),t){let t=T.instance.get(e.otherKey,I.MapNormalCard);for(const e in this.gainBattleRes)if(Object.prototype.hasOwnProperty.call(this.gainBattleRes,e)){let i=this.gainBattleRes[e];if(i&&i.MaterialID==t.id&&t.cardLevel==i.Level){let t=[o.render.x,o.render.y],e=[o.render.x+o.render.entity.width/2,o.render.y+o.render.entity.height/2],r=0;if(1==i.IsSimple){r=z.randomOneByTradition(i.ProductsProbability);let a=i.Products[r],o=A.radiusGenerge,n=this.getEndPos(t,o);this.generateGroup(!1,a,o,t,e,n,s)}else{r=z.randomOneByTradition(i.ProductsHolderProbability);let e=i.ProductsHolder[r],s=A.radiusGenerge2,o=this.getEndPos(t,s);a.log("endPos:",o),Ae.instance.createHolderCard(t,o,e)}break}}if(-1!=r){let t=n[0];i&&t.abandonEquip(),t.setWeak(!0,r)}let h=o.data.cardList.select(t=>t.data.key==e.otherKey);o.data.cardList.remove(h),h.dispose(!1),o.flushRender()}else this.personToTombstone(!1,o,e.heroKey,s);break}}}personToTombstone(t,e,a,i){let r=A.radiusGenerge,s=[e.render.x,e.render.y],o=[e.render.x+e.render.entity.width/2,e.render.y+e.render.entity.height/2],n=this.getEndPos(s,r),h=e.data.cardList.select(t=>t.data.key==a);e.data.cardList.remove(h),h.dispose(!1),e.data.cardList.length>0?e.flushRender():(this.clearGroupCard(e),i=-1),this.generateGroup(!1,10077,r,s,o,n,i),t||(this.checkMixAndCutBook(),0!=this.currentPopulation)||this.gameOver()}setSpecialWeapon(){var t=this.specailWeaponRes[10001];T.instance.set(t.ID,{key:t.ID,id:t.ID},I.SpecialWeaponData,!1),T.instance.get(t.ID,I.SpecialWeaponData).amout=1,T.instance.save()}setRandomEventCard(t){let e=new st,a=this.normalCardRes[t],i=new at(a,!0),r=[z.randInt(100,Laya.stage.width-100),50],s=[r[0],Laya.stage.height/2-200];e.data.addGroup(i),i.createRender(r,!1).then(()=>{e.createRender(r).then(()=>{this.skeletonCreateGroup(!0,s,e)})})}}Ae.OpenBag="OPEN_BAG",Ae.ManualControl="MANUAL_CONTROL";class Te{static get instance(){return Te._instance||(Te._instance=new Te),Te._instance}init(){D.on(r.OnTaskEnd,this,this.onTaskEnd)}onTaskEnd(t,e,i){switch(t){case Y.AutoSave:a.log("Auto Save",(new Date).format("YYYY-mm-DD HH:MM:SS")),T.instance.save();break;case Y.EverlastingGetExp:this.getExpEvent(t,e,i);break;case Y.GameXTimeRandomEvent:this.setGameXTimeRandomEvent(t,e,i)}}getExpEvent(t,e,a){}setGameXTimeRandomEvent(t,e,a){Ae.instance.setRandomEventCard(Number(e))}}class Ee{static get instance(){return Ee._instance||(Ee._instance=new Ee),Ee._instance}init(){}}class Me{static get instance(){return Me._instance||(Me._instance=new Me),Me._instance}init(){this.scale=1,this.timeNow=0,this.ispause=!1,Laya.timer.frameLoop(1,this,this.timeUpdate)}getTimeNow(){return this.timeNow}timeUpdate(){this.ispause||(this.delta=Laya.timer.delta*this.scale,this.timeNow+=this.delta/1e3)}pause(t){this.ispause=t}isStop(){return this.ispause}clear(){Laya.timer.clear(this,this.timeUpdate)}}class Ge{constructor(){this.effUpdateFuncList={},this.effupindex=0,this.isStart=!1,this.printtm=0,this.typeIndex={LiziMove01:0}}static get instance(){return Ge._instance||(Ge._instance=new Ge),Ge._instance}init(){he.instance.onSceneGame(),he.instance.onSceneFront()}addLoopFunc(t,e,a,i){this.effUpdateFuncList[(this.effupindex++).toString()]=[t,e,a]}removeLoopFunc(t,e){for(var a in this.effUpdateFuncList)if(this.effUpdateFuncList.hasOwnProperty(a)){var i=this.effUpdateFuncList[a];if(i[0]==t&&i[1]==e){delete this.effUpdateFuncList[a];break}}}effClear(){this.effUpdateFuncList={},0==this.isStart&&Laya.timer.frameLoop(1,this,this.effUpdate),this.isStart=!0}effUpdate(){for(var t in this.effUpdateFuncList)if(this.effUpdateFuncList.hasOwnProperty(t)){if((e=this.effUpdateFuncList[t])[0].destroyed){delete this.effUpdateFuncList[t];continue}if(null!=e[2])switch(e[2].length){case 0:e[1]();break;case 1:e[1](e[2][0]);break;case 2:e[1](e[2][0],e[2][1]);break;case 3:e[1](e[2][0],e[2][1],e[2][2]);break;case 4:e[1](e[2][0],e[2][1],e[2][2],e[2][3])}else e[1]()}if(Me.instance.getTimeNow()>this.printtm+1){this.printtm=Me.instance.getTimeNow();let a={};for(var t in this.effUpdateFuncList){var e=this.effUpdateFuncList[t];a.hasOwnProperty(e[0].name)||(a[e[0].name]=0),a[e[0].name]++}}}effBarObb(t,e){let a=this.liziCreate("cone002.png",this.typeIndex.LiziMove01,10,0);t.addChild(a),a.pos(e.x,e.y)}effCircle(t,e){let a=this.effRing(1,600,300,"images/ring.png");t.addChild(a),a.pos(e.x,e.y),a.alpha=.03}liziCreate(t,e,a,i){let r=new Laya.Sprite;r.name="1";for(var s=0;s<a;s++){let a=this.loadSpri(`images/${t}`);switch(r.addChild(a),e){case this.typeIndex.LiziMove01:this.liziMove01(a)}}return Laya.timer.once(2e3,this,()=>{r.destroy(!0),r=null}),r}liziMove01(t){let e=[-10,10];t.rotation=360*Math.random(),t.x=this.getRand(e[0],e[1]),t.spx=this.getRand(-100,100),t.spy=this.getRand(-20,400),t.sizenowx=this.getRand(20,30),t.sizenowy=this.getRand(20,30);this.setScanle(t,t.sizenowx,t.sizenowy),this.addLoopFunc(t,()=>{let e=t;if(e.destroyed)return void Laya.timer.clearAll(e);let a=Me.instance.delta/1e3;t.x+=t.spx*a,t.y-=t.spy*a,t.sizenowx-=.0375*a,t.sizenowy-=.0375*a,this.setScanle(t,t.sizenowx,t.sizenowy),t.spy-=1e3*a,t.rotation+=100*a}),Laya.timer.once(800,t,()=>{this.destroyPool(t)})}loadSpri(t,e){e=null==e?0:e;let a=new Laya.Sprite;return a.loadImage(t),a.pivot(a.width/2,a.height/2),a.name=t+e,a}destroyPool(t){t.destroy(!0)}getRand(t,e){return Math.random()*(e-t)+t}setScanle(t,e,a){t.scale(e/t.width,a/t.height)}effRing(t,e,a,i){if(a<=0)return;let r=this.loadSpri(i);return r.scale(t/r.width,t/r.height),r.alpha=.2,r.tmNow=a,this.addLoopFunc(r,this.effRingUpdate,[r,t,e,a]),r}effRingUpdate(t,e,a,i){let r=t;if(r.destroyed)return void Laya.timer.clearAll(r);let s=Me.instance.delta;t.tmNow-=s;let o=(a-e)/t.width,n=t.scaleX+o/i*s;return t.scale(n,n),t.tmNow<0?(t.removeSelf(),t.destroy(!0),void Laya.timer.clear(t,this.effRingUpdate)):void 0}shake(t,e,i,r,s,o){if(0==r)return;let n=r,h=t.y,l=t.x,c=t=>{let r=t;r.destroyed?Laya.timer.clearAll(r):(n-=Me.instance.delta/Me.instance.scale,a.log("???shake0",n),t.y=h+Math.random()*e,t.x=l+Math.random()*i,n<0&&(t.x=s,t.y=o,Laya.timer.clear(t,c),this.removeLoopFunc(t,c)))};t.name="Shake",this.addLoopFunc(t,c,[t])}}class Pe{constructor(){this.randomEventRes=null}static get instance(){return Pe._instance||(Pe._instance=new Pe),Pe._instance}init(){this.randomEventRes=E.instance.select(L.RandomEventBook).asDict,this.addEvent()}addEvent(){D.on(r.CallRandEventWithFans,this,this.onRefreshType,["Fans"]),D.on(r.CallRandEventWithBook,this,this.onRefreshType,["Book"]),D.on(r.CallRandEventWithGift,this,this.onRefreshType,["Gift"]),D.on(r.CallGameMonthEvent,this,this.onRefreshTime,["Month"]),D.on(r.CallGameSeaonEvent,this,this.onRefreshTime,["Season"]),D.on(r.CallGameYearEvent,this,this.onRefreshTime,["Year"])}onRefreshTime(t,e){a.log("onRefreshTime:",t,e);let i=[];switch(t){case"Month":if((i=this.getRandEvent(t)).length>0)for(let t=0;t<i.length;t++){const r=i[t];if(a.log("onRefreshTime1:",r.LimitValue,e),r.LimitValue==e){if(z.randInt(1,100)<=r.RandShow){let t=r.EventIDs[z.randomOneByTradition(r.EventIDsProbability)];this.setRandBGTask(t,r.DelayTime)}}}break;case"Season":if((i=this.getRandEvent(t)).length>0)for(let t=0;t<i.length;t++){const a=i[t];if(a.LimitValue==e){if(z.randInt(1,100)<=a.RandShow){let t=a.EventIDs[z.randomOneByTradition(a.EventIDsProbability)];this.setRandBGTask(t,a.DelayTime)}}}break;case"Year":if((i=this.getRandEvent(t)).length>0)for(let t=0;t<i.length;t++){const a=i[t];if(e%a.LimitValue==0){if(z.randInt(1,100)<=a.RandShow){let t=a.EventIDs[z.randomOneByTradition(a.EventIDsProbability)];this.setRandBGTask(t,a.DelayTime)}}}}}onRefreshType(t,...e){a.log("onRefreshType:",t,e);let i=[];switch(t){case"Fans":if((i=this.getRandEvent(t)).length>0)for(let t=0;t<i.length;t++){const a=i[t];if(e[1]>=a.LimitValue&&e[0]<a.LimitValue){if(z.randInt(1,100)<=a.RandShow){let t=a.EventIDs[z.randomOneByTradition(a.EventIDsProbability)];this.setRandBGTask(t,a.DelayTime)}}}break;case"Book":case"Gift":if((i=this.getRandEvent(t)).length>0)for(let t=0;t<i.length;t++){const e=i[t];if(z.randInt(1,100)<=e.RandShow){let t=e.EventIDs[z.randomOneByTradition(e.EventIDsProbability)];this.setRandBGTask(t,e.DelayTime)}}}}getRandEvent(t){let e=[];for(let a in this.randomEventRes)this.randomEventRes[a]&&t==this.randomEventRes[a].EventType&&e.push(this.randomEventRes[a]);return e}setRandBGTask(t,e){if(0!=t&&e.length>0)if(a.log("setRandBGTask:",e),0==e[0]&&0==e[1])Ae.instance.setRandomEventCard(t);else{let a=z.randInt(e[0],e[1]);N.instance.add(Y.GameXTimeRandomEvent,R.seconds,a,t.toString(),!1)}}}class He{constructor(){}static get instance(){return He._instance||(He._instance=new He),He._instance}begin(){ke.instance.clear(),G.init(),ke.instance.init(),this.startup()}startup(){return ke.instance.load().then(E.instance.loadAll.bind(E.instance)).then(()=>{this.onGameStart()})}onGameStart(){a.log("onGameStart"),Ee.instance.init(),T.instance.init(),Pe.instance.init(),Te.instance.init(),P.instance.init(),N.instance.init(),Ge.instance.init(),Ae.instance.init(),Wt.instance.init(),N.instance.startup(),this.initConfig(),ke.instance.layerUI.onSceneMain()}initConfig(){a.log("常驻任务"),N.instance.pauseAll();let t=R.seconds;N.instance.add(Y.AutoSave,t,A.autoSaveInterval,"autosave",!0)}}String.prototype.format=function(...t){return this.replace(/(\{\d+\})/g,e=>t[e.substr(1,e.length-2)])},String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},String.prototype.ltrim=function(){return this.replace(/(^\s*)/g,"")},String.prototype.rtrim=function(){return this.replace(/(\s*$)/g,"")},String.prototype.padStart=function(t,e){return t>>=0,e=String(void 0!==e?e:" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))},String.prototype.padEnd=function(t,e){return t>>=0,e=String(void 0!==e?e:""),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),String(this)+e.slice(0,t))},String.prototype.hash=function(t){let e=this;t||(e=e.toLowerCase());var a,i=1315423911;for(a=e.length-1;a>=0;a--)i^=(i<<5)+e.charCodeAt(a)+(i>>2);return 2147483647&i},Laya.Graphics.prototype.drawCircleWithAngle=function(t,e,a,r,s,o,n,h,l,c){let d=this,p=s+=o;if((r+=o)>s&&(s=r,r=p),!(s-r<1)){var f=[];for(let t=r;t<=s;t+=1){let e=t*i.Deg2Rad;f.push(i.Sin(e)*a,i.Cos(e)*a)}n||f.reverse(),h?(s-r<360&&f.push(t,e),d.drawPoly(t,e,f,h,l,c)):d.drawLines(t,e,f,l,c)}},Array.prototype.unique=function(){if(this.length<=0)return[];this.sort();for(var t=[this[0]],e=1;e<this.length;e++)this[e]!==t[t.length-1]&&t.push(this[e]);return t},Array.prototype.union=function(t){return this.concat(t).unique()},Array.prototype.minus=function(t){for(var e=[],a=0;a<this.length;a++){for(var i=!0,r=0;r<t.length;r++)this[a]==t[r]&&(i=!1);i&&e.push(this[a])}return e.unique()},Array.prototype.intersect=function(t){for(var e=[],a=0;a<t.length;a++)for(var i=t[a],r=0;r<this.length;r++)if(i===this[r]){e.push(i);break}return e.unique()},Array.prototype.contains=function(t){return-1!==this.indexOf(t)},Array.prototype.remove=function(t){let e=this.indexOf(t);return-1!==e&&this.splice(e,1),-1!==e},Array.prototype.trim=function(){let t=[];for(let e=0,a=this.length;e<a;e++)void 0!==this[e]&&t.push(this[e]);this.length=t.length;for(let e=0,a=this.length;e<a;e++)this[e]=t[e]},Array.prototype.clone=function(){let t=[];for(let e=0;e<this.length;e++)t.push(this[e]);return t},Array.prototype.select=function(t){for(let e=0;e<this.length;e++)if(t(this[e],e))return this[e]},Array.prototype.equals=function(t){if(!t)return!1;if(this.length!=t.length)return!1;let e=this.clone(),a=t.clone();e.sort(),a.sort();for(let t=0;t<e.length;t++)if(e[t]instanceof Array&&a[t]instanceof Array){if(!e[t].equals(a[t]))return!1}else if(e[t]!=a[t])return!1;return!0},Laya.Node.prototype.find=function(t){if(!t)return this;let e=t.split("/"),a=this;for(;e.length>0;)if(!(a=a.getChildByName(e.shift())))return null;return a},Laya.Node.prototype.findChild=function(t){let e=this;for(let a=0;a<e.numChildren;a++){let i=e.getChildAt(a);if(i.name===t)return i;if(i.numChildren>0){let e=i.findChild(t);if(e&&e.name===t)return e}}},Laya.Node.prototype.traverse=function(t){let e=new Laya.Handler(Laya.Node.prototype,t);!function traverse(t,e){if(e.runWith(t),t.numChildren>0)for(let a=0;a<t.numChildren;a++)traverse(t.getChildAt(a),e)}(this,e),e.recover()};var Oe,We=Laya.Point;We.prototype.reflect=function(t,e){return(e=e||new We).addScaledVector(t,-2*t.dot(this)),e.add(this,e),e},We.prototype.set=function(t,e){return this.x=t,this.y=e,this},We.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},We.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw"index is out of range: "+t}},We.prototype.clone=function(){return new We(this.x,this.y)},We.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},We.prototype.add=function(t,e){return(e=e||new We).x=this.x+t.x,e.y=this.y+t.y,e},We.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},We.prototype.sub=function(t,e){return(e=e||new We).x=this.x-t.x,e.y=this.y-t.y,e},We.prototype.mult=function(t,e){return(e=e||new We).x=this.x*t,e.y=this.y*t,e},We.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},We.prototype.divide=function(t,e){return(e=e||new We).x=this.x/t,e.y=this.y/t,e},We.prototype.divide2=function(t,e,a){return(a=a||new We).x=this.x/t,a.y=this.y/e,a},We.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},We.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},We.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},We.prototype.clampLength=function(t,e){var a=this.length();return this.divide(a||1,this).mult(Math.max(t,Math.min(e,a)),this)},We.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},We.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},We.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},We.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},We.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},We.prototype.dot=function(t){return this.x*t.x+this.y*t.y},We.prototype.cross=function(t){return this.x*t.y-this.y*t.x},We.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},We.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},We.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},We.prototype.unit=function(){return this.divide(this.length()||1,this)},We.prototype.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI},We.prototype.angleTo=function(t){var e=i.Sqrt(this.lengthSq()*t.lengthSq());return e>=1e-15?57.29578*i.Acos(i.Clamp(this.dot(t)/e,-1,1)):0},We.prototype.signedAngleTo=function(t){return this.angleTo(t)*i.Sign(this.x*t.y-this.y*t.x)},We.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},We.prototype.distanceToSquared=function(t){var e=this.x-t.x,a=this.y-t.y;return e*e+a*a},We.prototype.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},We.prototype.setLength=function(t){return this.unit().mult(t,this)},We.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},We.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},We.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},We.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},We.prototype.rotateAround=function(t,e){var a=Math.cos(e),i=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*a-s*i+t.x,this.y=r*i+s*a+t.y,this},Date.prototype.format=function(t){let e;const a={"Y+":this.getFullYear().toString(),"m+":(this.getMonth()+1).toString(),"D+":this.getDate().toString(),"H+":this.getHours().toString(),"M+":this.getMinutes().toString(),"S+":this.getSeconds().toString()};for(let i in a)(e=new RegExp("("+i+")").exec(t))&&(t=t.replace(e[1],1==e[1].length?a[i]:a[i].padStart(e[1].length,"0")));return t};return new class{constructor(){window.Laya3D?Laya3D.init(e.width,e.height):Laya.init(e.width,e.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=e.scaleMode,Laya.stage.screenMode=e.screenMode,Laya.stage.alignV=e.alignV,Laya.stage.alignH=e.alignH,Laya.URL.exportSceneToJson=e.exportSceneToJson,(e.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),e.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),e.stat&&Laya.Stat.show(),Laya.stage.frameRate=Laya.Stage.FRAME_FAST,Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){Laya.timer.callLater(this,()=>{He.instance.begin()})}onLoadTTF(t){console.log("字体加载完成")}},(Oe=t.XzOrder||(t.XzOrder={}))[Oe.one=0]="one",Oe[Oe.two=1]="two",Oe[Oe.three=2]="three",t}({});